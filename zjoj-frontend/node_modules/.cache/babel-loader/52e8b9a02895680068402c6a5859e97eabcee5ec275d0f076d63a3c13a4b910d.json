{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, provide, onMounted, onUnmounted, computed, inject } from \"vue\";\nimport { isUndefined } from \"../../_utils/is.js\";\nimport { DataCollectorInjectionKey } from \"../context.js\";\nfunction getKeys(data, condition) {\n  const keys = [];\n  const loop = list => {\n    list.forEach(item => {\n      if (condition(item)) {\n        keys.push(item.key);\n      }\n      if (item.children) {\n        loop(item.children);\n      }\n    });\n  };\n  loop(data);\n  return keys;\n}\nfunction useMenuDataCollectorContext(isRoot = false) {\n  const menuContext = isRoot ? void 0 : inject(DataCollectorInjectionKey);\n  return menuContext;\n}\nfunction useMenuDataCollector(props) {\n  const {\n    key,\n    type\n  } = props;\n  const data = ref([]);\n  const menuContext = useMenuDataCollectorContext(type === \"menu\");\n  const provideContext = {\n    collectSubMenu(key2, children, isReport = false) {\n      const item = {\n        key: key2,\n        children\n      };\n      if (isReport) {\n        const oldOne = data.value.find(i => i.key === key2);\n        if (oldOne) {\n          oldOne.children = children;\n        } else {\n          data.value.push(item);\n        }\n      } else {\n        data.value = [...data.value, item];\n      }\n      if (isReport) {\n        if (type === \"popupMenu\") {\n          menuContext == null ? void 0 : menuContext.reportMenuData(data.value);\n        } else if (type === \"subMenu\" && !isUndefined(key2)) {\n          menuContext == null ? void 0 : menuContext.collectSubMenu(key2, data.value, true);\n        }\n      }\n    },\n    removeSubMenu(key2) {\n      data.value = data.value.filter(item => item.key !== key2);\n    },\n    collectMenuItem(key2) {\n      data.value.push({\n        key: key2\n      });\n    },\n    removeMenuItem(key2) {\n      data.value = data.value.filter(item => item.key !== key2);\n    },\n    reportMenuData(reportData) {\n      data.value = reportData;\n      if (type === \"subMenu\" && !isUndefined(key)) {\n        menuContext == null ? void 0 : menuContext.collectSubMenu(key, data.value, true);\n      }\n    }\n  };\n  provide(DataCollectorInjectionKey, provideContext);\n  if (type === \"subMenu\" && !isUndefined(key)) {\n    onMounted(() => {\n      menuContext == null ? void 0 : menuContext.collectSubMenu(key, data.value);\n    });\n    onUnmounted(() => {\n      menuContext == null ? void 0 : menuContext.removeSubMenu(key);\n    });\n  } else if (type === \"popupMenu\") {\n    onMounted(() => {\n      menuContext == null ? void 0 : menuContext.reportMenuData(data.value);\n    });\n  }\n  return {\n    menuData: data,\n    subMenuKeys: computed(() => getKeys(data.value, item => !!item.children)),\n    menuItemKeys: computed(() => getKeys(data.value, item => !item.children))\n  };\n}\nexport { useMenuDataCollector as default, useMenuDataCollectorContext };","map":{"version":3,"names":["ref","provide","onMounted","onUnmounted","computed","inject","isUndefined","DataCollectorInjectionKey","getKeys","data","condition","keys","loop","list","forEach","item","push","key","children","useMenuDataCollectorContext","isRoot","menuContext","useMenuDataCollector","props","type","provideContext","collectSubMenu","key2","isReport","oldOne","value","find","i","reportMenuData","removeSubMenu","filter","collectMenuItem","removeMenuItem","reportData","menuData","subMenuKeys","menuItemKeys","default"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/@arco-design/web-vue/es/menu/hooks/use-menu-data-collector.js"],"sourcesContent":["import { ref, provide, onMounted, onUnmounted, computed, inject } from \"vue\";\nimport { isUndefined } from \"../../_utils/is.js\";\nimport { DataCollectorInjectionKey } from \"../context.js\";\nfunction getKeys(data, condition) {\n  const keys = [];\n  const loop = (list) => {\n    list.forEach((item) => {\n      if (condition(item)) {\n        keys.push(item.key);\n      }\n      if (item.children) {\n        loop(item.children);\n      }\n    });\n  };\n  loop(data);\n  return keys;\n}\nfunction useMenuDataCollectorContext(isRoot = false) {\n  const menuContext = isRoot ? void 0 : inject(DataCollectorInjectionKey);\n  return menuContext;\n}\nfunction useMenuDataCollector(props) {\n  const { key, type } = props;\n  const data = ref([]);\n  const menuContext = useMenuDataCollectorContext(type === \"menu\");\n  const provideContext = {\n    collectSubMenu(key2, children, isReport = false) {\n      const item = {\n        key: key2,\n        children\n      };\n      if (isReport) {\n        const oldOne = data.value.find((i) => i.key === key2);\n        if (oldOne) {\n          oldOne.children = children;\n        } else {\n          data.value.push(item);\n        }\n      } else {\n        data.value = [...data.value, item];\n      }\n      if (isReport) {\n        if (type === \"popupMenu\") {\n          menuContext == null ? void 0 : menuContext.reportMenuData(data.value);\n        } else if (type === \"subMenu\" && !isUndefined(key2)) {\n          menuContext == null ? void 0 : menuContext.collectSubMenu(key2, data.value, true);\n        }\n      }\n    },\n    removeSubMenu(key2) {\n      data.value = data.value.filter((item) => item.key !== key2);\n    },\n    collectMenuItem(key2) {\n      data.value.push({ key: key2 });\n    },\n    removeMenuItem(key2) {\n      data.value = data.value.filter((item) => item.key !== key2);\n    },\n    reportMenuData(reportData) {\n      data.value = reportData;\n      if (type === \"subMenu\" && !isUndefined(key)) {\n        menuContext == null ? void 0 : menuContext.collectSubMenu(key, data.value, true);\n      }\n    }\n  };\n  provide(DataCollectorInjectionKey, provideContext);\n  if (type === \"subMenu\" && !isUndefined(key)) {\n    onMounted(() => {\n      menuContext == null ? void 0 : menuContext.collectSubMenu(key, data.value);\n    });\n    onUnmounted(() => {\n      menuContext == null ? void 0 : menuContext.removeSubMenu(key);\n    });\n  } else if (type === \"popupMenu\") {\n    onMounted(() => {\n      menuContext == null ? void 0 : menuContext.reportMenuData(data.value);\n    });\n  }\n  return {\n    menuData: data,\n    subMenuKeys: computed(() => getKeys(data.value, (item) => !!item.children)),\n    menuItemKeys: computed(() => getKeys(data.value, (item) => !item.children))\n  };\n}\nexport { useMenuDataCollector as default, useMenuDataCollectorContext };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}