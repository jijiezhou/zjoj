{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar MarkdownRenderer_1;\nimport { renderMarkdown } from '../../../../base/browser/markdownRenderer.js';\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport './renderedMarkdown.css';\nimport { applyFontInfo } from '../../../browser/config/domFontInfo.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../common/languages/modesRegistry.js';\nimport { tokenizeToString } from '../../../common/languages/textToHtmlTokenizer.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\n/**\n * Markdown renderer that can render codeblocks with the editor mechanics. This\n * renderer should always be preferred.\n */\nlet MarkdownRenderer = MarkdownRenderer_1 = class MarkdownRenderer {\n  constructor(_options, _languageService, _openerService) {\n    this._options = _options;\n    this._languageService = _languageService;\n    this._openerService = _openerService;\n    this._onDidRenderAsync = new Emitter();\n    this.onDidRenderAsync = this._onDidRenderAsync.event;\n  }\n  dispose() {\n    this._onDidRenderAsync.dispose();\n  }\n  render(markdown, options, markedOptions) {\n    if (!markdown) {\n      const element = document.createElement('span');\n      return {\n        element,\n        dispose: () => {}\n      };\n    }\n    const disposables = new DisposableStore();\n    const rendered = disposables.add(renderMarkdown(markdown, {\n      ...this._getRenderOptions(markdown, disposables),\n      ...options\n    }, markedOptions));\n    rendered.element.classList.add('rendered-markdown');\n    return {\n      element: rendered.element,\n      dispose: () => disposables.dispose()\n    };\n  }\n  _getRenderOptions(markdown, disposables) {\n    return {\n      codeBlockRenderer: async (languageAlias, value) => {\n        var _a, _b, _c;\n        // In markdown,\n        // it is possible that we stumble upon language aliases (e.g.js instead of javascript)\n        // it is possible no alias is given in which case we fall back to the current editor lang\n        let languageId;\n        if (languageAlias) {\n          languageId = this._languageService.getLanguageIdByLanguageName(languageAlias);\n        } else if (this._options.editor) {\n          languageId = (_a = this._options.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getLanguageId();\n        }\n        if (!languageId) {\n          languageId = PLAINTEXT_LANGUAGE_ID;\n        }\n        const html = await tokenizeToString(this._languageService, value, languageId);\n        const element = document.createElement('span');\n        element.innerHTML = (_c = (_b = MarkdownRenderer_1._ttpTokenizer) === null || _b === void 0 ? void 0 : _b.createHTML(html)) !== null && _c !== void 0 ? _c : html;\n        // use \"good\" font\n        if (this._options.editor) {\n          const fontInfo = this._options.editor.getOption(50 /* EditorOption.fontInfo */);\n          applyFontInfo(element, fontInfo);\n        } else if (this._options.codeBlockFontFamily) {\n          element.style.fontFamily = this._options.codeBlockFontFamily;\n        }\n        if (this._options.codeBlockFontSize !== undefined) {\n          element.style.fontSize = this._options.codeBlockFontSize;\n        }\n        return element;\n      },\n      asyncRenderCallback: () => this._onDidRenderAsync.fire(),\n      actionHandler: {\n        callback: link => openLinkFromMarkdown(this._openerService, link, markdown.isTrusted),\n        disposables: disposables\n      }\n    };\n  }\n};\nMarkdownRenderer._ttpTokenizer = createTrustedTypesPolicy('tokenizeToString', {\n  createHTML(html) {\n    return html;\n  }\n});\nMarkdownRenderer = MarkdownRenderer_1 = __decorate([__param(1, ILanguageService), __param(2, IOpenerService)], MarkdownRenderer);\nexport { MarkdownRenderer };\nexport async function openLinkFromMarkdown(openerService, link, isTrusted) {\n  try {\n    return await openerService.open(link, {\n      fromUserGesture: true,\n      allowContributedOpeners: true,\n      allowCommands: toAllowCommandsOption(isTrusted)\n    });\n  } catch (e) {\n    onUnexpectedError(e);\n    return false;\n  }\n}\nfunction toAllowCommandsOption(isTrusted) {\n  if (isTrusted === true) {\n    return true; // Allow all commands\n  }\n  if (isTrusted && Array.isArray(isTrusted.enabledCommands)) {\n    return isTrusted.enabledCommands; // Allow subset of commands\n  }\n  return false; // Block commands\n}","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","MarkdownRenderer_1","renderMarkdown","createTrustedTypesPolicy","onUnexpectedError","Emitter","DisposableStore","applyFontInfo","ILanguageService","PLAINTEXT_LANGUAGE_ID","tokenizeToString","IOpenerService","MarkdownRenderer","constructor","_options","_languageService","_openerService","_onDidRenderAsync","onDidRenderAsync","event","dispose","render","markdown","options","markedOptions","element","document","createElement","disposables","rendered","add","_getRenderOptions","classList","codeBlockRenderer","languageAlias","value","_a","_b","_c","languageId","getLanguageIdByLanguageName","editor","getModel","getLanguageId","html","innerHTML","_ttpTokenizer","createHTML","fontInfo","getOption","codeBlockFontFamily","style","fontFamily","codeBlockFontSize","undefined","fontSize","asyncRenderCallback","fire","actionHandler","callback","link","openLinkFromMarkdown","isTrusted","openerService","open","fromUserGesture","allowContributedOpeners","allowCommands","toAllowCommandsOption","e","Array","isArray","enabledCommands"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/monaco-editor/esm/vs/editor/contrib/markdownRenderer/browser/markdownRenderer.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MarkdownRenderer_1;\nimport { renderMarkdown } from '../../../../base/browser/markdownRenderer.js';\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport './renderedMarkdown.css';\nimport { applyFontInfo } from '../../../browser/config/domFontInfo.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../common/languages/modesRegistry.js';\nimport { tokenizeToString } from '../../../common/languages/textToHtmlTokenizer.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\n/**\n * Markdown renderer that can render codeblocks with the editor mechanics. This\n * renderer should always be preferred.\n */\nlet MarkdownRenderer = MarkdownRenderer_1 = class MarkdownRenderer {\n    constructor(_options, _languageService, _openerService) {\n        this._options = _options;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._onDidRenderAsync = new Emitter();\n        this.onDidRenderAsync = this._onDidRenderAsync.event;\n    }\n    dispose() {\n        this._onDidRenderAsync.dispose();\n    }\n    render(markdown, options, markedOptions) {\n        if (!markdown) {\n            const element = document.createElement('span');\n            return { element, dispose: () => { } };\n        }\n        const disposables = new DisposableStore();\n        const rendered = disposables.add(renderMarkdown(markdown, { ...this._getRenderOptions(markdown, disposables), ...options }, markedOptions));\n        rendered.element.classList.add('rendered-markdown');\n        return {\n            element: rendered.element,\n            dispose: () => disposables.dispose()\n        };\n    }\n    _getRenderOptions(markdown, disposables) {\n        return {\n            codeBlockRenderer: async (languageAlias, value) => {\n                var _a, _b, _c;\n                // In markdown,\n                // it is possible that we stumble upon language aliases (e.g.js instead of javascript)\n                // it is possible no alias is given in which case we fall back to the current editor lang\n                let languageId;\n                if (languageAlias) {\n                    languageId = this._languageService.getLanguageIdByLanguageName(languageAlias);\n                }\n                else if (this._options.editor) {\n                    languageId = (_a = this._options.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getLanguageId();\n                }\n                if (!languageId) {\n                    languageId = PLAINTEXT_LANGUAGE_ID;\n                }\n                const html = await tokenizeToString(this._languageService, value, languageId);\n                const element = document.createElement('span');\n                element.innerHTML = ((_c = (_b = MarkdownRenderer_1._ttpTokenizer) === null || _b === void 0 ? void 0 : _b.createHTML(html)) !== null && _c !== void 0 ? _c : html);\n                // use \"good\" font\n                if (this._options.editor) {\n                    const fontInfo = this._options.editor.getOption(50 /* EditorOption.fontInfo */);\n                    applyFontInfo(element, fontInfo);\n                }\n                else if (this._options.codeBlockFontFamily) {\n                    element.style.fontFamily = this._options.codeBlockFontFamily;\n                }\n                if (this._options.codeBlockFontSize !== undefined) {\n                    element.style.fontSize = this._options.codeBlockFontSize;\n                }\n                return element;\n            },\n            asyncRenderCallback: () => this._onDidRenderAsync.fire(),\n            actionHandler: {\n                callback: (link) => openLinkFromMarkdown(this._openerService, link, markdown.isTrusted),\n                disposables: disposables\n            }\n        };\n    }\n};\nMarkdownRenderer._ttpTokenizer = createTrustedTypesPolicy('tokenizeToString', {\n    createHTML(html) {\n        return html;\n    }\n});\nMarkdownRenderer = MarkdownRenderer_1 = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService)\n], MarkdownRenderer);\nexport { MarkdownRenderer };\nexport async function openLinkFromMarkdown(openerService, link, isTrusted) {\n    try {\n        return await openerService.open(link, {\n            fromUserGesture: true,\n            allowContributedOpeners: true,\n            allowCommands: toAllowCommandsOption(isTrusted),\n        });\n    }\n    catch (e) {\n        onUnexpectedError(e);\n        return false;\n    }\n}\nfunction toAllowCommandsOption(isTrusted) {\n    if (isTrusted === true) {\n        return true; // Allow all commands\n    }\n    if (isTrusted && Array.isArray(isTrusted.enabledCommands)) {\n        return isTrusted.enabledCommands; // Allow subset of commands\n    }\n    return false; // Block commands\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}