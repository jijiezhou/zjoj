{"ast":null,"code":"import { defineComponent, ref, computed, watch, onMounted, mergeProps, createVNode, createTextVNode } from \"vue\";\nimport ResizeObserver from \"../_components/resize-observer-v2.js\";\nimport { getAllElements } from \"../_utils/vue-utils.js\";\nimport { getPrefixCls } from \"../_utils/global-config.js\";\nimport Tag from \"../tag/index.js\";\nimport { getReverse } from \"../_utils/array.js\";\nvar _OverflowList = defineComponent({\n  name: \"OverflowList\",\n  props: {\n    min: {\n      type: Number,\n      default: 0\n    },\n    margin: {\n      type: Number,\n      default: 8\n    },\n    from: {\n      type: String,\n      default: \"end\"\n    }\n  },\n  emits: {\n    change: value => true\n  },\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const prefixCls = getPrefixCls(\"overflow-list\");\n    const listRef = ref();\n    const overflowRef = ref();\n    const spacerRef = ref();\n    const children = {};\n    const itemWidths = [];\n    const total = ref(0);\n    const overflowNumber = ref(0);\n    const showOverflow = computed(() => overflowNumber.value > 0);\n    const nextWidth = ref(0);\n    const isStart = computed(() => props.from === \"start\");\n    watch(total, (cur, pre) => {\n      if (overflowNumber.value > 0) {\n        overflowNumber.value += cur - pre;\n        if (overflowNumber.value < 0) {\n          overflowNumber.value = 0;\n        }\n      }\n    });\n    watch(overflowNumber, val => {\n      emit(\"change\", val);\n    });\n    const onResize = () => {\n      var _a, _b, _c;\n      if (listRef.value && children.value && spacerRef.value) {\n        const spacerWidth = spacerRef.value.offsetWidth;\n        if (spacerWidth > 1 && (overflowNumber.value === 0 || spacerWidth < nextWidth.value)) {\n          return;\n        }\n        for (let i = 0; i < children.value.length; i++) {\n          const element = children.value[i].el;\n          if (element && element.offsetWidth) {\n            itemWidths[i] = element.offsetWidth + props.margin;\n          }\n        }\n        let remainingWidth = listRef.value.clientWidth - ((_b = (_a = overflowRef.value) == null ? void 0 : _a.offsetWidth) != null ? _b : 0) - (isStart.value ? props.margin : 0);\n        const _itemWidths = isStart.value ? getReverse(itemWidths) : itemWidths;\n        let count = 0;\n        for (let i = 0; i < _itemWidths.length; i++) {\n          const itemWidth = (_c = _itemWidths[i]) != null ? _c : 0;\n          if (itemWidth < remainingWidth - 1) {\n            remainingWidth -= itemWidth;\n            count += 1;\n          } else {\n            nextWidth.value = itemWidth;\n            break;\n          }\n        }\n        if (count < props.min && props.min < total.value) {\n          count = props.min;\n        }\n        if (overflowNumber.value !== total.value - count) {\n          overflowNumber.value = total.value - count;\n        }\n      }\n    };\n    watch(showOverflow, () => onResize(), {\n      flush: \"post\"\n    });\n    onMounted(() => {\n      if (spacerRef.value && spacerRef.value.offsetWidth < 1) {\n        onResize();\n      }\n    });\n    const renderOverflow = () => {\n      var _a, _b;\n      const style = isStart.value ? {\n        marginRight: `${props.margin}px`\n      } : void 0;\n      return createVNode(\"div\", {\n        \"ref\": overflowRef,\n        \"class\": `${prefixCls}-overflow`,\n        \"style\": style\n      }, [(_b = (_a = slots.overflow) == null ? void 0 : _a.call(slots, {\n        number: overflowNumber.value\n      })) != null ? _b : createVNode(Tag, null, {\n        default: () => [createTextVNode(\"+\"), overflowNumber.value]\n      })]);\n    };\n    return () => {\n      var _a, _b;\n      children.value = getAllElements((_a = slots.default) == null ? void 0 : _a.call(slots));\n      if (total.value !== children.value.length) {\n        total.value = children.value.length;\n        itemWidths.length = total.value;\n      }\n      let visibleChildren = children.value;\n      if (overflowNumber.value > 0) {\n        visibleChildren = isStart.value ? children.value.slice(overflowNumber.value) : children.value.slice(0, -overflowNumber.value);\n      }\n      const withMarginNumber = overflowNumber.value === 0 || isStart.value ? visibleChildren.length - 1 : visibleChildren.length;\n      for (let i = 0; i < withMarginNumber; i++) {\n        visibleChildren[i].props = mergeProps((_b = visibleChildren[i].props) != null ? _b : {}, {\n          style: {\n            marginRight: `${props.margin}px`\n          }\n        });\n      }\n      return createVNode(\"div\", {\n        \"ref\": listRef,\n        \"class\": prefixCls\n      }, [isStart.value && overflowNumber.value > 0 && renderOverflow(), visibleChildren, !isStart.value && overflowNumber.value > 0 && renderOverflow(), createVNode(ResizeObserver, {\n        \"onResize\": onResize\n      }, {\n        default: () => [createVNode(\"div\", {\n          \"ref\": spacerRef,\n          \"class\": `${prefixCls}-spacer`\n        }, null)]\n      })]);\n    };\n  }\n});\nexport { _OverflowList as default };","map":{"version":3,"names":["defineComponent","ref","computed","watch","onMounted","mergeProps","createVNode","createTextVNode","ResizeObserver","getAllElements","getPrefixCls","Tag","getReverse","_OverflowList","name","props","min","type","Number","default","margin","from","String","emits","change","value","setup","emit","slots","prefixCls","listRef","overflowRef","spacerRef","children","itemWidths","total","overflowNumber","showOverflow","nextWidth","isStart","cur","pre","val","onResize","_a","_b","_c","spacerWidth","offsetWidth","i","length","element","el","remainingWidth","clientWidth","_itemWidths","count","itemWidth","flush","renderOverflow","style","marginRight","overflow","call","number","visibleChildren","slice","withMarginNumber"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/@arco-design/web-vue/es/overflow-list/overflow-list.js"],"sourcesContent":["import { defineComponent, ref, computed, watch, onMounted, mergeProps, createVNode, createTextVNode } from \"vue\";\nimport ResizeObserver from \"../_components/resize-observer-v2.js\";\nimport { getAllElements } from \"../_utils/vue-utils.js\";\nimport { getPrefixCls } from \"../_utils/global-config.js\";\nimport Tag from \"../tag/index.js\";\nimport { getReverse } from \"../_utils/array.js\";\nvar _OverflowList = defineComponent({\n  name: \"OverflowList\",\n  props: {\n    min: {\n      type: Number,\n      default: 0\n    },\n    margin: {\n      type: Number,\n      default: 8\n    },\n    from: {\n      type: String,\n      default: \"end\"\n    }\n  },\n  emits: {\n    change: (value) => true\n  },\n  setup(props, {\n    emit,\n    slots\n  }) {\n    const prefixCls = getPrefixCls(\"overflow-list\");\n    const listRef = ref();\n    const overflowRef = ref();\n    const spacerRef = ref();\n    const children = {};\n    const itemWidths = [];\n    const total = ref(0);\n    const overflowNumber = ref(0);\n    const showOverflow = computed(() => overflowNumber.value > 0);\n    const nextWidth = ref(0);\n    const isStart = computed(() => props.from === \"start\");\n    watch(total, (cur, pre) => {\n      if (overflowNumber.value > 0) {\n        overflowNumber.value += cur - pre;\n        if (overflowNumber.value < 0) {\n          overflowNumber.value = 0;\n        }\n      }\n    });\n    watch(overflowNumber, (val) => {\n      emit(\"change\", val);\n    });\n    const onResize = () => {\n      var _a, _b, _c;\n      if (listRef.value && children.value && spacerRef.value) {\n        const spacerWidth = spacerRef.value.offsetWidth;\n        if (spacerWidth > 1 && (overflowNumber.value === 0 || spacerWidth < nextWidth.value)) {\n          return;\n        }\n        for (let i = 0; i < children.value.length; i++) {\n          const element = children.value[i].el;\n          if (element && element.offsetWidth) {\n            itemWidths[i] = element.offsetWidth + props.margin;\n          }\n        }\n        let remainingWidth = listRef.value.clientWidth - ((_b = (_a = overflowRef.value) == null ? void 0 : _a.offsetWidth) != null ? _b : 0) - (isStart.value ? props.margin : 0);\n        const _itemWidths = isStart.value ? getReverse(itemWidths) : itemWidths;\n        let count = 0;\n        for (let i = 0; i < _itemWidths.length; i++) {\n          const itemWidth = (_c = _itemWidths[i]) != null ? _c : 0;\n          if (itemWidth < remainingWidth - 1) {\n            remainingWidth -= itemWidth;\n            count += 1;\n          } else {\n            nextWidth.value = itemWidth;\n            break;\n          }\n        }\n        if (count < props.min && props.min < total.value) {\n          count = props.min;\n        }\n        if (overflowNumber.value !== total.value - count) {\n          overflowNumber.value = total.value - count;\n        }\n      }\n    };\n    watch(showOverflow, () => onResize(), {\n      flush: \"post\"\n    });\n    onMounted(() => {\n      if (spacerRef.value && spacerRef.value.offsetWidth < 1) {\n        onResize();\n      }\n    });\n    const renderOverflow = () => {\n      var _a, _b;\n      const style = isStart.value ? {\n        marginRight: `${props.margin}px`\n      } : void 0;\n      return createVNode(\"div\", {\n        \"ref\": overflowRef,\n        \"class\": `${prefixCls}-overflow`,\n        \"style\": style\n      }, [(_b = (_a = slots.overflow) == null ? void 0 : _a.call(slots, {\n        number: overflowNumber.value\n      })) != null ? _b : createVNode(Tag, null, {\n        default: () => [createTextVNode(\"+\"), overflowNumber.value]\n      })]);\n    };\n    return () => {\n      var _a, _b;\n      children.value = getAllElements((_a = slots.default) == null ? void 0 : _a.call(slots));\n      if (total.value !== children.value.length) {\n        total.value = children.value.length;\n        itemWidths.length = total.value;\n      }\n      let visibleChildren = children.value;\n      if (overflowNumber.value > 0) {\n        visibleChildren = isStart.value ? children.value.slice(overflowNumber.value) : children.value.slice(0, -overflowNumber.value);\n      }\n      const withMarginNumber = overflowNumber.value === 0 || isStart.value ? visibleChildren.length - 1 : visibleChildren.length;\n      for (let i = 0; i < withMarginNumber; i++) {\n        visibleChildren[i].props = mergeProps((_b = visibleChildren[i].props) != null ? _b : {}, {\n          style: {\n            marginRight: `${props.margin}px`\n          }\n        });\n      }\n      return createVNode(\"div\", {\n        \"ref\": listRef,\n        \"class\": prefixCls\n      }, [isStart.value && overflowNumber.value > 0 && renderOverflow(), visibleChildren, !isStart.value && overflowNumber.value > 0 && renderOverflow(), createVNode(ResizeObserver, {\n        \"onResize\": onResize\n      }, {\n        default: () => [createVNode(\"div\", {\n          \"ref\": spacerRef,\n          \"class\": `${prefixCls}-spacer`\n        }, null)]\n      })]);\n    };\n  }\n});\nexport { _OverflowList as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}