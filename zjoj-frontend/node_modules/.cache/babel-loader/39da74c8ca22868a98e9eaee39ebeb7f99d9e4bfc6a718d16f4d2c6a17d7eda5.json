{"ast":null,"code":"var __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { $, getWindow, h } from '../../../../base/browser/dom.js';\nimport { findLast } from '../../../../base/common/arraysFind.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunWithStore, derived, observableFromEvent, observableValue, recomputeInitiallyAndOnChange, subtransaction, transaction } from '../../../../base/common/observable.js';\nimport { derivedDisposable } from '../../../../base/common/observableInternal/derived.js';\nimport './style.css';\nimport { EditorExtensionsRegistry } from '../../editorExtensions.js';\nimport { ICodeEditorService } from '../../services/codeEditorService.js';\nimport { StableEditorScrollState } from '../../stableEditorScroll.js';\nimport { CodeEditorWidget } from '../codeEditorWidget.js';\nimport { AccessibleDiffViewer } from './accessibleDiffViewer.js';\nimport { DiffEditorDecorations } from './diffEditorDecorations.js';\nimport { DiffEditorSash } from './diffEditorSash.js';\nimport { HideUnchangedRegionsFeature } from './hideUnchangedRegionsFeature.js';\nimport { ViewZoneManager } from './lineAlignment.js';\nimport { MovedBlocksLinesPart } from './movedBlocksLines.js';\nimport { OverviewRulerPart } from './overviewRulerPart.js';\nimport { ObservableElementSizeObserver, applyStyle, applyViewZones, bindContextKey, readHotReloadableExport, translatePosition } from './utils.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorType } from '../../../common/editorCommon.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { AudioCue, IAudioCueService } from '../../../../platform/audioCues/browser/audioCueService.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport './colors.js';\nimport { DelegatingEditor } from './delegatingEditorImpl.js';\nimport { DiffEditorEditors } from './diffEditorEditors.js';\nimport { DiffEditorOptions } from './diffEditorOptions.js';\nimport { DiffEditorViewModel } from './diffEditorViewModel.js';\nlet DiffEditorWidget = class DiffEditorWidget extends DelegatingEditor {\n  get onDidContentSizeChange() {\n    return this._editors.onDidContentSizeChange;\n  }\n  constructor(_domElement, options, codeEditorWidgetOptions, _parentContextKeyService, _parentInstantiationService, codeEditorService, _audioCueService, _editorProgressService) {\n    var _a;\n    super();\n    this._domElement = _domElement;\n    this._parentContextKeyService = _parentContextKeyService;\n    this._parentInstantiationService = _parentInstantiationService;\n    this._audioCueService = _audioCueService;\n    this._editorProgressService = _editorProgressService;\n    this.elements = h('div.monaco-diff-editor.side-by-side', {\n      style: {\n        position: 'relative',\n        height: '100%'\n      }\n    }, [h('div.noModificationsOverlay@overlay', {\n      style: {\n        position: 'absolute',\n        height: '100%',\n        visibility: 'hidden'\n      }\n    }, [$('span', {}, 'No Changes')]), h('div.editor.original@original', {\n      style: {\n        position: 'absolute',\n        height: '100%'\n      }\n    }), h('div.editor.modified@modified', {\n      style: {\n        position: 'absolute',\n        height: '100%'\n      }\n    }), h('div.accessibleDiffViewer@accessibleDiffViewer', {\n      style: {\n        position: 'absolute',\n        height: '100%'\n      }\n    })]);\n    this._diffModel = observableValue(this, undefined);\n    this._shouldDisposeDiffModel = false;\n    this.onDidChangeModel = Event.fromObservableLight(this._diffModel);\n    this._contextKeyService = this._register(this._parentContextKeyService.createScoped(this._domElement));\n    this._instantiationService = this._parentInstantiationService.createChild(new ServiceCollection([IContextKeyService, this._contextKeyService]));\n    this._boundarySashes = observableValue(this, undefined);\n    this._accessibleDiffViewerShouldBeVisible = observableValue(this, false);\n    this._accessibleDiffViewerVisible = derived(this, reader => this._options.onlyShowAccessibleDiffViewer.read(reader) ? true : this._accessibleDiffViewerShouldBeVisible.read(reader));\n    this._movedBlocksLinesPart = observableValue(this, undefined);\n    this._layoutInfo = derived(this, reader => {\n      var _a, _b, _c, _d, _e;\n      const width = this._rootSizeObserver.width.read(reader);\n      const height = this._rootSizeObserver.height.read(reader);\n      const sashLeft = (_a = this._sash.read(reader)) === null || _a === void 0 ? void 0 : _a.sashLeft.read(reader);\n      const originalWidth = sashLeft !== null && sashLeft !== void 0 ? sashLeft : Math.max(5, this._editors.original.getLayoutInfo().decorationsLeft);\n      const modifiedWidth = width - originalWidth - ((_c = (_b = this._overviewRulerPart.read(reader)) === null || _b === void 0 ? void 0 : _b.width) !== null && _c !== void 0 ? _c : 0);\n      const movedBlocksLinesWidth = (_e = (_d = this._movedBlocksLinesPart.read(reader)) === null || _d === void 0 ? void 0 : _d.width.read(reader)) !== null && _e !== void 0 ? _e : 0;\n      const originalWidthWithoutMovedBlockLines = originalWidth - movedBlocksLinesWidth;\n      this.elements.original.style.width = originalWidthWithoutMovedBlockLines + 'px';\n      this.elements.original.style.left = '0px';\n      this.elements.modified.style.width = modifiedWidth + 'px';\n      this.elements.modified.style.left = originalWidth + 'px';\n      this._editors.original.layout({\n        width: originalWidthWithoutMovedBlockLines,\n        height\n      }, true);\n      this._editors.modified.layout({\n        width: modifiedWidth,\n        height\n      }, true);\n      return {\n        modifiedEditor: this._editors.modified.getLayoutInfo(),\n        originalEditor: this._editors.original.getLayoutInfo()\n      };\n    });\n    this._diffValue = this._diffModel.map((m, r) => m === null || m === void 0 ? void 0 : m.diff.read(r));\n    this.onDidUpdateDiff = Event.fromObservableLight(this._diffValue);\n    codeEditorService.willCreateDiffEditor();\n    this._contextKeyService.createKey('isInDiffEditor', true);\n    this._domElement.appendChild(this.elements.root);\n    this._register(toDisposable(() => this._domElement.removeChild(this.elements.root)));\n    this._rootSizeObserver = this._register(new ObservableElementSizeObserver(this.elements.root, options.dimension));\n    this._rootSizeObserver.setAutomaticLayout((_a = options.automaticLayout) !== null && _a !== void 0 ? _a : false);\n    this._options = new DiffEditorOptions(options);\n    this._register(autorun(reader => {\n      this._options.setWidth(this._rootSizeObserver.width.read(reader));\n    }));\n    this._contextKeyService.createKey(EditorContextKeys.isEmbeddedDiffEditor.key, false);\n    this._register(bindContextKey(EditorContextKeys.isEmbeddedDiffEditor, this._contextKeyService, reader => this._options.isInEmbeddedEditor.read(reader)));\n    this._register(bindContextKey(EditorContextKeys.comparingMovedCode, this._contextKeyService, reader => {\n      var _a;\n      return !!((_a = this._diffModel.read(reader)) === null || _a === void 0 ? void 0 : _a.movedTextToCompare.read(reader));\n    }));\n    this._register(bindContextKey(EditorContextKeys.diffEditorRenderSideBySideInlineBreakpointReached, this._contextKeyService, reader => this._options.couldShowInlineViewBecauseOfSize.read(reader)));\n    this._register(bindContextKey(EditorContextKeys.hasChanges, this._contextKeyService, reader => {\n      var _a, _b, _c;\n      return ((_c = (_b = (_a = this._diffModel.read(reader)) === null || _a === void 0 ? void 0 : _a.diff.read(reader)) === null || _b === void 0 ? void 0 : _b.mappings.length) !== null && _c !== void 0 ? _c : 0) > 0;\n    }));\n    this._editors = this._register(this._instantiationService.createInstance(DiffEditorEditors, this.elements.original, this.elements.modified, this._options, codeEditorWidgetOptions, (i, c, o, o2) => this._createInnerEditor(i, c, o, o2)));\n    this._overviewRulerPart = derivedDisposable(this, reader => !this._options.renderOverviewRuler.read(reader) ? undefined : this._instantiationService.createInstance(readHotReloadableExport(OverviewRulerPart, reader), this._editors, this.elements.root, this._diffModel, this._rootSizeObserver.width, this._rootSizeObserver.height, this._layoutInfo.map(i => i.modifiedEditor))).recomputeInitiallyAndOnChange(this._store);\n    this._sash = derivedDisposable(this, reader => {\n      const showSash = this._options.renderSideBySide.read(reader);\n      this.elements.root.classList.toggle('side-by-side', showSash);\n      return !showSash ? undefined : new DiffEditorSash(this._options, this.elements.root, {\n        height: this._rootSizeObserver.height,\n        width: this._rootSizeObserver.width.map((w, reader) => {\n          var _a, _b;\n          return w - ((_b = (_a = this._overviewRulerPart.read(reader)) === null || _a === void 0 ? void 0 : _a.width) !== null && _b !== void 0 ? _b : 0);\n        })\n      }, this._boundarySashes);\n    }).recomputeInitiallyAndOnChange(this._store);\n    const unchangedRangesFeature = derivedDisposable(this, reader => /** @description UnchangedRangesFeature */this._instantiationService.createInstance(readHotReloadableExport(HideUnchangedRegionsFeature, reader), this._editors, this._diffModel, this._options)).recomputeInitiallyAndOnChange(this._store);\n    derivedDisposable(this, reader => /** @description DiffEditorDecorations */this._instantiationService.createInstance(readHotReloadableExport(DiffEditorDecorations, reader), this._editors, this._diffModel, this._options, this)).recomputeInitiallyAndOnChange(this._store);\n    const origViewZoneIdsToIgnore = new Set();\n    const modViewZoneIdsToIgnore = new Set();\n    let isUpdatingViewZones = false;\n    const viewZoneManager = derivedDisposable(this, reader => /** @description ViewZoneManager */this._instantiationService.createInstance(readHotReloadableExport(ViewZoneManager, reader), getWindow(this._domElement), this._editors, this._diffModel, this._options, this, () => isUpdatingViewZones || unchangedRangesFeature.get().isUpdatingHiddenAreas, origViewZoneIdsToIgnore, modViewZoneIdsToIgnore)).recomputeInitiallyAndOnChange(this._store);\n    const originalViewZones = derived(this, reader => {\n      const orig = viewZoneManager.read(reader).viewZones.read(reader).orig;\n      const orig2 = unchangedRangesFeature.read(reader).viewZones.read(reader).origViewZones;\n      return orig.concat(orig2);\n    });\n    const modifiedViewZones = derived(this, reader => {\n      const mod = viewZoneManager.read(reader).viewZones.read(reader).mod;\n      const mod2 = unchangedRangesFeature.read(reader).viewZones.read(reader).modViewZones;\n      return mod.concat(mod2);\n    });\n    this._register(applyViewZones(this._editors.original, originalViewZones, isUpdatingOrigViewZones => {\n      isUpdatingViewZones = isUpdatingOrigViewZones;\n    }, origViewZoneIdsToIgnore));\n    let scrollState;\n    this._register(applyViewZones(this._editors.modified, modifiedViewZones, isUpdatingModViewZones => {\n      isUpdatingViewZones = isUpdatingModViewZones;\n      if (isUpdatingViewZones) {\n        scrollState = StableEditorScrollState.capture(this._editors.modified);\n      } else {\n        scrollState === null || scrollState === void 0 ? void 0 : scrollState.restore(this._editors.modified);\n        scrollState = undefined;\n      }\n    }, modViewZoneIdsToIgnore));\n    this._accessibleDiffViewer = derivedDisposable(this, reader => this._instantiationService.createInstance(readHotReloadableExport(AccessibleDiffViewer, reader), this.elements.accessibleDiffViewer, this._accessibleDiffViewerVisible, (visible, tx) => this._accessibleDiffViewerShouldBeVisible.set(visible, tx), this._options.onlyShowAccessibleDiffViewer.map(v => !v), this._rootSizeObserver.width, this._rootSizeObserver.height, this._diffModel.map((m, r) => {\n      var _a;\n      return (_a = m === null || m === void 0 ? void 0 : m.diff.read(r)) === null || _a === void 0 ? void 0 : _a.mappings.map(m => m.lineRangeMapping);\n    }), this._editors)).recomputeInitiallyAndOnChange(this._store);\n    const visibility = this._accessibleDiffViewerVisible.map(v => v ? 'hidden' : 'visible');\n    this._register(applyStyle(this.elements.modified, {\n      visibility\n    }));\n    this._register(applyStyle(this.elements.original, {\n      visibility\n    }));\n    this._createDiffEditorContributions();\n    codeEditorService.addDiffEditor(this);\n    this._register(recomputeInitiallyAndOnChange(this._layoutInfo));\n    derivedDisposable(this, reader => /** @description MovedBlocksLinesPart */new (readHotReloadableExport(MovedBlocksLinesPart, reader))(this.elements.root, this._diffModel, this._layoutInfo.map(i => i.originalEditor), this._layoutInfo.map(i => i.modifiedEditor), this._editors)).recomputeInitiallyAndOnChange(this._store, value => {\n      // This is to break the layout info <-> moved blocks lines part dependency cycle.\n      this._movedBlocksLinesPart.set(value, undefined);\n    });\n    this._register(applyStyle(this.elements.overlay, {\n      width: this._layoutInfo.map((i, r) => i.originalEditor.width + (this._options.renderSideBySide.read(r) ? 0 : i.modifiedEditor.width)),\n      visibility: derived(reader => /** @description visibility */{\n        var _a, _b;\n        return this._options.hideUnchangedRegions.read(reader) && ((_b = (_a = this._diffModel.read(reader)) === null || _a === void 0 ? void 0 : _a.diff.read(reader)) === null || _b === void 0 ? void 0 : _b.mappings.length) === 0 ? 'visible' : 'hidden';\n      })\n    }));\n    this._register(Event.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition, e => {\n      var _a, _b;\n      if ((e === null || e === void 0 ? void 0 : e.reason) === 3 /* CursorChangeReason.Explicit */) {\n        const diff = (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get()) === null || _b === void 0 ? void 0 : _b.mappings.find(m => m.lineRangeMapping.modified.contains(e.position.lineNumber));\n        if (diff === null || diff === void 0 ? void 0 : diff.lineRangeMapping.modified.isEmpty) {\n          this._audioCueService.playAudioCue(AudioCue.diffLineDeleted, {\n            source: 'diffEditor.cursorPositionChanged'\n          });\n        } else if (diff === null || diff === void 0 ? void 0 : diff.lineRangeMapping.original.isEmpty) {\n          this._audioCueService.playAudioCue(AudioCue.diffLineInserted, {\n            source: 'diffEditor.cursorPositionChanged'\n          });\n        } else if (diff) {\n          this._audioCueService.playAudioCue(AudioCue.diffLineModified, {\n            source: 'diffEditor.cursorPositionChanged'\n          });\n        }\n      }\n    }));\n    const isInitializingDiff = this._diffModel.map(this, (m, reader) => {\n      /** @isInitializingDiff isDiffUpToDate */\n      if (!m) {\n        return undefined;\n      }\n      return m.diff.read(reader) === undefined && !m.isDiffUpToDate.read(reader);\n    });\n    this._register(autorunWithStore((reader, store) => {\n      /** @description DiffEditorWidgetHelper.ShowProgress */\n      if (isInitializingDiff.read(reader) === true) {\n        const r = this._editorProgressService.show(true, 1000);\n        store.add(toDisposable(() => r.done()));\n      }\n    }));\n    this._register(toDisposable(() => {\n      var _a;\n      if (this._shouldDisposeDiffModel) {\n        (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.dispose();\n      }\n    }));\n  }\n  _createInnerEditor(instantiationService, container, options, editorWidgetOptions) {\n    const editor = instantiationService.createInstance(CodeEditorWidget, container, options, editorWidgetOptions);\n    return editor;\n  }\n  _createDiffEditorContributions() {\n    const contributions = EditorExtensionsRegistry.getDiffEditorContributions();\n    for (const desc of contributions) {\n      try {\n        this._register(this._instantiationService.createInstance(desc.ctor, this));\n      } catch (err) {\n        onUnexpectedError(err);\n      }\n    }\n  }\n  get _targetEditor() {\n    return this._editors.modified;\n  }\n  getEditorType() {\n    return EditorType.IDiffEditor;\n  }\n  layout(dimension) {\n    this._rootSizeObserver.observe(dimension);\n  }\n  hasTextFocus() {\n    return this._editors.original.hasTextFocus() || this._editors.modified.hasTextFocus();\n  }\n  saveViewState() {\n    var _a;\n    const originalViewState = this._editors.original.saveViewState();\n    const modifiedViewState = this._editors.modified.saveViewState();\n    return {\n      original: originalViewState,\n      modified: modifiedViewState,\n      modelState: (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.serializeState()\n    };\n  }\n  restoreViewState(s) {\n    var _a;\n    if (s && s.original && s.modified) {\n      const diffEditorState = s;\n      this._editors.original.restoreViewState(diffEditorState.original);\n      this._editors.modified.restoreViewState(diffEditorState.modified);\n      if (diffEditorState.modelState) {\n        (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.restoreSerializedState(diffEditorState.modelState);\n      }\n    }\n  }\n  handleInitialized() {\n    this._editors.original.handleInitialized();\n    this._editors.modified.handleInitialized();\n  }\n  createViewModel(model) {\n    return this._instantiationService.createInstance(DiffEditorViewModel, model, this._options);\n  }\n  getModel() {\n    var _a, _b;\n    return (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.model) !== null && _b !== void 0 ? _b : null;\n  }\n  setModel(model, tx) {\n    if (!model && this._diffModel.get()) {\n      // Transitioning from a model to no-model\n      this._accessibleDiffViewer.get().close();\n    }\n    const vm = model ? 'model' in model ? {\n      model,\n      shouldDispose: false\n    } : {\n      model: this.createViewModel(model),\n      shouldDispose: true\n    } : undefined;\n    if (this._diffModel.get() !== (vm === null || vm === void 0 ? void 0 : vm.model)) {\n      subtransaction(tx, tx => {\n        var _a;\n        /** @description DiffEditorWidget.setModel */\n        observableFromEvent.batchEventsGlobally(tx, () => {\n          this._editors.original.setModel(vm ? vm.model.model.original : null);\n          this._editors.modified.setModel(vm ? vm.model.model.modified : null);\n        });\n        const prevValue = this._diffModel.get();\n        const shouldDispose = this._shouldDisposeDiffModel;\n        this._shouldDisposeDiffModel = (_a = vm === null || vm === void 0 ? void 0 : vm.shouldDispose) !== null && _a !== void 0 ? _a : false;\n        this._diffModel.set(vm === null || vm === void 0 ? void 0 : vm.model, tx);\n        if (shouldDispose) {\n          prevValue === null || prevValue === void 0 ? void 0 : prevValue.dispose();\n        }\n      });\n    }\n  }\n  /**\n   * @param changedOptions Only has values for top-level options that have actually changed.\n   */\n  updateOptions(changedOptions) {\n    this._options.updateOptions(changedOptions);\n  }\n  getContainerDomNode() {\n    return this._domElement;\n  }\n  getOriginalEditor() {\n    return this._editors.original;\n  }\n  getModifiedEditor() {\n    return this._editors.modified;\n  }\n  /**\n   * @deprecated Use `this.getDiffComputationResult().changes2` instead.\n   */\n  getLineChanges() {\n    var _a;\n    const diffState = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get();\n    if (!diffState) {\n      return null;\n    }\n    return toLineChanges(diffState);\n  }\n  revert(diff) {\n    var _a;\n    if (diff.innerChanges) {\n      this.revertRangeMappings(diff.innerChanges);\n      return;\n    }\n    const model = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.model;\n    if (!model) {\n      return;\n    }\n    this._editors.modified.executeEdits('diffEditor', [{\n      range: diff.modified.toExclusiveRange(),\n      text: model.original.getValueInRange(diff.original.toExclusiveRange())\n    }]);\n  }\n  revertRangeMappings(diffs) {\n    const model = this._diffModel.get();\n    if (!model || !model.isDiffUpToDate.get()) {\n      return;\n    }\n    const changes = diffs.map(c => ({\n      range: c.modifiedRange,\n      text: model.model.original.getValueInRange(c.originalRange)\n    }));\n    this._editors.modified.executeEdits('diffEditor', changes);\n  }\n  _goTo(diff) {\n    this._editors.modified.setPosition(new Position(diff.lineRangeMapping.modified.startLineNumber, 1));\n    this._editors.modified.revealRangeInCenter(diff.lineRangeMapping.modified.toExclusiveRange());\n  }\n  goToDiff(target) {\n    var _a, _b, _c, _d;\n    const diffs = (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get()) === null || _b === void 0 ? void 0 : _b.mappings;\n    if (!diffs || diffs.length === 0) {\n      return;\n    }\n    const curLineNumber = this._editors.modified.getPosition().lineNumber;\n    let diff;\n    if (target === 'next') {\n      diff = (_c = diffs.find(d => d.lineRangeMapping.modified.startLineNumber > curLineNumber)) !== null && _c !== void 0 ? _c : diffs[0];\n    } else {\n      diff = (_d = findLast(diffs, d => d.lineRangeMapping.modified.startLineNumber < curLineNumber)) !== null && _d !== void 0 ? _d : diffs[diffs.length - 1];\n    }\n    this._goTo(diff);\n    if (diff.lineRangeMapping.modified.isEmpty) {\n      this._audioCueService.playAudioCue(AudioCue.diffLineDeleted, {\n        source: 'diffEditor.goToDiff'\n      });\n    } else if (diff.lineRangeMapping.original.isEmpty) {\n      this._audioCueService.playAudioCue(AudioCue.diffLineInserted, {\n        source: 'diffEditor.goToDiff'\n      });\n    } else if (diff) {\n      this._audioCueService.playAudioCue(AudioCue.diffLineModified, {\n        source: 'diffEditor.goToDiff'\n      });\n    }\n  }\n  revealFirstDiff() {\n    const diffModel = this._diffModel.get();\n    if (!diffModel) {\n      return;\n    }\n    // wait for the diff computation to finish\n    this.waitForDiff().then(() => {\n      var _a;\n      const diffs = (_a = diffModel.diff.get()) === null || _a === void 0 ? void 0 : _a.mappings;\n      if (!diffs || diffs.length === 0) {\n        return;\n      }\n      this._goTo(diffs[0]);\n    });\n  }\n  accessibleDiffViewerNext() {\n    this._accessibleDiffViewer.get().next();\n  }\n  accessibleDiffViewerPrev() {\n    this._accessibleDiffViewer.get().prev();\n  }\n  async waitForDiff() {\n    const diffModel = this._diffModel.get();\n    if (!diffModel) {\n      return;\n    }\n    await diffModel.waitForDiff();\n  }\n  mapToOtherSide() {\n    var _a, _b;\n    const isModifiedFocus = this._editors.modified.hasWidgetFocus();\n    const source = isModifiedFocus ? this._editors.modified : this._editors.original;\n    const destination = isModifiedFocus ? this._editors.original : this._editors.modified;\n    let destinationSelection;\n    const sourceSelection = source.getSelection();\n    if (sourceSelection) {\n      const mappings = (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get()) === null || _b === void 0 ? void 0 : _b.mappings.map(m => isModifiedFocus ? m.lineRangeMapping.flip() : m.lineRangeMapping);\n      if (mappings) {\n        const newRange1 = translatePosition(sourceSelection.getStartPosition(), mappings);\n        const newRange2 = translatePosition(sourceSelection.getEndPosition(), mappings);\n        destinationSelection = Range.plusRange(newRange1, newRange2);\n      }\n    }\n    return {\n      destination,\n      destinationSelection\n    };\n  }\n  switchSide() {\n    const {\n      destination,\n      destinationSelection\n    } = this.mapToOtherSide();\n    destination.focus();\n    if (destinationSelection) {\n      destination.setSelection(destinationSelection);\n    }\n  }\n  exitCompareMove() {\n    const model = this._diffModel.get();\n    if (!model) {\n      return;\n    }\n    model.movedTextToCompare.set(undefined, undefined);\n  }\n  collapseAllUnchangedRegions() {\n    var _a;\n    const unchangedRegions = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.unchangedRegions.get();\n    if (!unchangedRegions) {\n      return;\n    }\n    transaction(tx => {\n      for (const region of unchangedRegions) {\n        region.collapseAll(tx);\n      }\n    });\n  }\n  showAllUnchangedRegions() {\n    var _a;\n    const unchangedRegions = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.unchangedRegions.get();\n    if (!unchangedRegions) {\n      return;\n    }\n    transaction(tx => {\n      for (const region of unchangedRegions) {\n        region.showAll(tx);\n      }\n    });\n  }\n};\nDiffEditorWidget = __decorate([__param(3, IContextKeyService), __param(4, IInstantiationService), __param(5, ICodeEditorService), __param(6, IAudioCueService), __param(7, IEditorProgressService)], DiffEditorWidget);\nexport { DiffEditorWidget };\nfunction toLineChanges(state) {\n  return state.mappings.map(x => {\n    const m = x.lineRangeMapping;\n    let originalStartLineNumber;\n    let originalEndLineNumber;\n    let modifiedStartLineNumber;\n    let modifiedEndLineNumber;\n    let innerChanges = m.innerChanges;\n    if (m.original.isEmpty) {\n      // Insertion\n      originalStartLineNumber = m.original.startLineNumber - 1;\n      originalEndLineNumber = 0;\n      innerChanges = undefined;\n    } else {\n      originalStartLineNumber = m.original.startLineNumber;\n      originalEndLineNumber = m.original.endLineNumberExclusive - 1;\n    }\n    if (m.modified.isEmpty) {\n      // Deletion\n      modifiedStartLineNumber = m.modified.startLineNumber - 1;\n      modifiedEndLineNumber = 0;\n      innerChanges = undefined;\n    } else {\n      modifiedStartLineNumber = m.modified.startLineNumber;\n      modifiedEndLineNumber = m.modified.endLineNumberExclusive - 1;\n    }\n    return {\n      originalStartLineNumber,\n      originalEndLineNumber,\n      modifiedStartLineNumber,\n      modifiedEndLineNumber,\n      charChanges: innerChanges === null || innerChanges === void 0 ? void 0 : innerChanges.map(m => ({\n        originalStartLineNumber: m.originalRange.startLineNumber,\n        originalStartColumn: m.originalRange.startColumn,\n        originalEndLineNumber: m.originalRange.endLineNumber,\n        originalEndColumn: m.originalRange.endColumn,\n        modifiedStartLineNumber: m.modifiedRange.startLineNumber,\n        modifiedStartColumn: m.modifiedRange.startColumn,\n        modifiedEndLineNumber: m.modifiedRange.endLineNumber,\n        modifiedEndColumn: m.modifiedRange.endColumn\n      }))\n    };\n  });\n}","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","$","getWindow","h","findLast","onUnexpectedError","Event","toDisposable","autorun","autorunWithStore","derived","observableFromEvent","observableValue","recomputeInitiallyAndOnChange","subtransaction","transaction","derivedDisposable","EditorExtensionsRegistry","ICodeEditorService","StableEditorScrollState","CodeEditorWidget","AccessibleDiffViewer","DiffEditorDecorations","DiffEditorSash","HideUnchangedRegionsFeature","ViewZoneManager","MovedBlocksLinesPart","OverviewRulerPart","ObservableElementSizeObserver","applyStyle","applyViewZones","bindContextKey","readHotReloadableExport","translatePosition","Position","Range","EditorType","EditorContextKeys","AudioCue","IAudioCueService","IContextKeyService","IInstantiationService","ServiceCollection","IEditorProgressService","DelegatingEditor","DiffEditorEditors","DiffEditorOptions","DiffEditorViewModel","DiffEditorWidget","onDidContentSizeChange","_editors","constructor","_domElement","options","codeEditorWidgetOptions","_parentContextKeyService","_parentInstantiationService","codeEditorService","_audioCueService","_editorProgressService","_a","elements","style","position","height","visibility","_diffModel","undefined","_shouldDisposeDiffModel","onDidChangeModel","fromObservableLight","_contextKeyService","_register","createScoped","_instantiationService","createChild","_boundarySashes","_accessibleDiffViewerShouldBeVisible","_accessibleDiffViewerVisible","reader","_options","onlyShowAccessibleDiffViewer","read","_movedBlocksLinesPart","_layoutInfo","_b","_c","_d","_e","width","_rootSizeObserver","sashLeft","_sash","originalWidth","Math","max","original","getLayoutInfo","decorationsLeft","modifiedWidth","_overviewRulerPart","movedBlocksLinesWidth","originalWidthWithoutMovedBlockLines","left","modified","layout","modifiedEditor","originalEditor","_diffValue","map","m","diff","onDidUpdateDiff","willCreateDiffEditor","createKey","appendChild","root","removeChild","dimension","setAutomaticLayout","automaticLayout","setWidth","isEmbeddedDiffEditor","isInEmbeddedEditor","comparingMovedCode","movedTextToCompare","diffEditorRenderSideBySideInlineBreakpointReached","couldShowInlineViewBecauseOfSize","hasChanges","mappings","createInstance","o","o2","_createInnerEditor","renderOverviewRuler","_store","showSash","renderSideBySide","classList","toggle","w","unchangedRangesFeature","origViewZoneIdsToIgnore","Set","modViewZoneIdsToIgnore","isUpdatingViewZones","viewZoneManager","get","isUpdatingHiddenAreas","originalViewZones","orig","viewZones","orig2","origViewZones","concat","modifiedViewZones","mod","mod2","modViewZones","isUpdatingOrigViewZones","scrollState","isUpdatingModViewZones","capture","restore","_accessibleDiffViewer","accessibleDiffViewer","visible","tx","set","v","lineRangeMapping","_createDiffEditorContributions","addDiffEditor","value","overlay","hideUnchangedRegions","runAndSubscribe","onDidChangeCursorPosition","e","reason","find","contains","lineNumber","isEmpty","playAudioCue","diffLineDeleted","source","diffLineInserted","diffLineModified","isInitializingDiff","isDiffUpToDate","store","show","add","done","dispose","instantiationService","container","editorWidgetOptions","editor","contributions","getDiffEditorContributions","ctor","err","_targetEditor","getEditorType","IDiffEditor","observe","hasTextFocus","saveViewState","originalViewState","modifiedViewState","modelState","serializeState","restoreViewState","s","diffEditorState","restoreSerializedState","handleInitialized","createViewModel","model","getModel","setModel","close","vm","shouldDispose","batchEventsGlobally","prevValue","updateOptions","changedOptions","getContainerDomNode","getOriginalEditor","getModifiedEditor","getLineChanges","diffState","toLineChanges","revert","innerChanges","revertRangeMappings","executeEdits","range","toExclusiveRange","text","getValueInRange","diffs","changes","modifiedRange","originalRange","_goTo","setPosition","startLineNumber","revealRangeInCenter","goToDiff","curLineNumber","getPosition","revealFirstDiff","diffModel","waitForDiff","then","accessibleDiffViewerNext","next","accessibleDiffViewerPrev","prev","mapToOtherSide","isModifiedFocus","hasWidgetFocus","destination","destinationSelection","sourceSelection","getSelection","flip","newRange1","getStartPosition","newRange2","getEndPosition","plusRange","switchSide","focus","setSelection","exitCompareMove","collapseAllUnchangedRegions","unchangedRegions","region","collapseAll","showAllUnchangedRegions","showAll","state","x","originalStartLineNumber","originalEndLineNumber","modifiedStartLineNumber","modifiedEndLineNumber","endLineNumberExclusive","charChanges","originalStartColumn","startColumn","endLineNumber","originalEndColumn","endColumn","modifiedStartColumn","modifiedEndColumn"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/monaco-editor/esm/vs/editor/browser/widget/diffEditor/diffEditorWidget.js"],"sourcesContent":["var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { $, getWindow, h } from '../../../../base/browser/dom.js';\nimport { findLast } from '../../../../base/common/arraysFind.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Event } from '../../../../base/common/event.js';\nimport { toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunWithStore, derived, observableFromEvent, observableValue, recomputeInitiallyAndOnChange, subtransaction, transaction } from '../../../../base/common/observable.js';\nimport { derivedDisposable } from '../../../../base/common/observableInternal/derived.js';\nimport './style.css';\nimport { EditorExtensionsRegistry } from '../../editorExtensions.js';\nimport { ICodeEditorService } from '../../services/codeEditorService.js';\nimport { StableEditorScrollState } from '../../stableEditorScroll.js';\nimport { CodeEditorWidget } from '../codeEditorWidget.js';\nimport { AccessibleDiffViewer } from './accessibleDiffViewer.js';\nimport { DiffEditorDecorations } from './diffEditorDecorations.js';\nimport { DiffEditorSash } from './diffEditorSash.js';\nimport { HideUnchangedRegionsFeature } from './hideUnchangedRegionsFeature.js';\nimport { ViewZoneManager } from './lineAlignment.js';\nimport { MovedBlocksLinesPart } from './movedBlocksLines.js';\nimport { OverviewRulerPart } from './overviewRulerPart.js';\nimport { ObservableElementSizeObserver, applyStyle, applyViewZones, bindContextKey, readHotReloadableExport, translatePosition } from './utils.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorType } from '../../../common/editorCommon.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { AudioCue, IAudioCueService } from '../../../../platform/audioCues/browser/audioCueService.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport './colors.js';\nimport { DelegatingEditor } from './delegatingEditorImpl.js';\nimport { DiffEditorEditors } from './diffEditorEditors.js';\nimport { DiffEditorOptions } from './diffEditorOptions.js';\nimport { DiffEditorViewModel } from './diffEditorViewModel.js';\nlet DiffEditorWidget = class DiffEditorWidget extends DelegatingEditor {\n    get onDidContentSizeChange() { return this._editors.onDidContentSizeChange; }\n    constructor(_domElement, options, codeEditorWidgetOptions, _parentContextKeyService, _parentInstantiationService, codeEditorService, _audioCueService, _editorProgressService) {\n        var _a;\n        super();\n        this._domElement = _domElement;\n        this._parentContextKeyService = _parentContextKeyService;\n        this._parentInstantiationService = _parentInstantiationService;\n        this._audioCueService = _audioCueService;\n        this._editorProgressService = _editorProgressService;\n        this.elements = h('div.monaco-diff-editor.side-by-side', { style: { position: 'relative', height: '100%' } }, [\n            h('div.noModificationsOverlay@overlay', { style: { position: 'absolute', height: '100%', visibility: 'hidden', } }, [$('span', {}, 'No Changes')]),\n            h('div.editor.original@original', { style: { position: 'absolute', height: '100%' } }),\n            h('div.editor.modified@modified', { style: { position: 'absolute', height: '100%' } }),\n            h('div.accessibleDiffViewer@accessibleDiffViewer', { style: { position: 'absolute', height: '100%' } }),\n        ]);\n        this._diffModel = observableValue(this, undefined);\n        this._shouldDisposeDiffModel = false;\n        this.onDidChangeModel = Event.fromObservableLight(this._diffModel);\n        this._contextKeyService = this._register(this._parentContextKeyService.createScoped(this._domElement));\n        this._instantiationService = this._parentInstantiationService.createChild(new ServiceCollection([IContextKeyService, this._contextKeyService]));\n        this._boundarySashes = observableValue(this, undefined);\n        this._accessibleDiffViewerShouldBeVisible = observableValue(this, false);\n        this._accessibleDiffViewerVisible = derived(this, reader => this._options.onlyShowAccessibleDiffViewer.read(reader)\n            ? true\n            : this._accessibleDiffViewerShouldBeVisible.read(reader));\n        this._movedBlocksLinesPart = observableValue(this, undefined);\n        this._layoutInfo = derived(this, reader => {\n            var _a, _b, _c, _d, _e;\n            const width = this._rootSizeObserver.width.read(reader);\n            const height = this._rootSizeObserver.height.read(reader);\n            const sashLeft = (_a = this._sash.read(reader)) === null || _a === void 0 ? void 0 : _a.sashLeft.read(reader);\n            const originalWidth = sashLeft !== null && sashLeft !== void 0 ? sashLeft : Math.max(5, this._editors.original.getLayoutInfo().decorationsLeft);\n            const modifiedWidth = width - originalWidth - ((_c = (_b = this._overviewRulerPart.read(reader)) === null || _b === void 0 ? void 0 : _b.width) !== null && _c !== void 0 ? _c : 0);\n            const movedBlocksLinesWidth = (_e = (_d = this._movedBlocksLinesPart.read(reader)) === null || _d === void 0 ? void 0 : _d.width.read(reader)) !== null && _e !== void 0 ? _e : 0;\n            const originalWidthWithoutMovedBlockLines = originalWidth - movedBlocksLinesWidth;\n            this.elements.original.style.width = originalWidthWithoutMovedBlockLines + 'px';\n            this.elements.original.style.left = '0px';\n            this.elements.modified.style.width = modifiedWidth + 'px';\n            this.elements.modified.style.left = originalWidth + 'px';\n            this._editors.original.layout({ width: originalWidthWithoutMovedBlockLines, height }, true);\n            this._editors.modified.layout({ width: modifiedWidth, height }, true);\n            return {\n                modifiedEditor: this._editors.modified.getLayoutInfo(),\n                originalEditor: this._editors.original.getLayoutInfo(),\n            };\n        });\n        this._diffValue = this._diffModel.map((m, r) => m === null || m === void 0 ? void 0 : m.diff.read(r));\n        this.onDidUpdateDiff = Event.fromObservableLight(this._diffValue);\n        codeEditorService.willCreateDiffEditor();\n        this._contextKeyService.createKey('isInDiffEditor', true);\n        this._domElement.appendChild(this.elements.root);\n        this._register(toDisposable(() => this._domElement.removeChild(this.elements.root)));\n        this._rootSizeObserver = this._register(new ObservableElementSizeObserver(this.elements.root, options.dimension));\n        this._rootSizeObserver.setAutomaticLayout((_a = options.automaticLayout) !== null && _a !== void 0 ? _a : false);\n        this._options = new DiffEditorOptions(options);\n        this._register(autorun(reader => {\n            this._options.setWidth(this._rootSizeObserver.width.read(reader));\n        }));\n        this._contextKeyService.createKey(EditorContextKeys.isEmbeddedDiffEditor.key, false);\n        this._register(bindContextKey(EditorContextKeys.isEmbeddedDiffEditor, this._contextKeyService, reader => this._options.isInEmbeddedEditor.read(reader)));\n        this._register(bindContextKey(EditorContextKeys.comparingMovedCode, this._contextKeyService, reader => { var _a; return !!((_a = this._diffModel.read(reader)) === null || _a === void 0 ? void 0 : _a.movedTextToCompare.read(reader)); }));\n        this._register(bindContextKey(EditorContextKeys.diffEditorRenderSideBySideInlineBreakpointReached, this._contextKeyService, reader => this._options.couldShowInlineViewBecauseOfSize.read(reader)));\n        this._register(bindContextKey(EditorContextKeys.hasChanges, this._contextKeyService, reader => { var _a, _b, _c; return ((_c = (_b = (_a = this._diffModel.read(reader)) === null || _a === void 0 ? void 0 : _a.diff.read(reader)) === null || _b === void 0 ? void 0 : _b.mappings.length) !== null && _c !== void 0 ? _c : 0) > 0; }));\n        this._editors = this._register(this._instantiationService.createInstance(DiffEditorEditors, this.elements.original, this.elements.modified, this._options, codeEditorWidgetOptions, (i, c, o, o2) => this._createInnerEditor(i, c, o, o2)));\n        this._overviewRulerPart = derivedDisposable(this, reader => !this._options.renderOverviewRuler.read(reader)\n            ? undefined\n            : this._instantiationService.createInstance(readHotReloadableExport(OverviewRulerPart, reader), this._editors, this.elements.root, this._diffModel, this._rootSizeObserver.width, this._rootSizeObserver.height, this._layoutInfo.map(i => i.modifiedEditor))).recomputeInitiallyAndOnChange(this._store);\n        this._sash = derivedDisposable(this, reader => {\n            const showSash = this._options.renderSideBySide.read(reader);\n            this.elements.root.classList.toggle('side-by-side', showSash);\n            return !showSash ? undefined : new DiffEditorSash(this._options, this.elements.root, {\n                height: this._rootSizeObserver.height,\n                width: this._rootSizeObserver.width.map((w, reader) => { var _a, _b; return w - ((_b = (_a = this._overviewRulerPart.read(reader)) === null || _a === void 0 ? void 0 : _a.width) !== null && _b !== void 0 ? _b : 0); }),\n            }, this._boundarySashes);\n        }).recomputeInitiallyAndOnChange(this._store);\n        const unchangedRangesFeature = derivedDisposable(this, reader => /** @description UnchangedRangesFeature */ this._instantiationService.createInstance(readHotReloadableExport(HideUnchangedRegionsFeature, reader), this._editors, this._diffModel, this._options)).recomputeInitiallyAndOnChange(this._store);\n        derivedDisposable(this, reader => /** @description DiffEditorDecorations */ this._instantiationService.createInstance(readHotReloadableExport(DiffEditorDecorations, reader), this._editors, this._diffModel, this._options, this)).recomputeInitiallyAndOnChange(this._store);\n        const origViewZoneIdsToIgnore = new Set();\n        const modViewZoneIdsToIgnore = new Set();\n        let isUpdatingViewZones = false;\n        const viewZoneManager = derivedDisposable(this, reader => /** @description ViewZoneManager */ this._instantiationService.createInstance(readHotReloadableExport(ViewZoneManager, reader), getWindow(this._domElement), this._editors, this._diffModel, this._options, this, () => isUpdatingViewZones || unchangedRangesFeature.get().isUpdatingHiddenAreas, origViewZoneIdsToIgnore, modViewZoneIdsToIgnore)).recomputeInitiallyAndOnChange(this._store);\n        const originalViewZones = derived(this, (reader) => {\n            const orig = viewZoneManager.read(reader).viewZones.read(reader).orig;\n            const orig2 = unchangedRangesFeature.read(reader).viewZones.read(reader).origViewZones;\n            return orig.concat(orig2);\n        });\n        const modifiedViewZones = derived(this, (reader) => {\n            const mod = viewZoneManager.read(reader).viewZones.read(reader).mod;\n            const mod2 = unchangedRangesFeature.read(reader).viewZones.read(reader).modViewZones;\n            return mod.concat(mod2);\n        });\n        this._register(applyViewZones(this._editors.original, originalViewZones, isUpdatingOrigViewZones => {\n            isUpdatingViewZones = isUpdatingOrigViewZones;\n        }, origViewZoneIdsToIgnore));\n        let scrollState;\n        this._register(applyViewZones(this._editors.modified, modifiedViewZones, isUpdatingModViewZones => {\n            isUpdatingViewZones = isUpdatingModViewZones;\n            if (isUpdatingViewZones) {\n                scrollState = StableEditorScrollState.capture(this._editors.modified);\n            }\n            else {\n                scrollState === null || scrollState === void 0 ? void 0 : scrollState.restore(this._editors.modified);\n                scrollState = undefined;\n            }\n        }, modViewZoneIdsToIgnore));\n        this._accessibleDiffViewer = derivedDisposable(this, reader => this._instantiationService.createInstance(readHotReloadableExport(AccessibleDiffViewer, reader), this.elements.accessibleDiffViewer, this._accessibleDiffViewerVisible, (visible, tx) => this._accessibleDiffViewerShouldBeVisible.set(visible, tx), this._options.onlyShowAccessibleDiffViewer.map(v => !v), this._rootSizeObserver.width, this._rootSizeObserver.height, this._diffModel.map((m, r) => { var _a; return (_a = m === null || m === void 0 ? void 0 : m.diff.read(r)) === null || _a === void 0 ? void 0 : _a.mappings.map(m => m.lineRangeMapping); }), this._editors)).recomputeInitiallyAndOnChange(this._store);\n        const visibility = this._accessibleDiffViewerVisible.map(v => v ? 'hidden' : 'visible');\n        this._register(applyStyle(this.elements.modified, { visibility }));\n        this._register(applyStyle(this.elements.original, { visibility }));\n        this._createDiffEditorContributions();\n        codeEditorService.addDiffEditor(this);\n        this._register(recomputeInitiallyAndOnChange(this._layoutInfo));\n        derivedDisposable(this, reader => /** @description MovedBlocksLinesPart */ new (readHotReloadableExport(MovedBlocksLinesPart, reader))(this.elements.root, this._diffModel, this._layoutInfo.map(i => i.originalEditor), this._layoutInfo.map(i => i.modifiedEditor), this._editors)).recomputeInitiallyAndOnChange(this._store, value => {\n            // This is to break the layout info <-> moved blocks lines part dependency cycle.\n            this._movedBlocksLinesPart.set(value, undefined);\n        });\n        this._register(applyStyle(this.elements.overlay, {\n            width: this._layoutInfo.map((i, r) => i.originalEditor.width + (this._options.renderSideBySide.read(r) ? 0 : i.modifiedEditor.width)),\n            visibility: derived(reader => /** @description visibility */ {\n                var _a, _b;\n                return (this._options.hideUnchangedRegions.read(reader) && ((_b = (_a = this._diffModel.read(reader)) === null || _a === void 0 ? void 0 : _a.diff.read(reader)) === null || _b === void 0 ? void 0 : _b.mappings.length) === 0)\n                    ? 'visible' : 'hidden';\n            }),\n        }));\n        this._register(Event.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition, (e) => {\n            var _a, _b;\n            if ((e === null || e === void 0 ? void 0 : e.reason) === 3 /* CursorChangeReason.Explicit */) {\n                const diff = (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get()) === null || _b === void 0 ? void 0 : _b.mappings.find(m => m.lineRangeMapping.modified.contains(e.position.lineNumber));\n                if (diff === null || diff === void 0 ? void 0 : diff.lineRangeMapping.modified.isEmpty) {\n                    this._audioCueService.playAudioCue(AudioCue.diffLineDeleted, { source: 'diffEditor.cursorPositionChanged' });\n                }\n                else if (diff === null || diff === void 0 ? void 0 : diff.lineRangeMapping.original.isEmpty) {\n                    this._audioCueService.playAudioCue(AudioCue.diffLineInserted, { source: 'diffEditor.cursorPositionChanged' });\n                }\n                else if (diff) {\n                    this._audioCueService.playAudioCue(AudioCue.diffLineModified, { source: 'diffEditor.cursorPositionChanged' });\n                }\n            }\n        }));\n        const isInitializingDiff = this._diffModel.map(this, (m, reader) => {\n            /** @isInitializingDiff isDiffUpToDate */\n            if (!m) {\n                return undefined;\n            }\n            return m.diff.read(reader) === undefined && !m.isDiffUpToDate.read(reader);\n        });\n        this._register(autorunWithStore((reader, store) => {\n            /** @description DiffEditorWidgetHelper.ShowProgress */\n            if (isInitializingDiff.read(reader) === true) {\n                const r = this._editorProgressService.show(true, 1000);\n                store.add(toDisposable(() => r.done()));\n            }\n        }));\n        this._register(toDisposable(() => {\n            var _a;\n            if (this._shouldDisposeDiffModel) {\n                (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.dispose();\n            }\n        }));\n    }\n    _createInnerEditor(instantiationService, container, options, editorWidgetOptions) {\n        const editor = instantiationService.createInstance(CodeEditorWidget, container, options, editorWidgetOptions);\n        return editor;\n    }\n    _createDiffEditorContributions() {\n        const contributions = EditorExtensionsRegistry.getDiffEditorContributions();\n        for (const desc of contributions) {\n            try {\n                this._register(this._instantiationService.createInstance(desc.ctor, this));\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n        }\n    }\n    get _targetEditor() { return this._editors.modified; }\n    getEditorType() { return EditorType.IDiffEditor; }\n    layout(dimension) {\n        this._rootSizeObserver.observe(dimension);\n    }\n    hasTextFocus() { return this._editors.original.hasTextFocus() || this._editors.modified.hasTextFocus(); }\n    saveViewState() {\n        var _a;\n        const originalViewState = this._editors.original.saveViewState();\n        const modifiedViewState = this._editors.modified.saveViewState();\n        return {\n            original: originalViewState,\n            modified: modifiedViewState,\n            modelState: (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.serializeState(),\n        };\n    }\n    restoreViewState(s) {\n        var _a;\n        if (s && s.original && s.modified) {\n            const diffEditorState = s;\n            this._editors.original.restoreViewState(diffEditorState.original);\n            this._editors.modified.restoreViewState(diffEditorState.modified);\n            if (diffEditorState.modelState) {\n                (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.restoreSerializedState(diffEditorState.modelState);\n            }\n        }\n    }\n    handleInitialized() {\n        this._editors.original.handleInitialized();\n        this._editors.modified.handleInitialized();\n    }\n    createViewModel(model) {\n        return this._instantiationService.createInstance(DiffEditorViewModel, model, this._options);\n    }\n    getModel() { var _a, _b; return (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.model) !== null && _b !== void 0 ? _b : null; }\n    setModel(model, tx) {\n        if (!model && this._diffModel.get()) {\n            // Transitioning from a model to no-model\n            this._accessibleDiffViewer.get().close();\n        }\n        const vm = model ? ('model' in model) ? { model, shouldDispose: false } : { model: this.createViewModel(model), shouldDispose: true } : undefined;\n        if (this._diffModel.get() !== (vm === null || vm === void 0 ? void 0 : vm.model)) {\n            subtransaction(tx, tx => {\n                var _a;\n                /** @description DiffEditorWidget.setModel */\n                observableFromEvent.batchEventsGlobally(tx, () => {\n                    this._editors.original.setModel(vm ? vm.model.model.original : null);\n                    this._editors.modified.setModel(vm ? vm.model.model.modified : null);\n                });\n                const prevValue = this._diffModel.get();\n                const shouldDispose = this._shouldDisposeDiffModel;\n                this._shouldDisposeDiffModel = (_a = vm === null || vm === void 0 ? void 0 : vm.shouldDispose) !== null && _a !== void 0 ? _a : false;\n                this._diffModel.set(vm === null || vm === void 0 ? void 0 : vm.model, tx);\n                if (shouldDispose) {\n                    prevValue === null || prevValue === void 0 ? void 0 : prevValue.dispose();\n                }\n            });\n        }\n    }\n    /**\n     * @param changedOptions Only has values for top-level options that have actually changed.\n     */\n    updateOptions(changedOptions) {\n        this._options.updateOptions(changedOptions);\n    }\n    getContainerDomNode() { return this._domElement; }\n    getOriginalEditor() { return this._editors.original; }\n    getModifiedEditor() { return this._editors.modified; }\n    /**\n     * @deprecated Use `this.getDiffComputationResult().changes2` instead.\n     */\n    getLineChanges() {\n        var _a;\n        const diffState = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get();\n        if (!diffState) {\n            return null;\n        }\n        return toLineChanges(diffState);\n    }\n    revert(diff) {\n        var _a;\n        if (diff.innerChanges) {\n            this.revertRangeMappings(diff.innerChanges);\n            return;\n        }\n        const model = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.model;\n        if (!model) {\n            return;\n        }\n        this._editors.modified.executeEdits('diffEditor', [\n            {\n                range: diff.modified.toExclusiveRange(),\n                text: model.original.getValueInRange(diff.original.toExclusiveRange())\n            }\n        ]);\n    }\n    revertRangeMappings(diffs) {\n        const model = this._diffModel.get();\n        if (!model || !model.isDiffUpToDate.get()) {\n            return;\n        }\n        const changes = diffs.map(c => ({\n            range: c.modifiedRange,\n            text: model.model.original.getValueInRange(c.originalRange)\n        }));\n        this._editors.modified.executeEdits('diffEditor', changes);\n    }\n    _goTo(diff) {\n        this._editors.modified.setPosition(new Position(diff.lineRangeMapping.modified.startLineNumber, 1));\n        this._editors.modified.revealRangeInCenter(diff.lineRangeMapping.modified.toExclusiveRange());\n    }\n    goToDiff(target) {\n        var _a, _b, _c, _d;\n        const diffs = (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get()) === null || _b === void 0 ? void 0 : _b.mappings;\n        if (!diffs || diffs.length === 0) {\n            return;\n        }\n        const curLineNumber = this._editors.modified.getPosition().lineNumber;\n        let diff;\n        if (target === 'next') {\n            diff = (_c = diffs.find(d => d.lineRangeMapping.modified.startLineNumber > curLineNumber)) !== null && _c !== void 0 ? _c : diffs[0];\n        }\n        else {\n            diff = (_d = findLast(diffs, d => d.lineRangeMapping.modified.startLineNumber < curLineNumber)) !== null && _d !== void 0 ? _d : diffs[diffs.length - 1];\n        }\n        this._goTo(diff);\n        if (diff.lineRangeMapping.modified.isEmpty) {\n            this._audioCueService.playAudioCue(AudioCue.diffLineDeleted, { source: 'diffEditor.goToDiff' });\n        }\n        else if (diff.lineRangeMapping.original.isEmpty) {\n            this._audioCueService.playAudioCue(AudioCue.diffLineInserted, { source: 'diffEditor.goToDiff' });\n        }\n        else if (diff) {\n            this._audioCueService.playAudioCue(AudioCue.diffLineModified, { source: 'diffEditor.goToDiff' });\n        }\n    }\n    revealFirstDiff() {\n        const diffModel = this._diffModel.get();\n        if (!diffModel) {\n            return;\n        }\n        // wait for the diff computation to finish\n        this.waitForDiff().then(() => {\n            var _a;\n            const diffs = (_a = diffModel.diff.get()) === null || _a === void 0 ? void 0 : _a.mappings;\n            if (!diffs || diffs.length === 0) {\n                return;\n            }\n            this._goTo(diffs[0]);\n        });\n    }\n    accessibleDiffViewerNext() { this._accessibleDiffViewer.get().next(); }\n    accessibleDiffViewerPrev() { this._accessibleDiffViewer.get().prev(); }\n    async waitForDiff() {\n        const diffModel = this._diffModel.get();\n        if (!diffModel) {\n            return;\n        }\n        await diffModel.waitForDiff();\n    }\n    mapToOtherSide() {\n        var _a, _b;\n        const isModifiedFocus = this._editors.modified.hasWidgetFocus();\n        const source = isModifiedFocus ? this._editors.modified : this._editors.original;\n        const destination = isModifiedFocus ? this._editors.original : this._editors.modified;\n        let destinationSelection;\n        const sourceSelection = source.getSelection();\n        if (sourceSelection) {\n            const mappings = (_b = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.diff.get()) === null || _b === void 0 ? void 0 : _b.mappings.map(m => isModifiedFocus ? m.lineRangeMapping.flip() : m.lineRangeMapping);\n            if (mappings) {\n                const newRange1 = translatePosition(sourceSelection.getStartPosition(), mappings);\n                const newRange2 = translatePosition(sourceSelection.getEndPosition(), mappings);\n                destinationSelection = Range.plusRange(newRange1, newRange2);\n            }\n        }\n        return { destination, destinationSelection };\n    }\n    switchSide() {\n        const { destination, destinationSelection } = this.mapToOtherSide();\n        destination.focus();\n        if (destinationSelection) {\n            destination.setSelection(destinationSelection);\n        }\n    }\n    exitCompareMove() {\n        const model = this._diffModel.get();\n        if (!model) {\n            return;\n        }\n        model.movedTextToCompare.set(undefined, undefined);\n    }\n    collapseAllUnchangedRegions() {\n        var _a;\n        const unchangedRegions = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.unchangedRegions.get();\n        if (!unchangedRegions) {\n            return;\n        }\n        transaction(tx => {\n            for (const region of unchangedRegions) {\n                region.collapseAll(tx);\n            }\n        });\n    }\n    showAllUnchangedRegions() {\n        var _a;\n        const unchangedRegions = (_a = this._diffModel.get()) === null || _a === void 0 ? void 0 : _a.unchangedRegions.get();\n        if (!unchangedRegions) {\n            return;\n        }\n        transaction(tx => {\n            for (const region of unchangedRegions) {\n                region.showAll(tx);\n            }\n        });\n    }\n};\nDiffEditorWidget = __decorate([\n    __param(3, IContextKeyService),\n    __param(4, IInstantiationService),\n    __param(5, ICodeEditorService),\n    __param(6, IAudioCueService),\n    __param(7, IEditorProgressService)\n], DiffEditorWidget);\nexport { DiffEditorWidget };\nfunction toLineChanges(state) {\n    return state.mappings.map(x => {\n        const m = x.lineRangeMapping;\n        let originalStartLineNumber;\n        let originalEndLineNumber;\n        let modifiedStartLineNumber;\n        let modifiedEndLineNumber;\n        let innerChanges = m.innerChanges;\n        if (m.original.isEmpty) {\n            // Insertion\n            originalStartLineNumber = m.original.startLineNumber - 1;\n            originalEndLineNumber = 0;\n            innerChanges = undefined;\n        }\n        else {\n            originalStartLineNumber = m.original.startLineNumber;\n            originalEndLineNumber = m.original.endLineNumberExclusive - 1;\n        }\n        if (m.modified.isEmpty) {\n            // Deletion\n            modifiedStartLineNumber = m.modified.startLineNumber - 1;\n            modifiedEndLineNumber = 0;\n            innerChanges = undefined;\n        }\n        else {\n            modifiedStartLineNumber = m.modified.startLineNumber;\n            modifiedEndLineNumber = m.modified.endLineNumberExclusive - 1;\n        }\n        return {\n            originalStartLineNumber,\n            originalEndLineNumber,\n            modifiedStartLineNumber,\n            modifiedEndLineNumber,\n            charChanges: innerChanges === null || innerChanges === void 0 ? void 0 : innerChanges.map(m => ({\n                originalStartLineNumber: m.originalRange.startLineNumber,\n                originalStartColumn: m.originalRange.startColumn,\n                originalEndLineNumber: m.originalRange.endLineNumber,\n                originalEndColumn: m.originalRange.endColumn,\n                modifiedStartLineNumber: m.modifiedRange.startLineNumber,\n                modifiedStartColumn: m.modifiedRange.startColumn,\n                modifiedEndLineNumber: m.modifiedRange.endLineNumber,\n                modifiedEndColumn: m.modifiedRange.endColumn,\n            }))\n        };\n    });\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}