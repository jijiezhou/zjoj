{"ast":null,"code":"import { isObject, isFunction, isString, isArray, isEmptyValue, isEmptyArray } from '../is.js';\nimport { getTemplate, mergeTemplate } from '../util.js';\nimport defaultValidateLocale from '../locale/en-US.js';\n\n/**\n * @param options.trim trim string value\n * @param options.ignoreEmptyString used form type\n * @param options.message\n * @param options.type\n */\nvar Base = function Base(obj, options) {\n  var this$1$1 = this;\n  this.getValidateMsg = function (keyPath, info) {\n    if (info === void 0) info = {};\n    var data = Object.assign(Object.assign({}, info), {\n      value: this$1$1.obj,\n      field: this$1$1.field,\n      type: this$1$1.type\n    });\n    var template = getTemplate(this$1$1.validateMessages, keyPath);\n    if (isFunction(template)) {\n      return template(data);\n    }\n    if (isString(template)) {\n      return template.replace(/\\#\\{.+?\\}/g, function (variable) {\n        var key = variable.slice(2, -1);\n        if (key in data) {\n          if (isObject(data[key]) || isArray(data[key])) {\n            try {\n              return JSON.stringify(data[key]);\n            } catch (_) {\n              return data[key];\n            }\n          }\n          return String(data[key]);\n        }\n        return variable;\n      });\n    }\n    return template;\n  };\n  if (isObject(options) && isString(obj) && options.trim) {\n    this.obj = obj.trim();\n  } else if (isObject(options) && options.ignoreEmptyString && obj === '') {\n    this.obj = undefined;\n  } else {\n    this.obj = obj;\n  }\n  this.message = options.message;\n  this.type = options.type;\n  this.error = null;\n  this.field = options.field || options.type;\n  this.validateMessages = mergeTemplate(defaultValidateLocale, options.validateMessages);\n};\nvar prototypeAccessors = {\n  not: {\n    configurable: true\n  },\n  isRequired: {\n    configurable: true\n  },\n  end: {\n    configurable: true\n  }\n};\nprototypeAccessors.not.get = function () {\n  this._not = !this._not;\n  return this;\n};\nprototypeAccessors.isRequired.get = function () {\n  if (isEmptyValue(this.obj) || isEmptyArray(this.obj)) {\n    var message = this.getValidateMsg('required');\n    this.error = {\n      value: this.obj,\n      type: this.type,\n      requiredError: true,\n      message: this.message || (isObject(message) ? message : \"\" + (this._not ? '[NOT MODE]:' : '') + message)\n    };\n  }\n  return this;\n};\nprototypeAccessors.end.get = function () {\n  return this.error;\n};\nBase.prototype.addError = function addError(message) {\n  if (!this.error && message) {\n    this.error = {\n      value: this.obj,\n      type: this.type,\n      message: this.message || (isObject(message) ? message : \"\" + (this._not ? '[NOT MODE]:' : '') + message)\n    };\n  }\n};\nBase.prototype.validate = function validate(expression, errorMessage) {\n  var _expression = this._not ? expression : !expression;\n  if (_expression) {\n    this.addError(errorMessage);\n  }\n  return this;\n};\nBase.prototype.collect = function collect(callback) {\n  callback && callback(this.error);\n};\nObject.defineProperties(Base.prototype, prototypeAccessors);\nexport { Base as default };","map":{"version":3,"names":["isObject","isFunction","isString","isArray","isEmptyValue","isEmptyArray","getTemplate","mergeTemplate","defaultValidateLocale","Base","obj","options","this$1$1","getValidateMsg","keyPath","info","data","Object","assign","value","field","type","template","validateMessages","replace","variable","key","slice","JSON","stringify","_","String","trim","ignoreEmptyString","undefined","message","error","prototypeAccessors","not","configurable","isRequired","end","get","_not","requiredError","prototype","addError","validate","expression","errorMessage","_expression","collect","callback","defineProperties","default"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/b-validate/es/rules/base.js"],"sourcesContent":["import { isObject, isFunction, isString, isArray, isEmptyValue, isEmptyArray } from '../is.js';\nimport { getTemplate, mergeTemplate } from '../util.js';\nimport defaultValidateLocale from '../locale/en-US.js';\n\n/**\n * @param options.trim trim string value\n * @param options.ignoreEmptyString used form type\n * @param options.message\n * @param options.type\n */\nvar Base = function Base(obj, options) {\n    var this$1$1 = this;\n\n    this.getValidateMsg = function (keyPath, info) {\n        if ( info === void 0 ) info = {};\n\n        var data = Object.assign(Object.assign({}, info), { value: this$1$1.obj, field: this$1$1.field, type: this$1$1.type });\n        var template = getTemplate(this$1$1.validateMessages, keyPath);\n        if (isFunction(template)) {\n            return template(data);\n        }\n        if (isString(template)) {\n            return template.replace(/\\#\\{.+?\\}/g, function (variable) {\n                var key = variable.slice(2, -1);\n                if (key in data) {\n                    if (isObject(data[key]) || isArray(data[key])) {\n                        try {\n                            return JSON.stringify(data[key]);\n                        }\n                        catch (_) {\n                            return data[key];\n                        }\n                    }\n                    return String(data[key]);\n                }\n                return variable;\n            });\n        }\n        return template;\n    };\n    if (isObject(options) && isString(obj) && options.trim) {\n        this.obj = obj.trim();\n    }\n    else if (isObject(options) && options.ignoreEmptyString && obj === '') {\n        this.obj = undefined;\n    }\n    else {\n        this.obj = obj;\n    }\n    this.message = options.message;\n    this.type = options.type;\n    this.error = null;\n    this.field = options.field || options.type;\n    this.validateMessages = mergeTemplate(defaultValidateLocale, options.validateMessages);\n};\n\nvar prototypeAccessors = { not: { configurable: true },isRequired: { configurable: true },end: { configurable: true } };\nprototypeAccessors.not.get = function () {\n    this._not = !this._not;\n    return this;\n};\nprototypeAccessors.isRequired.get = function () {\n    if (isEmptyValue(this.obj) || isEmptyArray(this.obj)) {\n        var message = this.getValidateMsg('required');\n        this.error = {\n            value: this.obj,\n            type: this.type,\n            requiredError: true,\n            message: this.message ||\n                (isObject(message) ? message : (\"\" + (this._not ? '[NOT MODE]:' : '') + message)),\n        };\n    }\n    return this;\n};\nprototypeAccessors.end.get = function () {\n    return this.error;\n};\nBase.prototype.addError = function addError (message) {\n    if (!this.error && message) {\n        this.error = {\n            value: this.obj,\n            type: this.type,\n            message: this.message ||\n                (isObject(message) ? message : (\"\" + (this._not ? '[NOT MODE]:' : '') + message)),\n        };\n    }\n};\nBase.prototype.validate = function validate (expression, errorMessage) {\n    var _expression = this._not ? expression : !expression;\n    if (_expression) {\n        this.addError(errorMessage);\n    }\n    return this;\n};\nBase.prototype.collect = function collect (callback) {\n    callback && callback(this.error);\n};\n\nObject.defineProperties( Base.prototype, prototypeAccessors );\n\nexport { Base as default };\n"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,UAAU,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,YAAY,EAAEC,YAAY,QAAQ,UAAU;AAC9F,SAASC,WAAW,EAAEC,aAAa,QAAQ,YAAY;AACvD,OAAOC,qBAAqB,MAAM,oBAAoB;;AAEtD;AACA;AACA;AACA;AACA;AACA;AACA,IAAIC,IAAI,GAAG,SAASA,IAAIA,CAACC,GAAG,EAAEC,OAAO,EAAE;EACnC,IAAIC,QAAQ,GAAG,IAAI;EAEnB,IAAI,CAACC,cAAc,GAAG,UAAUC,OAAO,EAAEC,IAAI,EAAE;IAC3C,IAAKA,IAAI,KAAK,KAAK,CAAC,EAAGA,IAAI,GAAG,CAAC,CAAC;IAEhC,IAAIC,IAAI,GAAGC,MAAM,CAACC,MAAM,CAACD,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAEH,IAAI,CAAC,EAAE;MAAEI,KAAK,EAAEP,QAAQ,CAACF,GAAG;MAAEU,KAAK,EAAER,QAAQ,CAACQ,KAAK;MAAEC,IAAI,EAAET,QAAQ,CAACS;IAAK,CAAC,CAAC;IACtH,IAAIC,QAAQ,GAAGhB,WAAW,CAACM,QAAQ,CAACW,gBAAgB,EAAET,OAAO,CAAC;IAC9D,IAAIb,UAAU,CAACqB,QAAQ,CAAC,EAAE;MACtB,OAAOA,QAAQ,CAACN,IAAI,CAAC;IACzB;IACA,IAAId,QAAQ,CAACoB,QAAQ,CAAC,EAAE;MACpB,OAAOA,QAAQ,CAACE,OAAO,CAAC,YAAY,EAAE,UAAUC,QAAQ,EAAE;QACtD,IAAIC,GAAG,GAAGD,QAAQ,CAACE,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAC/B,IAAID,GAAG,IAAIV,IAAI,EAAE;UACb,IAAIhB,QAAQ,CAACgB,IAAI,CAACU,GAAG,CAAC,CAAC,IAAIvB,OAAO,CAACa,IAAI,CAACU,GAAG,CAAC,CAAC,EAAE;YAC3C,IAAI;cACA,OAAOE,IAAI,CAACC,SAAS,CAACb,IAAI,CAACU,GAAG,CAAC,CAAC;YACpC,CAAC,CACD,OAAOI,CAAC,EAAE;cACN,OAAOd,IAAI,CAACU,GAAG,CAAC;YACpB;UACJ;UACA,OAAOK,MAAM,CAACf,IAAI,CAACU,GAAG,CAAC,CAAC;QAC5B;QACA,OAAOD,QAAQ;MACnB,CAAC,CAAC;IACN;IACA,OAAOH,QAAQ;EACnB,CAAC;EACD,IAAItB,QAAQ,CAACW,OAAO,CAAC,IAAIT,QAAQ,CAACQ,GAAG,CAAC,IAAIC,OAAO,CAACqB,IAAI,EAAE;IACpD,IAAI,CAACtB,GAAG,GAAGA,GAAG,CAACsB,IAAI,CAAC,CAAC;EACzB,CAAC,MACI,IAAIhC,QAAQ,CAACW,OAAO,CAAC,IAAIA,OAAO,CAACsB,iBAAiB,IAAIvB,GAAG,KAAK,EAAE,EAAE;IACnE,IAAI,CAACA,GAAG,GAAGwB,SAAS;EACxB,CAAC,MACI;IACD,IAAI,CAACxB,GAAG,GAAGA,GAAG;EAClB;EACA,IAAI,CAACyB,OAAO,GAAGxB,OAAO,CAACwB,OAAO;EAC9B,IAAI,CAACd,IAAI,GAAGV,OAAO,CAACU,IAAI;EACxB,IAAI,CAACe,KAAK,GAAG,IAAI;EACjB,IAAI,CAAChB,KAAK,GAAGT,OAAO,CAACS,KAAK,IAAIT,OAAO,CAACU,IAAI;EAC1C,IAAI,CAACE,gBAAgB,GAAGhB,aAAa,CAACC,qBAAqB,EAAEG,OAAO,CAACY,gBAAgB,CAAC;AAC1F,CAAC;AAED,IAAIc,kBAAkB,GAAG;EAAEC,GAAG,EAAE;IAAEC,YAAY,EAAE;EAAK,CAAC;EAACC,UAAU,EAAE;IAAED,YAAY,EAAE;EAAK,CAAC;EAACE,GAAG,EAAE;IAAEF,YAAY,EAAE;EAAK;AAAE,CAAC;AACvHF,kBAAkB,CAACC,GAAG,CAACI,GAAG,GAAG,YAAY;EACrC,IAAI,CAACC,IAAI,GAAG,CAAC,IAAI,CAACA,IAAI;EACtB,OAAO,IAAI;AACf,CAAC;AACDN,kBAAkB,CAACG,UAAU,CAACE,GAAG,GAAG,YAAY;EAC5C,IAAItC,YAAY,CAAC,IAAI,CAACM,GAAG,CAAC,IAAIL,YAAY,CAAC,IAAI,CAACK,GAAG,CAAC,EAAE;IAClD,IAAIyB,OAAO,GAAG,IAAI,CAACtB,cAAc,CAAC,UAAU,CAAC;IAC7C,IAAI,CAACuB,KAAK,GAAG;MACTjB,KAAK,EAAE,IAAI,CAACT,GAAG;MACfW,IAAI,EAAE,IAAI,CAACA,IAAI;MACfuB,aAAa,EAAE,IAAI;MACnBT,OAAO,EAAE,IAAI,CAACA,OAAO,KAChBnC,QAAQ,CAACmC,OAAO,CAAC,GAAGA,OAAO,GAAI,EAAE,IAAI,IAAI,CAACQ,IAAI,GAAG,aAAa,GAAG,EAAE,CAAC,GAAGR,OAAQ;IACxF,CAAC;EACL;EACA,OAAO,IAAI;AACf,CAAC;AACDE,kBAAkB,CAACI,GAAG,CAACC,GAAG,GAAG,YAAY;EACrC,OAAO,IAAI,CAACN,KAAK;AACrB,CAAC;AACD3B,IAAI,CAACoC,SAAS,CAACC,QAAQ,GAAG,SAASA,QAAQA,CAAEX,OAAO,EAAE;EAClD,IAAI,CAAC,IAAI,CAACC,KAAK,IAAID,OAAO,EAAE;IACxB,IAAI,CAACC,KAAK,GAAG;MACTjB,KAAK,EAAE,IAAI,CAACT,GAAG;MACfW,IAAI,EAAE,IAAI,CAACA,IAAI;MACfc,OAAO,EAAE,IAAI,CAACA,OAAO,KAChBnC,QAAQ,CAACmC,OAAO,CAAC,GAAGA,OAAO,GAAI,EAAE,IAAI,IAAI,CAACQ,IAAI,GAAG,aAAa,GAAG,EAAE,CAAC,GAAGR,OAAQ;IACxF,CAAC;EACL;AACJ,CAAC;AACD1B,IAAI,CAACoC,SAAS,CAACE,QAAQ,GAAG,SAASA,QAAQA,CAAEC,UAAU,EAAEC,YAAY,EAAE;EACnE,IAAIC,WAAW,GAAG,IAAI,CAACP,IAAI,GAAGK,UAAU,GAAG,CAACA,UAAU;EACtD,IAAIE,WAAW,EAAE;IACb,IAAI,CAACJ,QAAQ,CAACG,YAAY,CAAC;EAC/B;EACA,OAAO,IAAI;AACf,CAAC;AACDxC,IAAI,CAACoC,SAAS,CAACM,OAAO,GAAG,SAASA,OAAOA,CAAEC,QAAQ,EAAE;EACjDA,QAAQ,IAAIA,QAAQ,CAAC,IAAI,CAAChB,KAAK,CAAC;AACpC,CAAC;AAEDnB,MAAM,CAACoC,gBAAgB,CAAE5C,IAAI,CAACoC,SAAS,EAAER,kBAAmB,CAAC;AAE7D,SAAS5B,IAAI,IAAI6C,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}