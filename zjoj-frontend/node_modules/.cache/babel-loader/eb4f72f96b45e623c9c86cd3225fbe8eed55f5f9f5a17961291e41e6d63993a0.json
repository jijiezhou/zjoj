{"ast":null,"code":"import { computed, reactive } from \"vue\";\nconst useDrag = draggable => {\n  const dragType = computed(() => {\n    if (draggable.value) {\n      if (draggable.value.type === \"handle\") {\n        return \"handle\";\n      }\n      return \"row\";\n    }\n    return void 0;\n  });\n  const dragState = reactive({\n    dragging: false,\n    sourceKey: \"\",\n    sourcePath: [],\n    targetPath: [],\n    data: {}\n  });\n  const clearDragState = () => {\n    dragState.dragging = false;\n    dragState.sourceKey = \"\";\n    dragState.sourcePath = [];\n    dragState.targetPath = [];\n    dragState.data = {};\n  };\n  const handleDragStart = (ev, sourceKey, sourcePath, data) => {\n    if (ev.dataTransfer) {\n      ev.dataTransfer.effectAllowed = \"move\";\n      if (ev.target && ev.target.tagName === \"TD\") {\n        const {\n          parentElement\n        } = ev.target;\n        if (parentElement && parentElement.tagName === \"TR\") {\n          ev.dataTransfer.setDragImage(parentElement, 0, 0);\n        }\n      }\n    }\n    dragState.dragging = true;\n    dragState.sourceKey = sourceKey;\n    dragState.sourcePath = sourcePath;\n    dragState.targetPath = [...sourcePath];\n    dragState.data = data;\n  };\n  const handleDragEnter = (ev, targetPath) => {\n    if (ev.dataTransfer) {\n      ev.dataTransfer.dropEffect = \"move\";\n    }\n    if (dragState.targetPath.toString() !== targetPath.toString()) {\n      dragState.targetPath = targetPath;\n    }\n    ev.preventDefault();\n  };\n  const handleDragLeave = ev => {};\n  const handleDragover = ev => {\n    if (ev.dataTransfer) {\n      ev.dataTransfer.dropEffect = \"move\";\n    }\n    ev.preventDefault();\n  };\n  const handleDragEnd = ev => {\n    var _a;\n    if (((_a = ev.dataTransfer) == null ? void 0 : _a.dropEffect) === \"none\") {\n      clearDragState();\n    }\n  };\n  const handleDrop = ev => {\n    clearDragState();\n    ev.preventDefault();\n  };\n  return {\n    dragType,\n    dragState,\n    handleDragStart,\n    handleDragEnter,\n    handleDragLeave,\n    handleDragover,\n    handleDragEnd,\n    handleDrop\n  };\n};\nexport { useDrag };","map":{"version":3,"names":["computed","reactive","useDrag","draggable","dragType","value","type","dragState","dragging","sourceKey","sourcePath","targetPath","data","clearDragState","handleDragStart","ev","dataTransfer","effectAllowed","target","tagName","parentElement","setDragImage","handleDragEnter","dropEffect","toString","preventDefault","handleDragLeave","handleDragover","handleDragEnd","_a","handleDrop"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/@arco-design/web-vue/es/table/hooks/use-drag.js"],"sourcesContent":["import { computed, reactive } from \"vue\";\nconst useDrag = (draggable) => {\n  const dragType = computed(() => {\n    if (draggable.value) {\n      if (draggable.value.type === \"handle\") {\n        return \"handle\";\n      }\n      return \"row\";\n    }\n    return void 0;\n  });\n  const dragState = reactive({\n    dragging: false,\n    sourceKey: \"\",\n    sourcePath: [],\n    targetPath: [],\n    data: {}\n  });\n  const clearDragState = () => {\n    dragState.dragging = false;\n    dragState.sourceKey = \"\";\n    dragState.sourcePath = [];\n    dragState.targetPath = [];\n    dragState.data = {};\n  };\n  const handleDragStart = (ev, sourceKey, sourcePath, data) => {\n    if (ev.dataTransfer) {\n      ev.dataTransfer.effectAllowed = \"move\";\n      if (ev.target && ev.target.tagName === \"TD\") {\n        const { parentElement } = ev.target;\n        if (parentElement && parentElement.tagName === \"TR\") {\n          ev.dataTransfer.setDragImage(parentElement, 0, 0);\n        }\n      }\n    }\n    dragState.dragging = true;\n    dragState.sourceKey = sourceKey;\n    dragState.sourcePath = sourcePath;\n    dragState.targetPath = [...sourcePath];\n    dragState.data = data;\n  };\n  const handleDragEnter = (ev, targetPath) => {\n    if (ev.dataTransfer) {\n      ev.dataTransfer.dropEffect = \"move\";\n    }\n    if (dragState.targetPath.toString() !== targetPath.toString()) {\n      dragState.targetPath = targetPath;\n    }\n    ev.preventDefault();\n  };\n  const handleDragLeave = (ev) => {\n  };\n  const handleDragover = (ev) => {\n    if (ev.dataTransfer) {\n      ev.dataTransfer.dropEffect = \"move\";\n    }\n    ev.preventDefault();\n  };\n  const handleDragEnd = (ev) => {\n    var _a;\n    if (((_a = ev.dataTransfer) == null ? void 0 : _a.dropEffect) === \"none\") {\n      clearDragState();\n    }\n  };\n  const handleDrop = (ev) => {\n    clearDragState();\n    ev.preventDefault();\n  };\n  return {\n    dragType,\n    dragState,\n    handleDragStart,\n    handleDragEnter,\n    handleDragLeave,\n    handleDragover,\n    handleDragEnd,\n    handleDrop\n  };\n};\nexport { useDrag };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}