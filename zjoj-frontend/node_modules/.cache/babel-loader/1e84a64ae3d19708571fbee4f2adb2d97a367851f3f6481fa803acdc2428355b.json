{"ast":null,"code":"import { defineComponent, ref, computed, watch, createVNode, Fragment } from \"vue\";\nimport { getPrefixCls } from \"../_utils/global-config.js\";\nimport Input from \"../input/index.js\";\nimport { isExist, isFunction } from \"../_utils/is.js\";\nimport { Backspace, ArrowLeft, ArrowRight } from \"../_utils/keycode.js\";\nvar _VerificationCode = defineComponent({\n  name: \"VerificationCode\",\n  props: {\n    modelValue: String,\n    defaultValue: {\n      type: String,\n      default: \"\"\n    },\n    length: {\n      type: Number,\n      default: 6\n    },\n    size: {\n      type: String\n    },\n    disabled: Boolean,\n    masked: Boolean,\n    readonly: Boolean,\n    error: {\n      type: Boolean,\n      default: false\n    },\n    separator: {\n      type: Function\n    },\n    formatter: {\n      type: Function\n    }\n  },\n  emits: {\n    \"update:modelValue\": value => true,\n    \"change\": value => true,\n    \"finish\": value => true,\n    \"input\": (inputValue, index, ev) => true\n  },\n  setup(props, {\n    emit\n  }) {\n    const prefixCls = getPrefixCls(\"verification-code\");\n    const prefixInputCls = getPrefixCls(\"input\");\n    const inputRefList = ref([]);\n    const mergedValue = computed(() => {\n      var _a;\n      return (_a = props.modelValue) != null ? _a : props.defaultValue;\n    });\n    const type = computed(() => props.masked ? \"password\" : \"text\");\n    const inputCls = computed(() => [prefixInputCls, {\n      [`${prefixInputCls}-size-${props.size}`]: props.size\n    }]);\n    const filledValue = computed(() => {\n      const newVal = String(mergedValue.value).split(\"\");\n      return new Array(props.length).fill(\"\").map((_, index) => {\n        return isExist(newVal[index]) ? String(newVal[index]) : \"\";\n      });\n    });\n    const innerValue = ref(filledValue.value);\n    watch(mergedValue, () => {\n      innerValue.value = filledValue.value;\n    });\n    const updateValue = () => {\n      const value = innerValue.value.join(\"\").trim();\n      emit(\"update:modelValue\", value);\n      emit(\"change\", value);\n      if (value.length === props.length) {\n        emit(\"finish\", value);\n      }\n    };\n    const handleFocus = index => inputRefList == null ? void 0 : inputRefList.value[index].focus();\n    const focusFirstEmptyInput = index => {\n      if (isExist(index) && innerValue.value[index]) {\n        return;\n      }\n      for (let i = 0; i < innerValue.value.length; i++) {\n        if (!innerValue.value[i]) {\n          handleFocus(i);\n          break;\n        }\n      }\n    };\n    const handlePaste = (e, index) => {\n      e.preventDefault();\n      const {\n        clipboardData\n      } = e;\n      const text = clipboardData == null ? void 0 : clipboardData.getData(\"text\");\n      if (text) {\n        const pasteValues = text.split(\"\").slice(0, props.length - index);\n        innerValue.value.splice(index, pasteValues.length, ...pasteValues);\n        updateValue();\n      }\n    };\n    const handleKeydown = (index, e) => {\n      const keyCode = e.code || e.key;\n      if (keyCode === Backspace.code && !innerValue.value[index]) {\n        e.preventDefault();\n        innerValue.value[Math.max(index - 1, 0)] = \"\";\n        updateValue();\n        focusFirstEmptyInput();\n      } else if (keyCode === ArrowLeft.code && index > 0) {\n        e.preventDefault();\n        handleFocus(index - 1);\n      } else if (keyCode === ArrowRight.code && innerValue.value[index] && index < props.length - 1) {\n        e.preventDefault();\n        handleFocus(index + 1);\n      }\n    };\n    const handleInput = (index, value, event) => {\n      let char = (value || \"\").trim().charAt(value.length - 1);\n      emit(\"input\", char, index, event);\n      if (isFunction(props.formatter)) {\n        const result = props.formatter(char, index, innerValue.value.join(\"\"));\n        if (result === false) return;\n        char = result;\n      }\n      innerValue.value[index] = char;\n      updateValue();\n      focusFirstEmptyInput();\n    };\n    return () => {\n      return createVNode(\"div\", {\n        \"class\": prefixCls\n      }, [innerValue.value.map((c, i) => {\n        var _a;\n        return createVNode(Fragment, null, [createVNode(Input, {\n          \"key\": i,\n          \"ref\": el => inputRefList.value[i] = el,\n          \"type\": type.value,\n          \"class\": inputCls.value,\n          \"modelValue\": c,\n          \"size\": props.size,\n          \"error\": props.error,\n          \"disabled\": props.disabled,\n          \"readonly\": props.readonly,\n          \"onFocus\": () => focusFirstEmptyInput(i),\n          \"onInput\": (v, e) => handleInput(i, v, e),\n          \"onKeydown\": e => handleKeydown(i, e),\n          \"onPaste\": e => handlePaste(e, i)\n        }, null), (_a = props.separator) == null ? void 0 : _a.call(props, i, c)]);\n      })]);\n    };\n  }\n});\nexport { _VerificationCode as default };","map":{"version":3,"names":["defineComponent","ref","computed","watch","createVNode","Fragment","getPrefixCls","Input","isExist","isFunction","Backspace","ArrowLeft","ArrowRight","_VerificationCode","name","props","modelValue","String","defaultValue","type","default","length","Number","size","disabled","Boolean","masked","readonly","error","separator","Function","formatter","emits","value","input","inputValue","index","ev","setup","emit","prefixCls","prefixInputCls","inputRefList","mergedValue","_a","inputCls","filledValue","newVal","split","Array","fill","map","_","innerValue","updateValue","join","trim","handleFocus","focus","focusFirstEmptyInput","i","handlePaste","e","preventDefault","clipboardData","text","getData","pasteValues","slice","splice","handleKeydown","keyCode","code","key","Math","max","handleInput","event","char","charAt","result","c","el","onFocus","onInput","v","call"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/@arco-design/web-vue/es/verification-code/verification-code.js"],"sourcesContent":["import { defineComponent, ref, computed, watch, createVNode, Fragment } from \"vue\";\nimport { getPrefixCls } from \"../_utils/global-config.js\";\nimport Input from \"../input/index.js\";\nimport { isExist, isFunction } from \"../_utils/is.js\";\nimport { Backspace, ArrowLeft, ArrowRight } from \"../_utils/keycode.js\";\nvar _VerificationCode = defineComponent({\n  name: \"VerificationCode\",\n  props: {\n    modelValue: String,\n    defaultValue: {\n      type: String,\n      default: \"\"\n    },\n    length: {\n      type: Number,\n      default: 6\n    },\n    size: {\n      type: String\n    },\n    disabled: Boolean,\n    masked: Boolean,\n    readonly: Boolean,\n    error: {\n      type: Boolean,\n      default: false\n    },\n    separator: {\n      type: Function\n    },\n    formatter: {\n      type: Function\n    }\n  },\n  emits: {\n    \"update:modelValue\": (value) => true,\n    \"change\": (value) => true,\n    \"finish\": (value) => true,\n    \"input\": (inputValue, index, ev) => true\n  },\n  setup(props, {\n    emit\n  }) {\n    const prefixCls = getPrefixCls(\"verification-code\");\n    const prefixInputCls = getPrefixCls(\"input\");\n    const inputRefList = ref([]);\n    const mergedValue = computed(() => {\n      var _a;\n      return (_a = props.modelValue) != null ? _a : props.defaultValue;\n    });\n    const type = computed(() => props.masked ? \"password\" : \"text\");\n    const inputCls = computed(() => [prefixInputCls, {\n      [`${prefixInputCls}-size-${props.size}`]: props.size\n    }]);\n    const filledValue = computed(() => {\n      const newVal = String(mergedValue.value).split(\"\");\n      return new Array(props.length).fill(\"\").map((_, index) => {\n        return isExist(newVal[index]) ? String(newVal[index]) : \"\";\n      });\n    });\n    const innerValue = ref(filledValue.value);\n    watch(mergedValue, () => {\n      innerValue.value = filledValue.value;\n    });\n    const updateValue = () => {\n      const value = innerValue.value.join(\"\").trim();\n      emit(\"update:modelValue\", value);\n      emit(\"change\", value);\n      if (value.length === props.length) {\n        emit(\"finish\", value);\n      }\n    };\n    const handleFocus = (index) => inputRefList == null ? void 0 : inputRefList.value[index].focus();\n    const focusFirstEmptyInput = (index) => {\n      if (isExist(index) && innerValue.value[index]) {\n        return;\n      }\n      for (let i = 0; i < innerValue.value.length; i++) {\n        if (!innerValue.value[i]) {\n          handleFocus(i);\n          break;\n        }\n      }\n    };\n    const handlePaste = (e, index) => {\n      e.preventDefault();\n      const {\n        clipboardData\n      } = e;\n      const text = clipboardData == null ? void 0 : clipboardData.getData(\"text\");\n      if (text) {\n        const pasteValues = text.split(\"\").slice(0, props.length - index);\n        innerValue.value.splice(index, pasteValues.length, ...pasteValues);\n        updateValue();\n      }\n    };\n    const handleKeydown = (index, e) => {\n      const keyCode = e.code || e.key;\n      if (keyCode === Backspace.code && !innerValue.value[index]) {\n        e.preventDefault();\n        innerValue.value[Math.max(index - 1, 0)] = \"\";\n        updateValue();\n        focusFirstEmptyInput();\n      } else if (keyCode === ArrowLeft.code && index > 0) {\n        e.preventDefault();\n        handleFocus(index - 1);\n      } else if (keyCode === ArrowRight.code && innerValue.value[index] && index < props.length - 1) {\n        e.preventDefault();\n        handleFocus(index + 1);\n      }\n    };\n    const handleInput = (index, value, event) => {\n      let char = (value || \"\").trim().charAt(value.length - 1);\n      emit(\"input\", char, index, event);\n      if (isFunction(props.formatter)) {\n        const result = props.formatter(char, index, innerValue.value.join(\"\"));\n        if (result === false)\n          return;\n        char = result;\n      }\n      innerValue.value[index] = char;\n      updateValue();\n      focusFirstEmptyInput();\n    };\n    return () => {\n      return createVNode(\"div\", {\n        \"class\": prefixCls\n      }, [innerValue.value.map((c, i) => {\n        var _a;\n        return createVNode(Fragment, null, [createVNode(Input, {\n          \"key\": i,\n          \"ref\": (el) => inputRefList.value[i] = el,\n          \"type\": type.value,\n          \"class\": inputCls.value,\n          \"modelValue\": c,\n          \"size\": props.size,\n          \"error\": props.error,\n          \"disabled\": props.disabled,\n          \"readonly\": props.readonly,\n          \"onFocus\": () => focusFirstEmptyInput(i),\n          \"onInput\": (v, e) => handleInput(i, v, e),\n          \"onKeydown\": (e) => handleKeydown(i, e),\n          \"onPaste\": (e) => handlePaste(e, i)\n        }, null), (_a = props.separator) == null ? void 0 : _a.call(props, i, c)]);\n      })]);\n    };\n  }\n});\nexport { _VerificationCode as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}