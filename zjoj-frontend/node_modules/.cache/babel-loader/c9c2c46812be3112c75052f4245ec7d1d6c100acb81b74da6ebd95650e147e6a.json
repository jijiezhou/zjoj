{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nexport class OvertypingCapturer {\n  constructor(editor, suggestModel) {\n    this._disposables = new DisposableStore();\n    this._lastOvertyped = [];\n    this._locked = false;\n    this._disposables.add(editor.onWillType(() => {\n      if (this._locked || !editor.hasModel()) {\n        return;\n      }\n      const selections = editor.getSelections();\n      const selectionsLength = selections.length;\n      // Check if it will overtype any selections\n      let willOvertype = false;\n      for (let i = 0; i < selectionsLength; i++) {\n        if (!selections[i].isEmpty()) {\n          willOvertype = true;\n          break;\n        }\n      }\n      if (!willOvertype) {\n        if (this._lastOvertyped.length !== 0) {\n          this._lastOvertyped.length = 0;\n        }\n        return;\n      }\n      this._lastOvertyped = [];\n      const model = editor.getModel();\n      for (let i = 0; i < selectionsLength; i++) {\n        const selection = selections[i];\n        // Check for overtyping capturer restrictions\n        if (model.getValueLengthInRange(selection) > OvertypingCapturer._maxSelectionLength) {\n          return;\n        }\n        this._lastOvertyped[i] = {\n          value: model.getValueInRange(selection),\n          multiline: selection.startLineNumber !== selection.endLineNumber\n        };\n      }\n    }));\n    this._disposables.add(suggestModel.onDidTrigger(e => {\n      this._locked = true;\n    }));\n    this._disposables.add(suggestModel.onDidCancel(e => {\n      this._locked = false;\n    }));\n  }\n  getLastOvertypedInfo(idx) {\n    if (idx >= 0 && idx < this._lastOvertyped.length) {\n      return this._lastOvertyped[idx];\n    }\n    return undefined;\n  }\n  dispose() {\n    this._disposables.dispose();\n  }\n}\nOvertypingCapturer._maxSelectionLength = 51200;","map":{"version":3,"names":["DisposableStore","OvertypingCapturer","constructor","editor","suggestModel","_disposables","_lastOvertyped","_locked","add","onWillType","hasModel","selections","getSelections","selectionsLength","length","willOvertype","i","isEmpty","model","getModel","selection","getValueLengthInRange","_maxSelectionLength","value","getValueInRange","multiline","startLineNumber","endLineNumber","onDidTrigger","e","onDidCancel","getLastOvertypedInfo","idx","undefined","dispose"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/browser/suggestOvertypingCapturer.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nexport class OvertypingCapturer {\n    constructor(editor, suggestModel) {\n        this._disposables = new DisposableStore();\n        this._lastOvertyped = [];\n        this._locked = false;\n        this._disposables.add(editor.onWillType(() => {\n            if (this._locked || !editor.hasModel()) {\n                return;\n            }\n            const selections = editor.getSelections();\n            const selectionsLength = selections.length;\n            // Check if it will overtype any selections\n            let willOvertype = false;\n            for (let i = 0; i < selectionsLength; i++) {\n                if (!selections[i].isEmpty()) {\n                    willOvertype = true;\n                    break;\n                }\n            }\n            if (!willOvertype) {\n                if (this._lastOvertyped.length !== 0) {\n                    this._lastOvertyped.length = 0;\n                }\n                return;\n            }\n            this._lastOvertyped = [];\n            const model = editor.getModel();\n            for (let i = 0; i < selectionsLength; i++) {\n                const selection = selections[i];\n                // Check for overtyping capturer restrictions\n                if (model.getValueLengthInRange(selection) > OvertypingCapturer._maxSelectionLength) {\n                    return;\n                }\n                this._lastOvertyped[i] = { value: model.getValueInRange(selection), multiline: selection.startLineNumber !== selection.endLineNumber };\n            }\n        }));\n        this._disposables.add(suggestModel.onDidTrigger(e => {\n            this._locked = true;\n        }));\n        this._disposables.add(suggestModel.onDidCancel(e => {\n            this._locked = false;\n        }));\n    }\n    getLastOvertypedInfo(idx) {\n        if (idx >= 0 && idx < this._lastOvertyped.length) {\n            return this._lastOvertyped[idx];\n        }\n        return undefined;\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\nOvertypingCapturer._maxSelectionLength = 51200;\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAASA,eAAe,QAAQ,sCAAsC;AACtE,OAAO,MAAMC,kBAAkB,CAAC;EAC5BC,WAAWA,CAACC,MAAM,EAAEC,YAAY,EAAE;IAC9B,IAAI,CAACC,YAAY,GAAG,IAAIL,eAAe,CAAC,CAAC;IACzC,IAAI,CAACM,cAAc,GAAG,EAAE;IACxB,IAAI,CAACC,OAAO,GAAG,KAAK;IACpB,IAAI,CAACF,YAAY,CAACG,GAAG,CAACL,MAAM,CAACM,UAAU,CAAC,MAAM;MAC1C,IAAI,IAAI,CAACF,OAAO,IAAI,CAACJ,MAAM,CAACO,QAAQ,CAAC,CAAC,EAAE;QACpC;MACJ;MACA,MAAMC,UAAU,GAAGR,MAAM,CAACS,aAAa,CAAC,CAAC;MACzC,MAAMC,gBAAgB,GAAGF,UAAU,CAACG,MAAM;MAC1C;MACA,IAAIC,YAAY,GAAG,KAAK;MACxB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,gBAAgB,EAAEG,CAAC,EAAE,EAAE;QACvC,IAAI,CAACL,UAAU,CAACK,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,EAAE;UAC1BF,YAAY,GAAG,IAAI;UACnB;QACJ;MACJ;MACA,IAAI,CAACA,YAAY,EAAE;QACf,IAAI,IAAI,CAACT,cAAc,CAACQ,MAAM,KAAK,CAAC,EAAE;UAClC,IAAI,CAACR,cAAc,CAACQ,MAAM,GAAG,CAAC;QAClC;QACA;MACJ;MACA,IAAI,CAACR,cAAc,GAAG,EAAE;MACxB,MAAMY,KAAK,GAAGf,MAAM,CAACgB,QAAQ,CAAC,CAAC;MAC/B,KAAK,IAAIH,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,gBAAgB,EAAEG,CAAC,EAAE,EAAE;QACvC,MAAMI,SAAS,GAAGT,UAAU,CAACK,CAAC,CAAC;QAC/B;QACA,IAAIE,KAAK,CAACG,qBAAqB,CAACD,SAAS,CAAC,GAAGnB,kBAAkB,CAACqB,mBAAmB,EAAE;UACjF;QACJ;QACA,IAAI,CAAChB,cAAc,CAACU,CAAC,CAAC,GAAG;UAAEO,KAAK,EAAEL,KAAK,CAACM,eAAe,CAACJ,SAAS,CAAC;UAAEK,SAAS,EAAEL,SAAS,CAACM,eAAe,KAAKN,SAAS,CAACO;QAAc,CAAC;MAC1I;IACJ,CAAC,CAAC,CAAC;IACH,IAAI,CAACtB,YAAY,CAACG,GAAG,CAACJ,YAAY,CAACwB,YAAY,CAACC,CAAC,IAAI;MACjD,IAAI,CAACtB,OAAO,GAAG,IAAI;IACvB,CAAC,CAAC,CAAC;IACH,IAAI,CAACF,YAAY,CAACG,GAAG,CAACJ,YAAY,CAAC0B,WAAW,CAACD,CAAC,IAAI;MAChD,IAAI,CAACtB,OAAO,GAAG,KAAK;IACxB,CAAC,CAAC,CAAC;EACP;EACAwB,oBAAoBA,CAACC,GAAG,EAAE;IACtB,IAAIA,GAAG,IAAI,CAAC,IAAIA,GAAG,GAAG,IAAI,CAAC1B,cAAc,CAACQ,MAAM,EAAE;MAC9C,OAAO,IAAI,CAACR,cAAc,CAAC0B,GAAG,CAAC;IACnC;IACA,OAAOC,SAAS;EACpB;EACAC,OAAOA,CAAA,EAAG;IACN,IAAI,CAAC7B,YAAY,CAAC6B,OAAO,CAAC,CAAC;EAC/B;AACJ;AACAjC,kBAAkB,CAACqB,mBAAmB,GAAG,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}