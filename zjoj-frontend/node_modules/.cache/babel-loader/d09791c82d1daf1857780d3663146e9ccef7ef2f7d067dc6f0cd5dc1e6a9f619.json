{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { toRefs, ref, watch, onMounted, computed } from \"vue\";\nimport { isUndefined } from \"../../_utils/is.js\";\nfunction getPath(data, key) {\n  const path = [];\n  const loop = list => {\n    for (let i = 0; i < list.length; i++) {\n      const item = list[i];\n      if (item.key === key) {\n        return true;\n      }\n      if (item.children) {\n        path.push(item.key);\n        const matched = loop(item.children);\n        if (matched) {\n          return true;\n        }\n        path.pop();\n      }\n    }\n    return false;\n  };\n  loop(data);\n  return path;\n}\nfunction isSameKeys(keys1, keys2) {\n  if (keys1.length !== keys2.length) return false;\n  return keys1.toString() === keys2.toString();\n}\nfunction useMenuOpenState(props) {\n  const {\n    modelValue,\n    defaultValue,\n    autoOpen,\n    autoOpenSelected,\n    subMenuKeys,\n    selectedKeys,\n    menuData,\n    accordion\n  } = toRefs(props);\n  const localValue = ref(!isUndefined(modelValue.value) ? modelValue.value : !isUndefined(defaultValue.value) ? defaultValue.value : []);\n  const setLocalValue = val => {\n    localValue.value = val;\n  };\n  watch(modelValue, () => {\n    if (isUndefined(modelValue.value)) {\n      setLocalValue([]);\n    }\n  });\n  let mountedSubMenuKeys = [];\n  onMounted(() => {\n    mountedSubMenuKeys = [...subMenuKeys.value];\n    let newOpenKeys = [];\n    if (autoOpen.value) {\n      newOpenKeys = accordion.value ? subMenuKeys.value.slice(0, 1) : [...subMenuKeys.value];\n    }\n    if (autoOpenSelected.value) {\n      const pathList = selectedKeys.value.map(key => getPath(menuData.value, key));\n      if (pathList.length && (!autoOpen.value || accordion.value)) {\n        newOpenKeys = accordion.value ? pathList[0] : [...new Set([].concat(...pathList))];\n      }\n    }\n    if (newOpenKeys.length) {\n      setLocalValue(newOpenKeys);\n    }\n  });\n  let hasTriggered = false;\n  watch(subMenuKeys, (currentKeys, prevKeys = []) => {\n    if (hasTriggered || !isSameKeys(currentKeys, mountedSubMenuKeys)) {\n      const newOpenKeys = openKeys.value.filter(key => currentKeys.includes(key));\n      if (autoOpen.value) {\n        const keysAdded = currentKeys.filter(key => !prevKeys.includes(key));\n        newOpenKeys.push(...keysAdded);\n      }\n      setLocalValue(accordion.value ? newOpenKeys.slice(0, 1) : newOpenKeys);\n    }\n    hasTriggered = true;\n  });\n  const openKeys = computed(() => modelValue.value || localValue.value);\n  return {\n    openKeys,\n    localOpenKeys: localValue,\n    setOpenKeys: setLocalValue,\n    open(key, level) {\n      let newOpenKeys = [];\n      if (openKeys.value.indexOf(key) > -1) {\n        if (accordion.value && level === 1) {\n          newOpenKeys = [];\n        } else {\n          newOpenKeys = openKeys.value.filter(i => i !== key);\n        }\n      } else if (accordion.value && level === 1) {\n        newOpenKeys = [key];\n      } else {\n        newOpenKeys = openKeys.value.concat([key]);\n      }\n      setLocalValue(newOpenKeys);\n      return newOpenKeys;\n    }\n  };\n}\nexport { useMenuOpenState as default };","map":{"version":3,"names":["toRefs","ref","watch","onMounted","computed","isUndefined","getPath","data","key","path","loop","list","i","length","item","children","push","matched","pop","isSameKeys","keys1","keys2","toString","useMenuOpenState","props","modelValue","defaultValue","autoOpen","autoOpenSelected","subMenuKeys","selectedKeys","menuData","accordion","localValue","value","setLocalValue","val","mountedSubMenuKeys","newOpenKeys","slice","pathList","map","Set","concat","hasTriggered","currentKeys","prevKeys","openKeys","filter","includes","keysAdded","localOpenKeys","setOpenKeys","open","level","indexOf","default"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/@arco-design/web-vue/es/menu/hooks/use-menu-open-state.js"],"sourcesContent":["import { toRefs, ref, watch, onMounted, computed } from \"vue\";\nimport { isUndefined } from \"../../_utils/is.js\";\nfunction getPath(data, key) {\n  const path = [];\n  const loop = (list) => {\n    for (let i = 0; i < list.length; i++) {\n      const item = list[i];\n      if (item.key === key) {\n        return true;\n      }\n      if (item.children) {\n        path.push(item.key);\n        const matched = loop(item.children);\n        if (matched) {\n          return true;\n        }\n        path.pop();\n      }\n    }\n    return false;\n  };\n  loop(data);\n  return path;\n}\nfunction isSameKeys(keys1, keys2) {\n  if (keys1.length !== keys2.length)\n    return false;\n  return keys1.toString() === keys2.toString();\n}\nfunction useMenuOpenState(props) {\n  const {\n    modelValue,\n    defaultValue,\n    autoOpen,\n    autoOpenSelected,\n    subMenuKeys,\n    selectedKeys,\n    menuData,\n    accordion\n  } = toRefs(props);\n  const localValue = ref(!isUndefined(modelValue.value) ? modelValue.value : !isUndefined(defaultValue.value) ? defaultValue.value : []);\n  const setLocalValue = (val) => {\n    localValue.value = val;\n  };\n  watch(modelValue, () => {\n    if (isUndefined(modelValue.value)) {\n      setLocalValue([]);\n    }\n  });\n  let mountedSubMenuKeys = [];\n  onMounted(() => {\n    mountedSubMenuKeys = [...subMenuKeys.value];\n    let newOpenKeys = [];\n    if (autoOpen.value) {\n      newOpenKeys = accordion.value ? subMenuKeys.value.slice(0, 1) : [...subMenuKeys.value];\n    }\n    if (autoOpenSelected.value) {\n      const pathList = selectedKeys.value.map((key) => getPath(menuData.value, key));\n      if (pathList.length && (!autoOpen.value || accordion.value)) {\n        newOpenKeys = accordion.value ? pathList[0] : [...new Set([].concat(...pathList))];\n      }\n    }\n    if (newOpenKeys.length) {\n      setLocalValue(newOpenKeys);\n    }\n  });\n  let hasTriggered = false;\n  watch(subMenuKeys, (currentKeys, prevKeys = []) => {\n    if (hasTriggered || !isSameKeys(currentKeys, mountedSubMenuKeys)) {\n      const newOpenKeys = openKeys.value.filter((key) => currentKeys.includes(key));\n      if (autoOpen.value) {\n        const keysAdded = currentKeys.filter((key) => !prevKeys.includes(key));\n        newOpenKeys.push(...keysAdded);\n      }\n      setLocalValue(accordion.value ? newOpenKeys.slice(0, 1) : newOpenKeys);\n    }\n    hasTriggered = true;\n  });\n  const openKeys = computed(() => modelValue.value || localValue.value);\n  return {\n    openKeys,\n    localOpenKeys: localValue,\n    setOpenKeys: setLocalValue,\n    open(key, level) {\n      let newOpenKeys = [];\n      if (openKeys.value.indexOf(key) > -1) {\n        if (accordion.value && level === 1) {\n          newOpenKeys = [];\n        } else {\n          newOpenKeys = openKeys.value.filter((i) => i !== key);\n        }\n      } else if (accordion.value && level === 1) {\n        newOpenKeys = [key];\n      } else {\n        newOpenKeys = openKeys.value.concat([key]);\n      }\n      setLocalValue(newOpenKeys);\n      return newOpenKeys;\n    }\n  };\n}\nexport { useMenuOpenState as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}