{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { h } from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action } from '../../../../base/common/actions.js';\nimport { booleanComparator, compareBy, numberComparator, tieBreakComparators } from '../../../../base/common/arrays.js';\nimport { findMaxIdxBy } from '../../../../base/common/arraysFind.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunHandleChanges, autorunWithStore, constObservable, derived, derivedWithStore, observableFromEvent, observableSignalFromEvent, observableValue, recomputeInitiallyAndOnChange } from '../../../../base/common/observable.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { PlaceholderViewZone, ViewZoneOverlayWidget, applyStyle, applyViewZones } from './utils.js';\nimport { OffsetRange, OffsetRangeSet } from '../../../common/core/offsetRange.js';\nimport { localize } from '../../../../nls.js';\nexport class MovedBlocksLinesPart extends Disposable {\n  constructor(_rootElement, _diffModel, _originalEditorLayoutInfo, _modifiedEditorLayoutInfo, _editors) {\n    super();\n    this._rootElement = _rootElement;\n    this._diffModel = _diffModel;\n    this._originalEditorLayoutInfo = _originalEditorLayoutInfo;\n    this._modifiedEditorLayoutInfo = _modifiedEditorLayoutInfo;\n    this._editors = _editors;\n    this._originalScrollTop = observableFromEvent(this._editors.original.onDidScrollChange, () => this._editors.original.getScrollTop());\n    this._modifiedScrollTop = observableFromEvent(this._editors.modified.onDidScrollChange, () => this._editors.modified.getScrollTop());\n    this._viewZonesChanged = observableSignalFromEvent('onDidChangeViewZones', this._editors.modified.onDidChangeViewZones);\n    this.width = observableValue(this, 0);\n    this._modifiedViewZonesChangedSignal = observableSignalFromEvent('modified.onDidChangeViewZones', this._editors.modified.onDidChangeViewZones);\n    this._originalViewZonesChangedSignal = observableSignalFromEvent('original.onDidChangeViewZones', this._editors.original.onDidChangeViewZones);\n    this._state = derivedWithStore(this, (reader, store) => {\n      /** @description state */\n      var _a;\n      this._element.replaceChildren();\n      const model = this._diffModel.read(reader);\n      const moves = (_a = model === null || model === void 0 ? void 0 : model.diff.read(reader)) === null || _a === void 0 ? void 0 : _a.movedTexts;\n      if (!moves || moves.length === 0) {\n        this.width.set(0, undefined);\n        return;\n      }\n      this._viewZonesChanged.read(reader);\n      const infoOrig = this._originalEditorLayoutInfo.read(reader);\n      const infoMod = this._modifiedEditorLayoutInfo.read(reader);\n      if (!infoOrig || !infoMod) {\n        this.width.set(0, undefined);\n        return;\n      }\n      this._modifiedViewZonesChangedSignal.read(reader);\n      this._originalViewZonesChangedSignal.read(reader);\n      const lines = moves.map(move => {\n        function computeLineStart(range, editor) {\n          const t1 = editor.getTopForLineNumber(range.startLineNumber, true);\n          const t2 = editor.getTopForLineNumber(range.endLineNumberExclusive, true);\n          return (t1 + t2) / 2;\n        }\n        const start = computeLineStart(move.lineRangeMapping.original, this._editors.original);\n        const startOffset = this._originalScrollTop.read(reader);\n        const end = computeLineStart(move.lineRangeMapping.modified, this._editors.modified);\n        const endOffset = this._modifiedScrollTop.read(reader);\n        const from = start - startOffset;\n        const to = end - endOffset;\n        const top = Math.min(start, end);\n        const bottom = Math.max(start, end);\n        return {\n          range: new OffsetRange(top, bottom),\n          from,\n          to,\n          fromWithoutScroll: start,\n          toWithoutScroll: end,\n          move\n        };\n      });\n      lines.sort(tieBreakComparators(compareBy(l => l.fromWithoutScroll > l.toWithoutScroll, booleanComparator), compareBy(l => l.fromWithoutScroll > l.toWithoutScroll ? l.fromWithoutScroll : -l.toWithoutScroll, numberComparator)));\n      const layout = LinesLayout.compute(lines.map(l => l.range));\n      const padding = 10;\n      const lineAreaLeft = infoOrig.verticalScrollbarWidth;\n      const lineAreaWidth = (layout.getTrackCount() - 1) * 10 + padding * 2;\n      const width = lineAreaLeft + lineAreaWidth + (infoMod.contentLeft - MovedBlocksLinesPart.movedCodeBlockPadding);\n      let idx = 0;\n      for (const line of lines) {\n        const track = layout.getTrack(idx);\n        const verticalY = lineAreaLeft + padding + track * 10;\n        const arrowHeight = 15;\n        const arrowWidth = 15;\n        const right = width;\n        const rectWidth = infoMod.glyphMarginWidth + infoMod.lineNumbersWidth;\n        const rectHeight = 18;\n        const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n        rect.classList.add('arrow-rectangle');\n        rect.setAttribute('x', `${right - rectWidth}`);\n        rect.setAttribute('y', `${line.to - rectHeight / 2}`);\n        rect.setAttribute('width', `${rectWidth}`);\n        rect.setAttribute('height', `${rectHeight}`);\n        this._element.appendChild(rect);\n        const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n        const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n        path.setAttribute('d', `M ${0} ${line.from} L ${verticalY} ${line.from} L ${verticalY} ${line.to} L ${right - arrowWidth} ${line.to}`);\n        path.setAttribute('fill', 'none');\n        g.appendChild(path);\n        const arrowRight = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');\n        arrowRight.classList.add('arrow');\n        store.add(autorun(reader => {\n          path.classList.toggle('currentMove', line.move === model.activeMovedText.read(reader));\n          arrowRight.classList.toggle('currentMove', line.move === model.activeMovedText.read(reader));\n        }));\n        arrowRight.setAttribute('points', `${right - arrowWidth},${line.to - arrowHeight / 2} ${right},${line.to} ${right - arrowWidth},${line.to + arrowHeight / 2}`);\n        g.appendChild(arrowRight);\n        this._element.appendChild(g);\n        /*\n        TODO@hediet\n        path.addEventListener('mouseenter', () => {\n            model.setHoveredMovedText(line.move);\n        });\n        path.addEventListener('mouseleave', () => {\n            model.setHoveredMovedText(undefined);\n        });*/\n        idx++;\n      }\n      this.width.set(lineAreaWidth, undefined);\n    });\n    this._element = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    this._element.setAttribute('class', 'moved-blocks-lines');\n    this._rootElement.appendChild(this._element);\n    this._register(toDisposable(() => this._element.remove()));\n    this._register(autorun(reader => {\n      /** @description update moved blocks lines positioning */\n      const info = this._originalEditorLayoutInfo.read(reader);\n      const info2 = this._modifiedEditorLayoutInfo.read(reader);\n      if (!info || !info2) {\n        return;\n      }\n      this._element.style.left = `${info.width - info.verticalScrollbarWidth}px`;\n      this._element.style.height = `${info.height}px`;\n      this._element.style.width = `${info.verticalScrollbarWidth + info.contentLeft - MovedBlocksLinesPart.movedCodeBlockPadding + this.width.read(reader)}px`;\n    }));\n    this._register(recomputeInitiallyAndOnChange(this._state));\n    const movedBlockViewZones = derived(reader => {\n      const model = this._diffModel.read(reader);\n      const d = model === null || model === void 0 ? void 0 : model.diff.read(reader);\n      if (!d) {\n        return [];\n      }\n      return d.movedTexts.map(move => ({\n        move,\n        original: new PlaceholderViewZone(constObservable(move.lineRangeMapping.original.startLineNumber - 1), 18),\n        modified: new PlaceholderViewZone(constObservable(move.lineRangeMapping.modified.startLineNumber - 1), 18)\n      }));\n    });\n    this._register(applyViewZones(this._editors.original, movedBlockViewZones.map(zones => /** @description movedBlockViewZones.original */zones.map(z => z.original))));\n    this._register(applyViewZones(this._editors.modified, movedBlockViewZones.map(zones => /** @description movedBlockViewZones.modified */zones.map(z => z.modified))));\n    this._register(autorunWithStore((reader, store) => {\n      const blocks = movedBlockViewZones.read(reader);\n      for (const b of blocks) {\n        store.add(new MovedBlockOverlayWidget(this._editors.original, b.original, b.move, 'original', this._diffModel.get()));\n        store.add(new MovedBlockOverlayWidget(this._editors.modified, b.modified, b.move, 'modified', this._diffModel.get()));\n      }\n    }));\n    const originalCursorPosition = observableFromEvent(this._editors.original.onDidChangeCursorPosition, () => this._editors.original.getPosition());\n    const modifiedCursorPosition = observableFromEvent(this._editors.modified.onDidChangeCursorPosition, () => this._editors.modified.getPosition());\n    const originalHasFocus = observableSignalFromEvent('original.onDidFocusEditorWidget', e => this._editors.original.onDidFocusEditorWidget(() => setTimeout(() => e(undefined), 0)));\n    const modifiedHasFocus = observableSignalFromEvent('modified.onDidFocusEditorWidget', e => this._editors.modified.onDidFocusEditorWidget(() => setTimeout(() => e(undefined), 0)));\n    let lastChangedEditor = 'modified';\n    this._register(autorunHandleChanges({\n      createEmptyChangeSummary: () => undefined,\n      handleChange: (ctx, summary) => {\n        if (ctx.didChange(originalHasFocus)) {\n          lastChangedEditor = 'original';\n        }\n        if (ctx.didChange(modifiedHasFocus)) {\n          lastChangedEditor = 'modified';\n        }\n        return true;\n      }\n    }, reader => {\n      /** @description MovedBlocksLines.setActiveMovedTextFromCursor */\n      originalHasFocus.read(reader);\n      modifiedHasFocus.read(reader);\n      const m = this._diffModel.read(reader);\n      if (!m) {\n        return;\n      }\n      const diff = m.diff.read(reader);\n      let movedText = undefined;\n      if (diff && lastChangedEditor === 'original') {\n        const originalPos = originalCursorPosition.read(reader);\n        if (originalPos) {\n          movedText = diff.movedTexts.find(m => m.lineRangeMapping.original.contains(originalPos.lineNumber));\n        }\n      }\n      if (diff && lastChangedEditor === 'modified') {\n        const modifiedPos = modifiedCursorPosition.read(reader);\n        if (modifiedPos) {\n          movedText = diff.movedTexts.find(m => m.lineRangeMapping.modified.contains(modifiedPos.lineNumber));\n        }\n      }\n      if (movedText !== m.movedTextToCompare.get()) {\n        m.movedTextToCompare.set(undefined, undefined);\n      }\n      m.setActiveMovedText(movedText);\n    }));\n  }\n}\nMovedBlocksLinesPart.movedCodeBlockPadding = 4;\nclass LinesLayout {\n  static compute(lines) {\n    const setsPerTrack = [];\n    const trackPerLineIdx = [];\n    for (const line of lines) {\n      let trackIdx = setsPerTrack.findIndex(set => !set.intersectsStrict(line));\n      if (trackIdx === -1) {\n        const maxTrackCount = 6;\n        if (setsPerTrack.length >= maxTrackCount) {\n          trackIdx = findMaxIdxBy(setsPerTrack, compareBy(set => set.intersectWithRangeLength(line), numberComparator));\n        } else {\n          trackIdx = setsPerTrack.length;\n          setsPerTrack.push(new OffsetRangeSet());\n        }\n      }\n      setsPerTrack[trackIdx].addRange(line);\n      trackPerLineIdx.push(trackIdx);\n    }\n    return new LinesLayout(setsPerTrack.length, trackPerLineIdx);\n  }\n  constructor(_trackCount, trackPerLineIdx) {\n    this._trackCount = _trackCount;\n    this.trackPerLineIdx = trackPerLineIdx;\n  }\n  getTrack(lineIdx) {\n    return this.trackPerLineIdx[lineIdx];\n  }\n  getTrackCount() {\n    return this._trackCount;\n  }\n}\nclass MovedBlockOverlayWidget extends ViewZoneOverlayWidget {\n  constructor(_editor, _viewZone, _move, _kind, _diffModel) {\n    const root = h('div.diff-hidden-lines-widget');\n    super(_editor, _viewZone, root.root);\n    this._editor = _editor;\n    this._move = _move;\n    this._kind = _kind;\n    this._diffModel = _diffModel;\n    this._nodes = h('div.diff-moved-code-block', {\n      style: {\n        marginRight: '4px'\n      }\n    }, [h('div.text-content@textContent'), h('div.action-bar@actionBar')]);\n    root.root.appendChild(this._nodes.root);\n    const editorLayout = observableFromEvent(this._editor.onDidLayoutChange, () => this._editor.getLayoutInfo());\n    this._register(applyStyle(this._nodes.root, {\n      paddingRight: editorLayout.map(l => l.verticalScrollbarWidth)\n    }));\n    let text;\n    if (_move.changes.length > 0) {\n      text = this._kind === 'original' ? localize('codeMovedToWithChanges', 'Code moved with changes to line {0}-{1}', this._move.lineRangeMapping.modified.startLineNumber, this._move.lineRangeMapping.modified.endLineNumberExclusive - 1) : localize('codeMovedFromWithChanges', 'Code moved with changes from line {0}-{1}', this._move.lineRangeMapping.original.startLineNumber, this._move.lineRangeMapping.original.endLineNumberExclusive - 1);\n    } else {\n      text = this._kind === 'original' ? localize('codeMovedTo', 'Code moved to line {0}-{1}', this._move.lineRangeMapping.modified.startLineNumber, this._move.lineRangeMapping.modified.endLineNumberExclusive - 1) : localize('codeMovedFrom', 'Code moved from line {0}-{1}', this._move.lineRangeMapping.original.startLineNumber, this._move.lineRangeMapping.original.endLineNumberExclusive - 1);\n    }\n    const actionBar = this._register(new ActionBar(this._nodes.actionBar, {\n      highlightToggledItems: true\n    }));\n    const caption = new Action('', text, '', false);\n    actionBar.push(caption, {\n      icon: false,\n      label: true\n    });\n    const actionCompare = new Action('', 'Compare', ThemeIcon.asClassName(Codicon.compareChanges), true, () => {\n      this._editor.focus();\n      this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get() === _move ? undefined : this._move, undefined);\n    });\n    this._register(autorun(reader => {\n      const isActive = this._diffModel.movedTextToCompare.read(reader) === _move;\n      actionCompare.checked = isActive;\n    }));\n    actionBar.push(actionCompare, {\n      icon: false,\n      label: true\n    });\n  }\n}","map":{"version":3,"names":["h","ActionBar","Action","booleanComparator","compareBy","numberComparator","tieBreakComparators","findMaxIdxBy","Codicon","Disposable","toDisposable","autorun","autorunHandleChanges","autorunWithStore","constObservable","derived","derivedWithStore","observableFromEvent","observableSignalFromEvent","observableValue","recomputeInitiallyAndOnChange","ThemeIcon","PlaceholderViewZone","ViewZoneOverlayWidget","applyStyle","applyViewZones","OffsetRange","OffsetRangeSet","localize","MovedBlocksLinesPart","constructor","_rootElement","_diffModel","_originalEditorLayoutInfo","_modifiedEditorLayoutInfo","_editors","_originalScrollTop","original","onDidScrollChange","getScrollTop","_modifiedScrollTop","modified","_viewZonesChanged","onDidChangeViewZones","width","_modifiedViewZonesChangedSignal","_originalViewZonesChangedSignal","_state","reader","store","_a","_element","replaceChildren","model","read","moves","diff","movedTexts","length","set","undefined","infoOrig","infoMod","lines","map","move","computeLineStart","range","editor","t1","getTopForLineNumber","startLineNumber","t2","endLineNumberExclusive","start","lineRangeMapping","startOffset","end","endOffset","from","to","top","Math","min","bottom","max","fromWithoutScroll","toWithoutScroll","sort","l","layout","LinesLayout","compute","padding","lineAreaLeft","verticalScrollbarWidth","lineAreaWidth","getTrackCount","contentLeft","movedCodeBlockPadding","idx","line","track","getTrack","verticalY","arrowHeight","arrowWidth","right","rectWidth","glyphMarginWidth","lineNumbersWidth","rectHeight","rect","document","createElementNS","classList","add","setAttribute","appendChild","g","path","arrowRight","toggle","activeMovedText","_register","remove","info","info2","style","left","height","movedBlockViewZones","d","zones","z","blocks","b","MovedBlockOverlayWidget","get","originalCursorPosition","onDidChangeCursorPosition","getPosition","modifiedCursorPosition","originalHasFocus","e","onDidFocusEditorWidget","setTimeout","modifiedHasFocus","lastChangedEditor","createEmptyChangeSummary","handleChange","ctx","summary","didChange","m","movedText","originalPos","find","contains","lineNumber","modifiedPos","movedTextToCompare","setActiveMovedText","setsPerTrack","trackPerLineIdx","trackIdx","findIndex","intersectsStrict","maxTrackCount","intersectWithRangeLength","push","addRange","_trackCount","lineIdx","_editor","_viewZone","_move","_kind","root","_nodes","marginRight","editorLayout","onDidLayoutChange","getLayoutInfo","paddingRight","text","changes","actionBar","highlightToggledItems","caption","icon","label","actionCompare","asClassName","compareChanges","focus","isActive","checked"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/monaco-editor/esm/vs/editor/browser/widget/diffEditor/movedBlocksLines.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { h } from '../../../../base/browser/dom.js';\nimport { ActionBar } from '../../../../base/browser/ui/actionbar/actionbar.js';\nimport { Action } from '../../../../base/common/actions.js';\nimport { booleanComparator, compareBy, numberComparator, tieBreakComparators } from '../../../../base/common/arrays.js';\nimport { findMaxIdxBy } from '../../../../base/common/arraysFind.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunHandleChanges, autorunWithStore, constObservable, derived, derivedWithStore, observableFromEvent, observableSignalFromEvent, observableValue, recomputeInitiallyAndOnChange } from '../../../../base/common/observable.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { PlaceholderViewZone, ViewZoneOverlayWidget, applyStyle, applyViewZones } from './utils.js';\nimport { OffsetRange, OffsetRangeSet } from '../../../common/core/offsetRange.js';\nimport { localize } from '../../../../nls.js';\nexport class MovedBlocksLinesPart extends Disposable {\n    constructor(_rootElement, _diffModel, _originalEditorLayoutInfo, _modifiedEditorLayoutInfo, _editors) {\n        super();\n        this._rootElement = _rootElement;\n        this._diffModel = _diffModel;\n        this._originalEditorLayoutInfo = _originalEditorLayoutInfo;\n        this._modifiedEditorLayoutInfo = _modifiedEditorLayoutInfo;\n        this._editors = _editors;\n        this._originalScrollTop = observableFromEvent(this._editors.original.onDidScrollChange, () => this._editors.original.getScrollTop());\n        this._modifiedScrollTop = observableFromEvent(this._editors.modified.onDidScrollChange, () => this._editors.modified.getScrollTop());\n        this._viewZonesChanged = observableSignalFromEvent('onDidChangeViewZones', this._editors.modified.onDidChangeViewZones);\n        this.width = observableValue(this, 0);\n        this._modifiedViewZonesChangedSignal = observableSignalFromEvent('modified.onDidChangeViewZones', this._editors.modified.onDidChangeViewZones);\n        this._originalViewZonesChangedSignal = observableSignalFromEvent('original.onDidChangeViewZones', this._editors.original.onDidChangeViewZones);\n        this._state = derivedWithStore(this, (reader, store) => {\n            /** @description state */\n            var _a;\n            this._element.replaceChildren();\n            const model = this._diffModel.read(reader);\n            const moves = (_a = model === null || model === void 0 ? void 0 : model.diff.read(reader)) === null || _a === void 0 ? void 0 : _a.movedTexts;\n            if (!moves || moves.length === 0) {\n                this.width.set(0, undefined);\n                return;\n            }\n            this._viewZonesChanged.read(reader);\n            const infoOrig = this._originalEditorLayoutInfo.read(reader);\n            const infoMod = this._modifiedEditorLayoutInfo.read(reader);\n            if (!infoOrig || !infoMod) {\n                this.width.set(0, undefined);\n                return;\n            }\n            this._modifiedViewZonesChangedSignal.read(reader);\n            this._originalViewZonesChangedSignal.read(reader);\n            const lines = moves.map((move) => {\n                function computeLineStart(range, editor) {\n                    const t1 = editor.getTopForLineNumber(range.startLineNumber, true);\n                    const t2 = editor.getTopForLineNumber(range.endLineNumberExclusive, true);\n                    return (t1 + t2) / 2;\n                }\n                const start = computeLineStart(move.lineRangeMapping.original, this._editors.original);\n                const startOffset = this._originalScrollTop.read(reader);\n                const end = computeLineStart(move.lineRangeMapping.modified, this._editors.modified);\n                const endOffset = this._modifiedScrollTop.read(reader);\n                const from = start - startOffset;\n                const to = end - endOffset;\n                const top = Math.min(start, end);\n                const bottom = Math.max(start, end);\n                return { range: new OffsetRange(top, bottom), from, to, fromWithoutScroll: start, toWithoutScroll: end, move };\n            });\n            lines.sort(tieBreakComparators(compareBy(l => l.fromWithoutScroll > l.toWithoutScroll, booleanComparator), compareBy(l => l.fromWithoutScroll > l.toWithoutScroll ? l.fromWithoutScroll : -l.toWithoutScroll, numberComparator)));\n            const layout = LinesLayout.compute(lines.map(l => l.range));\n            const padding = 10;\n            const lineAreaLeft = infoOrig.verticalScrollbarWidth;\n            const lineAreaWidth = (layout.getTrackCount() - 1) * 10 + padding * 2;\n            const width = lineAreaLeft + lineAreaWidth + (infoMod.contentLeft - MovedBlocksLinesPart.movedCodeBlockPadding);\n            let idx = 0;\n            for (const line of lines) {\n                const track = layout.getTrack(idx);\n                const verticalY = lineAreaLeft + padding + track * 10;\n                const arrowHeight = 15;\n                const arrowWidth = 15;\n                const right = width;\n                const rectWidth = infoMod.glyphMarginWidth + infoMod.lineNumbersWidth;\n                const rectHeight = 18;\n                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n                rect.classList.add('arrow-rectangle');\n                rect.setAttribute('x', `${right - rectWidth}`);\n                rect.setAttribute('y', `${line.to - rectHeight / 2}`);\n                rect.setAttribute('width', `${rectWidth}`);\n                rect.setAttribute('height', `${rectHeight}`);\n                this._element.appendChild(rect);\n                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n                path.setAttribute('d', `M ${0} ${line.from} L ${verticalY} ${line.from} L ${verticalY} ${line.to} L ${right - arrowWidth} ${line.to}`);\n                path.setAttribute('fill', 'none');\n                g.appendChild(path);\n                const arrowRight = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');\n                arrowRight.classList.add('arrow');\n                store.add(autorun(reader => {\n                    path.classList.toggle('currentMove', line.move === model.activeMovedText.read(reader));\n                    arrowRight.classList.toggle('currentMove', line.move === model.activeMovedText.read(reader));\n                }));\n                arrowRight.setAttribute('points', `${right - arrowWidth},${line.to - arrowHeight / 2} ${right},${line.to} ${right - arrowWidth},${line.to + arrowHeight / 2}`);\n                g.appendChild(arrowRight);\n                this._element.appendChild(g);\n                /*\n                TODO@hediet\n                path.addEventListener('mouseenter', () => {\n                    model.setHoveredMovedText(line.move);\n                });\n                path.addEventListener('mouseleave', () => {\n                    model.setHoveredMovedText(undefined);\n                });*/\n                idx++;\n            }\n            this.width.set(lineAreaWidth, undefined);\n        });\n        this._element = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        this._element.setAttribute('class', 'moved-blocks-lines');\n        this._rootElement.appendChild(this._element);\n        this._register(toDisposable(() => this._element.remove()));\n        this._register(autorun(reader => {\n            /** @description update moved blocks lines positioning */\n            const info = this._originalEditorLayoutInfo.read(reader);\n            const info2 = this._modifiedEditorLayoutInfo.read(reader);\n            if (!info || !info2) {\n                return;\n            }\n            this._element.style.left = `${info.width - info.verticalScrollbarWidth}px`;\n            this._element.style.height = `${info.height}px`;\n            this._element.style.width = `${info.verticalScrollbarWidth + info.contentLeft - MovedBlocksLinesPart.movedCodeBlockPadding + this.width.read(reader)}px`;\n        }));\n        this._register(recomputeInitiallyAndOnChange(this._state));\n        const movedBlockViewZones = derived(reader => {\n            const model = this._diffModel.read(reader);\n            const d = model === null || model === void 0 ? void 0 : model.diff.read(reader);\n            if (!d) {\n                return [];\n            }\n            return d.movedTexts.map(move => ({\n                move,\n                original: new PlaceholderViewZone(constObservable(move.lineRangeMapping.original.startLineNumber - 1), 18),\n                modified: new PlaceholderViewZone(constObservable(move.lineRangeMapping.modified.startLineNumber - 1), 18),\n            }));\n        });\n        this._register(applyViewZones(this._editors.original, movedBlockViewZones.map(zones => /** @description movedBlockViewZones.original */ zones.map(z => z.original))));\n        this._register(applyViewZones(this._editors.modified, movedBlockViewZones.map(zones => /** @description movedBlockViewZones.modified */ zones.map(z => z.modified))));\n        this._register(autorunWithStore((reader, store) => {\n            const blocks = movedBlockViewZones.read(reader);\n            for (const b of blocks) {\n                store.add(new MovedBlockOverlayWidget(this._editors.original, b.original, b.move, 'original', this._diffModel.get()));\n                store.add(new MovedBlockOverlayWidget(this._editors.modified, b.modified, b.move, 'modified', this._diffModel.get()));\n            }\n        }));\n        const originalCursorPosition = observableFromEvent(this._editors.original.onDidChangeCursorPosition, () => this._editors.original.getPosition());\n        const modifiedCursorPosition = observableFromEvent(this._editors.modified.onDidChangeCursorPosition, () => this._editors.modified.getPosition());\n        const originalHasFocus = observableSignalFromEvent('original.onDidFocusEditorWidget', e => this._editors.original.onDidFocusEditorWidget(() => setTimeout(() => e(undefined), 0)));\n        const modifiedHasFocus = observableSignalFromEvent('modified.onDidFocusEditorWidget', e => this._editors.modified.onDidFocusEditorWidget(() => setTimeout(() => e(undefined), 0)));\n        let lastChangedEditor = 'modified';\n        this._register(autorunHandleChanges({\n            createEmptyChangeSummary: () => undefined,\n            handleChange: (ctx, summary) => {\n                if (ctx.didChange(originalHasFocus)) {\n                    lastChangedEditor = 'original';\n                }\n                if (ctx.didChange(modifiedHasFocus)) {\n                    lastChangedEditor = 'modified';\n                }\n                return true;\n            }\n        }, reader => {\n            /** @description MovedBlocksLines.setActiveMovedTextFromCursor */\n            originalHasFocus.read(reader);\n            modifiedHasFocus.read(reader);\n            const m = this._diffModel.read(reader);\n            if (!m) {\n                return;\n            }\n            const diff = m.diff.read(reader);\n            let movedText = undefined;\n            if (diff && lastChangedEditor === 'original') {\n                const originalPos = originalCursorPosition.read(reader);\n                if (originalPos) {\n                    movedText = diff.movedTexts.find(m => m.lineRangeMapping.original.contains(originalPos.lineNumber));\n                }\n            }\n            if (diff && lastChangedEditor === 'modified') {\n                const modifiedPos = modifiedCursorPosition.read(reader);\n                if (modifiedPos) {\n                    movedText = diff.movedTexts.find(m => m.lineRangeMapping.modified.contains(modifiedPos.lineNumber));\n                }\n            }\n            if (movedText !== m.movedTextToCompare.get()) {\n                m.movedTextToCompare.set(undefined, undefined);\n            }\n            m.setActiveMovedText(movedText);\n        }));\n    }\n}\nMovedBlocksLinesPart.movedCodeBlockPadding = 4;\nclass LinesLayout {\n    static compute(lines) {\n        const setsPerTrack = [];\n        const trackPerLineIdx = [];\n        for (const line of lines) {\n            let trackIdx = setsPerTrack.findIndex(set => !set.intersectsStrict(line));\n            if (trackIdx === -1) {\n                const maxTrackCount = 6;\n                if (setsPerTrack.length >= maxTrackCount) {\n                    trackIdx = findMaxIdxBy(setsPerTrack, compareBy(set => set.intersectWithRangeLength(line), numberComparator));\n                }\n                else {\n                    trackIdx = setsPerTrack.length;\n                    setsPerTrack.push(new OffsetRangeSet());\n                }\n            }\n            setsPerTrack[trackIdx].addRange(line);\n            trackPerLineIdx.push(trackIdx);\n        }\n        return new LinesLayout(setsPerTrack.length, trackPerLineIdx);\n    }\n    constructor(_trackCount, trackPerLineIdx) {\n        this._trackCount = _trackCount;\n        this.trackPerLineIdx = trackPerLineIdx;\n    }\n    getTrack(lineIdx) {\n        return this.trackPerLineIdx[lineIdx];\n    }\n    getTrackCount() {\n        return this._trackCount;\n    }\n}\nclass MovedBlockOverlayWidget extends ViewZoneOverlayWidget {\n    constructor(_editor, _viewZone, _move, _kind, _diffModel) {\n        const root = h('div.diff-hidden-lines-widget');\n        super(_editor, _viewZone, root.root);\n        this._editor = _editor;\n        this._move = _move;\n        this._kind = _kind;\n        this._diffModel = _diffModel;\n        this._nodes = h('div.diff-moved-code-block', { style: { marginRight: '4px' } }, [\n            h('div.text-content@textContent'),\n            h('div.action-bar@actionBar'),\n        ]);\n        root.root.appendChild(this._nodes.root);\n        const editorLayout = observableFromEvent(this._editor.onDidLayoutChange, () => this._editor.getLayoutInfo());\n        this._register(applyStyle(this._nodes.root, {\n            paddingRight: editorLayout.map(l => l.verticalScrollbarWidth)\n        }));\n        let text;\n        if (_move.changes.length > 0) {\n            text = this._kind === 'original' ? localize('codeMovedToWithChanges', 'Code moved with changes to line {0}-{1}', this._move.lineRangeMapping.modified.startLineNumber, this._move.lineRangeMapping.modified.endLineNumberExclusive - 1) : localize('codeMovedFromWithChanges', 'Code moved with changes from line {0}-{1}', this._move.lineRangeMapping.original.startLineNumber, this._move.lineRangeMapping.original.endLineNumberExclusive - 1);\n        }\n        else {\n            text = this._kind === 'original' ? localize('codeMovedTo', 'Code moved to line {0}-{1}', this._move.lineRangeMapping.modified.startLineNumber, this._move.lineRangeMapping.modified.endLineNumberExclusive - 1) : localize('codeMovedFrom', 'Code moved from line {0}-{1}', this._move.lineRangeMapping.original.startLineNumber, this._move.lineRangeMapping.original.endLineNumberExclusive - 1);\n        }\n        const actionBar = this._register(new ActionBar(this._nodes.actionBar, {\n            highlightToggledItems: true,\n        }));\n        const caption = new Action('', text, '', false);\n        actionBar.push(caption, { icon: false, label: true });\n        const actionCompare = new Action('', 'Compare', ThemeIcon.asClassName(Codicon.compareChanges), true, () => {\n            this._editor.focus();\n            this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get() === _move ? undefined : this._move, undefined);\n        });\n        this._register(autorun(reader => {\n            const isActive = this._diffModel.movedTextToCompare.read(reader) === _move;\n            actionCompare.checked = isActive;\n        }));\n        actionBar.push(actionCompare, { icon: false, label: true });\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}