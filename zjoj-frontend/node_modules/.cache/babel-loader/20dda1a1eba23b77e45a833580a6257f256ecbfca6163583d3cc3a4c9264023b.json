{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar CommonFindController_1;\nimport { Delayer } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditorAction, EditorCommand, MultiEditorAction, registerEditorAction, registerEditorCommand, registerEditorContribution, registerMultiEditorAction } from '../../../browser/editorExtensions.js';\nimport { overviewRulerRangeHighlight } from '../../../common/core/editorColorRegistry.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_FIND_WIDGET_VISIBLE, CONTEXT_REPLACE_INPUT_FOCUSED, FindModelBoundToEditorModel, FIND_IDS, ToggleCaseSensitiveKeybinding, TogglePreserveCaseKeybinding, ToggleRegexKeybinding, ToggleSearchScopeKeybinding, ToggleWholeWordKeybinding } from './findModel.js';\nimport { FindOptionsWidget } from './findOptionsWidget.js';\nimport { FindReplaceState } from './findState.js';\nimport { FindWidget } from './findWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { IThemeService, themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nconst SEARCH_STRING_MAX_LENGTH = 524288;\nexport function getSelectionSearchString(editor, seedSearchStringFromSelection = 'single', seedSearchStringFromNonEmptySelection = false) {\n  if (!editor.hasModel()) {\n    return null;\n  }\n  const selection = editor.getSelection();\n  // if selection spans multiple lines, default search string to empty\n  if (seedSearchStringFromSelection === 'single' && selection.startLineNumber === selection.endLineNumber || seedSearchStringFromSelection === 'multiple') {\n    if (selection.isEmpty()) {\n      const wordAtPosition = editor.getConfiguredWordAtPosition(selection.getStartPosition());\n      if (wordAtPosition && false === seedSearchStringFromNonEmptySelection) {\n        return wordAtPosition.word;\n      }\n    } else {\n      if (editor.getModel().getValueLengthInRange(selection) < SEARCH_STRING_MAX_LENGTH) {\n        return editor.getModel().getValueInRange(selection);\n      }\n    }\n  }\n  return null;\n}\nlet CommonFindController = CommonFindController_1 = class CommonFindController extends Disposable {\n  get editor() {\n    return this._editor;\n  }\n  static get(editor) {\n    return editor.getContribution(CommonFindController_1.ID);\n  }\n  constructor(editor, contextKeyService, storageService, clipboardService, notificationService) {\n    super();\n    this._editor = editor;\n    this._findWidgetVisible = CONTEXT_FIND_WIDGET_VISIBLE.bindTo(contextKeyService);\n    this._contextKeyService = contextKeyService;\n    this._storageService = storageService;\n    this._clipboardService = clipboardService;\n    this._notificationService = notificationService;\n    this._updateHistoryDelayer = new Delayer(500);\n    this._state = this._register(new FindReplaceState());\n    this.loadQueryState();\n    this._register(this._state.onFindReplaceStateChange(e => this._onStateChanged(e)));\n    this._model = null;\n    this._register(this._editor.onDidChangeModel(() => {\n      const shouldRestartFind = this._editor.getModel() && this._state.isRevealed;\n      this.disposeModel();\n      this._state.change({\n        searchScope: null,\n        matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* StorageScope.WORKSPACE */, false),\n        wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* StorageScope.WORKSPACE */, false),\n        isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* StorageScope.WORKSPACE */, false),\n        preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* StorageScope.WORKSPACE */, false)\n      }, false);\n      if (shouldRestartFind) {\n        this._start({\n          forceRevealReplace: false,\n          seedSearchStringFromSelection: 'none',\n          seedSearchStringFromNonEmptySelection: false,\n          seedSearchStringFromGlobalClipboard: false,\n          shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n          shouldAnimate: false,\n          updateSearchScope: false,\n          loop: this._editor.getOption(41 /* EditorOption.find */).loop\n        });\n      }\n    }));\n  }\n  dispose() {\n    this.disposeModel();\n    super.dispose();\n  }\n  disposeModel() {\n    if (this._model) {\n      this._model.dispose();\n      this._model = null;\n    }\n  }\n  _onStateChanged(e) {\n    this.saveQueryState(e);\n    if (e.isRevealed) {\n      if (this._state.isRevealed) {\n        this._findWidgetVisible.set(true);\n      } else {\n        this._findWidgetVisible.reset();\n        this.disposeModel();\n      }\n    }\n    if (e.searchString) {\n      this.setGlobalBufferTerm(this._state.searchString);\n    }\n  }\n  saveQueryState(e) {\n    if (e.isRegex) {\n      this._storageService.store('editor.isRegex', this._state.actualIsRegex, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n    }\n    if (e.wholeWord) {\n      this._storageService.store('editor.wholeWord', this._state.actualWholeWord, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n    }\n    if (e.matchCase) {\n      this._storageService.store('editor.matchCase', this._state.actualMatchCase, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n    }\n    if (e.preserveCase) {\n      this._storageService.store('editor.preserveCase', this._state.actualPreserveCase, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n    }\n  }\n  loadQueryState() {\n    this._state.change({\n      matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* StorageScope.WORKSPACE */, this._state.matchCase),\n      wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* StorageScope.WORKSPACE */, this._state.wholeWord),\n      isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* StorageScope.WORKSPACE */, this._state.isRegex),\n      preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* StorageScope.WORKSPACE */, this._state.preserveCase)\n    }, false);\n  }\n  isFindInputFocused() {\n    return !!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService);\n  }\n  getState() {\n    return this._state;\n  }\n  closeFindWidget() {\n    this._state.change({\n      isRevealed: false,\n      searchScope: null\n    }, false);\n    this._editor.focus();\n  }\n  toggleCaseSensitive() {\n    this._state.change({\n      matchCase: !this._state.matchCase\n    }, false);\n    if (!this._state.isRevealed) {\n      this.highlightFindOptions();\n    }\n  }\n  toggleWholeWords() {\n    this._state.change({\n      wholeWord: !this._state.wholeWord\n    }, false);\n    if (!this._state.isRevealed) {\n      this.highlightFindOptions();\n    }\n  }\n  toggleRegex() {\n    this._state.change({\n      isRegex: !this._state.isRegex\n    }, false);\n    if (!this._state.isRevealed) {\n      this.highlightFindOptions();\n    }\n  }\n  togglePreserveCase() {\n    this._state.change({\n      preserveCase: !this._state.preserveCase\n    }, false);\n    if (!this._state.isRevealed) {\n      this.highlightFindOptions();\n    }\n  }\n  toggleSearchScope() {\n    if (this._state.searchScope) {\n      this._state.change({\n        searchScope: null\n      }, true);\n    } else {\n      if (this._editor.hasModel()) {\n        const selections = this._editor.getSelections();\n        selections.map(selection => {\n          if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n            selection = selection.setEndPosition(selection.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n          }\n          if (!selection.isEmpty()) {\n            return selection;\n          }\n          return null;\n        }).filter(element => !!element);\n        if (selections.length) {\n          this._state.change({\n            searchScope: selections\n          }, true);\n        }\n      }\n    }\n  }\n  setSearchString(searchString) {\n    if (this._state.isRegex) {\n      searchString = strings.escapeRegExpCharacters(searchString);\n    }\n    this._state.change({\n      searchString: searchString\n    }, false);\n  }\n  highlightFindOptions(ignoreWhenVisible = false) {\n    // overwritten in subclass\n  }\n  async _start(opts, newState) {\n    this.disposeModel();\n    if (!this._editor.hasModel()) {\n      // cannot do anything with an editor that doesn't have a model...\n      return;\n    }\n    const stateChanges = {\n      ...newState,\n      isRevealed: true\n    };\n    if (opts.seedSearchStringFromSelection === 'single') {\n      const selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection, opts.seedSearchStringFromNonEmptySelection);\n      if (selectionSearchString) {\n        if (this._state.isRegex) {\n          stateChanges.searchString = strings.escapeRegExpCharacters(selectionSearchString);\n        } else {\n          stateChanges.searchString = selectionSearchString;\n        }\n      }\n    } else if (opts.seedSearchStringFromSelection === 'multiple' && !opts.updateSearchScope) {\n      const selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection);\n      if (selectionSearchString) {\n        stateChanges.searchString = selectionSearchString;\n      }\n    }\n    if (!stateChanges.searchString && opts.seedSearchStringFromGlobalClipboard) {\n      const selectionSearchString = await this.getGlobalBufferTerm();\n      if (!this._editor.hasModel()) {\n        // the editor has lost its model in the meantime\n        return;\n      }\n      if (selectionSearchString) {\n        stateChanges.searchString = selectionSearchString;\n      }\n    }\n    // Overwrite isReplaceRevealed\n    if (opts.forceRevealReplace || stateChanges.isReplaceRevealed) {\n      stateChanges.isReplaceRevealed = true;\n    } else if (!this._findWidgetVisible.get()) {\n      stateChanges.isReplaceRevealed = false;\n    }\n    if (opts.updateSearchScope) {\n      const currentSelections = this._editor.getSelections();\n      if (currentSelections.some(selection => !selection.isEmpty())) {\n        stateChanges.searchScope = currentSelections;\n      }\n    }\n    stateChanges.loop = opts.loop;\n    this._state.change(stateChanges, false);\n    if (!this._model) {\n      this._model = new FindModelBoundToEditorModel(this._editor, this._state);\n    }\n  }\n  start(opts, newState) {\n    return this._start(opts, newState);\n  }\n  moveToNextMatch() {\n    if (this._model) {\n      this._model.moveToNextMatch();\n      return true;\n    }\n    return false;\n  }\n  moveToPrevMatch() {\n    if (this._model) {\n      this._model.moveToPrevMatch();\n      return true;\n    }\n    return false;\n  }\n  goToMatch(index) {\n    if (this._model) {\n      this._model.moveToMatch(index);\n      return true;\n    }\n    return false;\n  }\n  replace() {\n    if (this._model) {\n      this._model.replace();\n      return true;\n    }\n    return false;\n  }\n  replaceAll() {\n    var _a;\n    if (this._model) {\n      if ((_a = this._editor.getModel()) === null || _a === void 0 ? void 0 : _a.isTooLargeForHeapOperation()) {\n        this._notificationService.warn(nls.localize('too.large.for.replaceall', \"The file is too large to perform a replace all operation.\"));\n        return false;\n      }\n      this._model.replaceAll();\n      return true;\n    }\n    return false;\n  }\n  selectAllMatches() {\n    if (this._model) {\n      this._model.selectAllMatches();\n      this._editor.focus();\n      return true;\n    }\n    return false;\n  }\n  async getGlobalBufferTerm() {\n    if (this._editor.getOption(41 /* EditorOption.find */).globalFindClipboard && this._editor.hasModel() && !this._editor.getModel().isTooLargeForSyncing()) {\n      return this._clipboardService.readFindText();\n    }\n    return '';\n  }\n  setGlobalBufferTerm(text) {\n    if (this._editor.getOption(41 /* EditorOption.find */).globalFindClipboard && this._editor.hasModel() && !this._editor.getModel().isTooLargeForSyncing()) {\n      // intentionally not awaited\n      this._clipboardService.writeFindText(text);\n    }\n  }\n};\nCommonFindController.ID = 'editor.contrib.findController';\nCommonFindController = CommonFindController_1 = __decorate([__param(1, IContextKeyService), __param(2, IStorageService), __param(3, IClipboardService), __param(4, INotificationService)], CommonFindController);\nexport { CommonFindController };\nlet FindController = class FindController extends CommonFindController {\n  constructor(editor, _contextViewService, _contextKeyService, _keybindingService, _themeService, notificationService, _storageService, clipboardService) {\n    super(editor, _contextKeyService, _storageService, clipboardService, notificationService);\n    this._contextViewService = _contextViewService;\n    this._keybindingService = _keybindingService;\n    this._themeService = _themeService;\n    this._widget = null;\n    this._findOptionsWidget = null;\n  }\n  async _start(opts, newState) {\n    if (!this._widget) {\n      this._createFindWidget();\n    }\n    const selection = this._editor.getSelection();\n    let updateSearchScope = false;\n    switch (this._editor.getOption(41 /* EditorOption.find */).autoFindInSelection) {\n      case 'always':\n        updateSearchScope = true;\n        break;\n      case 'never':\n        updateSearchScope = false;\n        break;\n      case 'multiline':\n        {\n          const isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\n          updateSearchScope = isSelectionMultipleLine;\n          break;\n        }\n      default:\n        break;\n    }\n    opts.updateSearchScope = opts.updateSearchScope || updateSearchScope;\n    await super._start(opts, newState);\n    if (this._widget) {\n      if (opts.shouldFocus === 2 /* FindStartFocusAction.FocusReplaceInput */) {\n        this._widget.focusReplaceInput();\n      } else if (opts.shouldFocus === 1 /* FindStartFocusAction.FocusFindInput */) {\n        this._widget.focusFindInput();\n      }\n    }\n  }\n  highlightFindOptions(ignoreWhenVisible = false) {\n    if (!this._widget) {\n      this._createFindWidget();\n    }\n    if (this._state.isRevealed && !ignoreWhenVisible) {\n      this._widget.highlightFindOptions();\n    } else {\n      this._findOptionsWidget.highlightFindOptions();\n    }\n  }\n  _createFindWidget() {\n    this._widget = this._register(new FindWidget(this._editor, this, this._state, this._contextViewService, this._keybindingService, this._contextKeyService, this._themeService, this._storageService, this._notificationService));\n    this._findOptionsWidget = this._register(new FindOptionsWidget(this._editor, this._state, this._keybindingService));\n  }\n};\nFindController = __decorate([__param(1, IContextViewService), __param(2, IContextKeyService), __param(3, IKeybindingService), __param(4, IThemeService), __param(5, INotificationService), __param(6, IStorageService), __param(7, IClipboardService)], FindController);\nexport { FindController };\nexport const StartFindAction = registerMultiEditorAction(new MultiEditorAction({\n  id: FIND_IDS.StartFindAction,\n  label: nls.localize('startFindAction', \"Find\"),\n  alias: 'Find',\n  precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\n  kbOpts: {\n    kbExpr: null,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */,\n    weight: 100 /* KeybindingWeight.EditorContrib */\n  },\n  menuOpts: {\n    menuId: MenuId.MenubarEditMenu,\n    group: '3_find',\n    title: nls.localize({\n      key: 'miFind',\n      comment: ['&& denotes a mnemonic']\n    }, \"&&Find\"),\n    order: 1\n  }\n}));\nStartFindAction.addImplementation(0, (accessor, editor, args) => {\n  const controller = CommonFindController.get(editor);\n  if (!controller) {\n    return false;\n  }\n  return controller.start({\n    forceRevealReplace: false,\n    seedSearchStringFromSelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n    seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n    seedSearchStringFromGlobalClipboard: editor.getOption(41 /* EditorOption.find */).globalFindClipboard,\n    shouldFocus: 1 /* FindStartFocusAction.FocusFindInput */,\n    shouldAnimate: true,\n    updateSearchScope: false,\n    loop: editor.getOption(41 /* EditorOption.find */).loop\n  });\n});\nconst findArgDescription = {\n  description: 'Open a new In-Editor Find Widget.',\n  args: [{\n    name: 'Open a new In-Editor Find Widget args',\n    schema: {\n      properties: {\n        searchString: {\n          type: 'string'\n        },\n        replaceString: {\n          type: 'string'\n        },\n        regex: {\n          type: 'boolean'\n        },\n        regexOverride: {\n          type: 'number',\n          description: nls.localize('actions.find.isRegexOverride', 'Overrides \"Use Regular Expression\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n        },\n        wholeWord: {\n          type: 'boolean'\n        },\n        wholeWordOverride: {\n          type: 'number',\n          description: nls.localize('actions.find.wholeWordOverride', 'Overrides \"Match Whole Word\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n        },\n        matchCase: {\n          type: 'boolean'\n        },\n        matchCaseOverride: {\n          type: 'number',\n          description: nls.localize('actions.find.matchCaseOverride', 'Overrides \"Math Case\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n        },\n        preserveCase: {\n          type: 'boolean'\n        },\n        preserveCaseOverride: {\n          type: 'number',\n          description: nls.localize('actions.find.preserveCaseOverride', 'Overrides \"Preserve Case\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n        },\n        findInSelection: {\n          type: 'boolean'\n        }\n      }\n    }\n  }]\n};\nexport class StartFindWithArgsAction extends EditorAction {\n  constructor() {\n    super({\n      id: FIND_IDS.StartFindWithArgs,\n      label: nls.localize('startFindWithArgsAction', \"Find With Arguments\"),\n      alias: 'Find With Arguments',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: null,\n        primary: 0,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      },\n      metadata: findArgDescription\n    });\n  }\n  async run(accessor, editor, args) {\n    const controller = CommonFindController.get(editor);\n    if (controller) {\n      const newState = args ? {\n        searchString: args.searchString,\n        replaceString: args.replaceString,\n        isReplaceRevealed: args.replaceString !== undefined,\n        isRegex: args.isRegex,\n        // isRegexOverride: args.regexOverride,\n        wholeWord: args.matchWholeWord,\n        // wholeWordOverride: args.wholeWordOverride,\n        matchCase: args.isCaseSensitive,\n        // matchCaseOverride: args.matchCaseOverride,\n        preserveCase: args.preserveCase\n        // preserveCaseOverride: args.preserveCaseOverride,\n      } : {};\n      await controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: controller.getState().searchString.length === 0 && editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n        seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n        seedSearchStringFromGlobalClipboard: true,\n        shouldFocus: 1 /* FindStartFocusAction.FocusFindInput */,\n        shouldAnimate: true,\n        updateSearchScope: (args === null || args === void 0 ? void 0 : args.findInSelection) || false,\n        loop: editor.getOption(41 /* EditorOption.find */).loop\n      }, newState);\n      controller.setGlobalBufferTerm(controller.getState().searchString);\n    }\n  }\n}\nexport class StartFindWithSelectionAction extends EditorAction {\n  constructor() {\n    super({\n      id: FIND_IDS.StartFindWithSelection,\n      label: nls.localize('startFindWithSelectionAction', \"Find With Selection\"),\n      alias: 'Find With Selection',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: null,\n        primary: 0,\n        mac: {\n          primary: 2048 /* KeyMod.CtrlCmd */ | 35 /* KeyCode.KeyE */\n        },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      }\n    });\n  }\n  async run(accessor, editor) {\n    const controller = CommonFindController.get(editor);\n    if (controller) {\n      await controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: 'multiple',\n        seedSearchStringFromNonEmptySelection: false,\n        seedSearchStringFromGlobalClipboard: false,\n        shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(41 /* EditorOption.find */).loop\n      });\n      controller.setGlobalBufferTerm(controller.getState().searchString);\n    }\n  }\n}\nexport class MatchFindAction extends EditorAction {\n  async run(accessor, editor) {\n    const controller = CommonFindController.get(editor);\n    if (controller && !this._run(controller)) {\n      await controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: controller.getState().searchString.length === 0 && editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n        seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n        seedSearchStringFromGlobalClipboard: true,\n        shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(41 /* EditorOption.find */).loop\n      });\n      this._run(controller);\n    }\n  }\n}\nexport class NextMatchFindAction extends MatchFindAction {\n  constructor() {\n    super({\n      id: FIND_IDS.NextMatchFindAction,\n      label: nls.localize('findNextMatchAction', \"Find Next\"),\n      alias: 'Find Next',\n      precondition: undefined,\n      kbOpts: [{\n        kbExpr: EditorContextKeys.focus,\n        primary: 61 /* KeyCode.F3 */,\n        mac: {\n          primary: 2048 /* KeyMod.CtrlCmd */ | 37 /* KeyCode.KeyG */,\n          secondary: [61 /* KeyCode.F3 */]\n        },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      }, {\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n        primary: 3 /* KeyCode.Enter */,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      }]\n    });\n  }\n  _run(controller) {\n    const result = controller.moveToNextMatch();\n    if (result) {\n      controller.editor.pushUndoStop();\n      return true;\n    }\n    return false;\n  }\n}\nexport class PreviousMatchFindAction extends MatchFindAction {\n  constructor() {\n    super({\n      id: FIND_IDS.PreviousMatchFindAction,\n      label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\n      alias: 'Find Previous',\n      precondition: undefined,\n      kbOpts: [{\n        kbExpr: EditorContextKeys.focus,\n        primary: 1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */,\n        mac: {\n          primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 37 /* KeyCode.KeyG */,\n          secondary: [1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */]\n        },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      }, {\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n        primary: 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      }]\n    });\n  }\n  _run(controller) {\n    return controller.moveToPrevMatch();\n  }\n}\nexport class MoveToMatchFindAction extends EditorAction {\n  constructor() {\n    super({\n      id: FIND_IDS.GoToMatchFindAction,\n      label: nls.localize('findMatchAction.goToMatch', \"Go to Match...\"),\n      alias: 'Go to Match...',\n      precondition: CONTEXT_FIND_WIDGET_VISIBLE\n    });\n    this._highlightDecorations = [];\n  }\n  run(accessor, editor, args) {\n    const controller = CommonFindController.get(editor);\n    if (!controller) {\n      return;\n    }\n    const matchesCount = controller.getState().matchesCount;\n    if (matchesCount < 1) {\n      const notificationService = accessor.get(INotificationService);\n      notificationService.notify({\n        severity: Severity.Warning,\n        message: nls.localize('findMatchAction.noResults', \"No matches. Try searching for something else.\")\n      });\n      return;\n    }\n    const quickInputService = accessor.get(IQuickInputService);\n    const inputBox = quickInputService.createInputBox();\n    inputBox.placeholder = nls.localize('findMatchAction.inputPlaceHolder', \"Type a number to go to a specific match (between 1 and {0})\", matchesCount);\n    const toFindMatchIndex = value => {\n      const index = parseInt(value);\n      if (isNaN(index)) {\n        return undefined;\n      }\n      const matchCount = controller.getState().matchesCount;\n      if (index > 0 && index <= matchCount) {\n        return index - 1; // zero based\n      } else if (index < 0 && index >= -matchCount) {\n        return matchCount + index;\n      }\n      return undefined;\n    };\n    const updatePickerAndEditor = value => {\n      const index = toFindMatchIndex(value);\n      if (typeof index === 'number') {\n        // valid\n        inputBox.validationMessage = undefined;\n        controller.goToMatch(index);\n        const currentMatch = controller.getState().currentMatch;\n        if (currentMatch) {\n          this.addDecorations(editor, currentMatch);\n        }\n      } else {\n        inputBox.validationMessage = nls.localize('findMatchAction.inputValidationMessage', \"Please type a number between 1 and {0}\", controller.getState().matchesCount);\n        this.clearDecorations(editor);\n      }\n    };\n    inputBox.onDidChangeValue(value => {\n      updatePickerAndEditor(value);\n    });\n    inputBox.onDidAccept(() => {\n      const index = toFindMatchIndex(inputBox.value);\n      if (typeof index === 'number') {\n        controller.goToMatch(index);\n        inputBox.hide();\n      } else {\n        inputBox.validationMessage = nls.localize('findMatchAction.inputValidationMessage', \"Please type a number between 1 and {0}\", controller.getState().matchesCount);\n      }\n    });\n    inputBox.onDidHide(() => {\n      this.clearDecorations(editor);\n      inputBox.dispose();\n    });\n    inputBox.show();\n  }\n  clearDecorations(editor) {\n    editor.changeDecorations(changeAccessor => {\n      this._highlightDecorations = changeAccessor.deltaDecorations(this._highlightDecorations, []);\n    });\n  }\n  addDecorations(editor, range) {\n    editor.changeDecorations(changeAccessor => {\n      this._highlightDecorations = changeAccessor.deltaDecorations(this._highlightDecorations, [{\n        range,\n        options: {\n          description: 'find-match-quick-access-range-highlight',\n          className: 'rangeHighlight',\n          isWholeLine: true\n        }\n      }, {\n        range,\n        options: {\n          description: 'find-match-quick-access-range-highlight-overview',\n          overviewRuler: {\n            color: themeColorFromId(overviewRulerRangeHighlight),\n            position: OverviewRulerLane.Full\n          }\n        }\n      }]);\n    });\n  }\n}\nexport class SelectionMatchFindAction extends EditorAction {\n  async run(accessor, editor) {\n    const controller = CommonFindController.get(editor);\n    if (!controller) {\n      return;\n    }\n    const selectionSearchString = getSelectionSearchString(editor, 'single', false);\n    if (selectionSearchString) {\n      controller.setSearchString(selectionSearchString);\n    }\n    if (!this._run(controller)) {\n      await controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: 'none',\n        seedSearchStringFromNonEmptySelection: false,\n        seedSearchStringFromGlobalClipboard: false,\n        shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(41 /* EditorOption.find */).loop\n      });\n      this._run(controller);\n    }\n  }\n}\nexport class NextSelectionMatchFindAction extends SelectionMatchFindAction {\n  constructor() {\n    super({\n      id: FIND_IDS.NextSelectionMatchFindAction,\n      label: nls.localize('nextSelectionMatchFindAction', \"Find Next Selection\"),\n      alias: 'Find Next Selection',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 61 /* KeyCode.F3 */,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      }\n    });\n  }\n  _run(controller) {\n    return controller.moveToNextMatch();\n  }\n}\nexport class PreviousSelectionMatchFindAction extends SelectionMatchFindAction {\n  constructor() {\n    super({\n      id: FIND_IDS.PreviousSelectionMatchFindAction,\n      label: nls.localize('previousSelectionMatchFindAction', \"Find Previous Selection\"),\n      alias: 'Find Previous Selection',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n      }\n    });\n  }\n  _run(controller) {\n    return controller.moveToPrevMatch();\n  }\n}\nexport const StartFindReplaceAction = registerMultiEditorAction(new MultiEditorAction({\n  id: FIND_IDS.StartFindReplaceAction,\n  label: nls.localize('startReplace', \"Replace\"),\n  alias: 'Replace',\n  precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\n  kbOpts: {\n    kbExpr: null,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 38 /* KeyCode.KeyH */,\n    mac: {\n      primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */\n    },\n    weight: 100 /* KeybindingWeight.EditorContrib */\n  },\n  menuOpts: {\n    menuId: MenuId.MenubarEditMenu,\n    group: '3_find',\n    title: nls.localize({\n      key: 'miReplace',\n      comment: ['&& denotes a mnemonic']\n    }, \"&&Replace\"),\n    order: 2\n  }\n}));\nStartFindReplaceAction.addImplementation(0, (accessor, editor, args) => {\n  if (!editor.hasModel() || editor.getOption(90 /* EditorOption.readOnly */)) {\n    return false;\n  }\n  const controller = CommonFindController.get(editor);\n  if (!controller) {\n    return false;\n  }\n  const currentSelection = editor.getSelection();\n  const findInputFocused = controller.isFindInputFocused();\n  // we only seed search string from selection when the current selection is single line and not empty,\n  // + the find input is not focused\n  const seedSearchStringFromSelection = !currentSelection.isEmpty() && currentSelection.startLineNumber === currentSelection.endLineNumber && editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' && !findInputFocused;\n  /*\n  * if the existing search string in find widget is empty and we don't seed search string from selection, it means the Find Input is still empty, so we should focus the Find Input instead of Replace Input.\n   * findInputFocused true -> seedSearchStringFromSelection false, FocusReplaceInput\n  * findInputFocused false, seedSearchStringFromSelection true FocusReplaceInput\n  * findInputFocused false seedSearchStringFromSelection false FocusFindInput\n  */\n  const shouldFocus = findInputFocused || seedSearchStringFromSelection ? 2 /* FindStartFocusAction.FocusReplaceInput */ : 1 /* FindStartFocusAction.FocusFindInput */;\n  return controller.start({\n    forceRevealReplace: true,\n    seedSearchStringFromSelection: seedSearchStringFromSelection ? 'single' : 'none',\n    seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n    seedSearchStringFromGlobalClipboard: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never',\n    shouldFocus: shouldFocus,\n    shouldAnimate: true,\n    updateSearchScope: false,\n    loop: editor.getOption(41 /* EditorOption.find */).loop\n  });\n});\nregisterEditorContribution(CommonFindController.ID, FindController, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(StartFindWithArgsAction);\nregisterEditorAction(StartFindWithSelectionAction);\nregisterEditorAction(NextMatchFindAction);\nregisterEditorAction(PreviousMatchFindAction);\nregisterEditorAction(MoveToMatchFindAction);\nregisterEditorAction(NextSelectionMatchFindAction);\nregisterEditorAction(PreviousSelectionMatchFindAction);\nconst FindCommand = EditorCommand.bindToContribution(CommonFindController.get);\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.CloseFindWidgetCommand,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: x => x.closeFindWidget(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ToggleCaseSensitiveCommand,\n  precondition: undefined,\n  handler: x => x.toggleCaseSensitive(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: ToggleCaseSensitiveKeybinding.primary,\n    mac: ToggleCaseSensitiveKeybinding.mac,\n    win: ToggleCaseSensitiveKeybinding.win,\n    linux: ToggleCaseSensitiveKeybinding.linux\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ToggleWholeWordCommand,\n  precondition: undefined,\n  handler: x => x.toggleWholeWords(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: ToggleWholeWordKeybinding.primary,\n    mac: ToggleWholeWordKeybinding.mac,\n    win: ToggleWholeWordKeybinding.win,\n    linux: ToggleWholeWordKeybinding.linux\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ToggleRegexCommand,\n  precondition: undefined,\n  handler: x => x.toggleRegex(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: ToggleRegexKeybinding.primary,\n    mac: ToggleRegexKeybinding.mac,\n    win: ToggleRegexKeybinding.win,\n    linux: ToggleRegexKeybinding.linux\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ToggleSearchScopeCommand,\n  precondition: undefined,\n  handler: x => x.toggleSearchScope(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: ToggleSearchScopeKeybinding.primary,\n    mac: ToggleSearchScopeKeybinding.mac,\n    win: ToggleSearchScopeKeybinding.win,\n    linux: ToggleSearchScopeKeybinding.linux\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.TogglePreserveCaseCommand,\n  precondition: undefined,\n  handler: x => x.togglePreserveCase(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: TogglePreserveCaseKeybinding.primary,\n    mac: TogglePreserveCaseKeybinding.mac,\n    win: TogglePreserveCaseKeybinding.win,\n    linux: TogglePreserveCaseKeybinding.linux\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ReplaceOneAction,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: x => x.replace(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 22 /* KeyCode.Digit1 */\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ReplaceOneAction,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: x => x.replace(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n    primary: 3 /* KeyCode.Enter */\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ReplaceAllAction,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: x => x.replaceAll(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 3 /* KeyCode.Enter */\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ReplaceAllAction,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: x => x.replaceAll(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n    primary: undefined,\n    mac: {\n      primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */\n    }\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.SelectAllMatchesAction,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: x => x.selectAllMatches(),\n  kbOpts: {\n    weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: 512 /* KeyMod.Alt */ | 3 /* KeyCode.Enter */\n  }\n}));","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","CommonFindController_1","Delayer","Disposable","strings","EditorAction","EditorCommand","MultiEditorAction","registerEditorAction","registerEditorCommand","registerEditorContribution","registerMultiEditorAction","overviewRulerRangeHighlight","EditorContextKeys","OverviewRulerLane","CONTEXT_FIND_INPUT_FOCUSED","CONTEXT_FIND_WIDGET_VISIBLE","CONTEXT_REPLACE_INPUT_FOCUSED","FindModelBoundToEditorModel","FIND_IDS","ToggleCaseSensitiveKeybinding","TogglePreserveCaseKeybinding","ToggleRegexKeybinding","ToggleSearchScopeKeybinding","ToggleWholeWordKeybinding","FindOptionsWidget","FindReplaceState","FindWidget","nls","MenuId","IClipboardService","ContextKeyExpr","IContextKeyService","IContextViewService","IKeybindingService","INotificationService","Severity","IQuickInputService","IStorageService","IThemeService","themeColorFromId","SEARCH_STRING_MAX_LENGTH","getSelectionSearchString","editor","seedSearchStringFromSelection","seedSearchStringFromNonEmptySelection","hasModel","selection","getSelection","startLineNumber","endLineNumber","isEmpty","wordAtPosition","getConfiguredWordAtPosition","getStartPosition","word","getModel","getValueLengthInRange","getValueInRange","CommonFindController","_editor","get","getContribution","ID","constructor","contextKeyService","storageService","clipboardService","notificationService","_findWidgetVisible","bindTo","_contextKeyService","_storageService","_clipboardService","_notificationService","_updateHistoryDelayer","_state","_register","loadQueryState","onFindReplaceStateChange","e","_onStateChanged","_model","onDidChangeModel","shouldRestartFind","isRevealed","disposeModel","change","searchScope","matchCase","getBoolean","wholeWord","isRegex","preserveCase","_start","forceRevealReplace","seedSearchStringFromGlobalClipboard","shouldFocus","shouldAnimate","updateSearchScope","loop","getOption","dispose","saveQueryState","set","reset","searchString","setGlobalBufferTerm","store","actualIsRegex","actualWholeWord","actualMatchCase","actualPreserveCase","isFindInputFocused","getValue","getState","closeFindWidget","focus","toggleCaseSensitive","highlightFindOptions","toggleWholeWords","toggleRegex","togglePreserveCase","toggleSearchScope","selections","getSelections","map","endColumn","setEndPosition","getLineMaxColumn","filter","element","setSearchString","escapeRegExpCharacters","ignoreWhenVisible","opts","newState","stateChanges","selectionSearchString","getGlobalBufferTerm","isReplaceRevealed","currentSelections","some","start","moveToNextMatch","moveToPrevMatch","goToMatch","index","moveToMatch","replace","replaceAll","_a","isTooLargeForHeapOperation","warn","localize","selectAllMatches","globalFindClipboard","isTooLargeForSyncing","readFindText","text","writeFindText","FindController","_contextViewService","_keybindingService","_themeService","_widget","_findOptionsWidget","_createFindWidget","autoFindInSelection","isSelectionMultipleLine","focusReplaceInput","focusFindInput","StartFindAction","id","label","alias","precondition","or","has","kbOpts","kbExpr","primary","weight","menuOpts","menuId","MenubarEditMenu","group","title","comment","order","addImplementation","accessor","args","controller","findArgDescription","description","name","schema","properties","type","replaceString","regex","regexOverride","wholeWordOverride","matchCaseOverride","preserveCaseOverride","findInSelection","StartFindWithArgsAction","StartFindWithArgs","undefined","metadata","run","matchWholeWord","isCaseSensitive","StartFindWithSelectionAction","StartFindWithSelection","mac","MatchFindAction","_run","NextMatchFindAction","secondary","and","result","pushUndoStop","PreviousMatchFindAction","MoveToMatchFindAction","GoToMatchFindAction","_highlightDecorations","matchesCount","notify","severity","Warning","message","quickInputService","inputBox","createInputBox","placeholder","toFindMatchIndex","value","parseInt","isNaN","matchCount","updatePickerAndEditor","validationMessage","currentMatch","addDecorations","clearDecorations","onDidChangeValue","onDidAccept","hide","onDidHide","show","changeDecorations","changeAccessor","deltaDecorations","range","options","className","isWholeLine","overviewRuler","color","position","Full","SelectionMatchFindAction","NextSelectionMatchFindAction","PreviousSelectionMatchFindAction","StartFindReplaceAction","currentSelection","findInputFocused","FindCommand","bindToContribution","CloseFindWidgetCommand","handler","x","not","ToggleCaseSensitiveCommand","win","linux","ToggleWholeWordCommand","ToggleRegexCommand","ToggleSearchScopeCommand","TogglePreserveCaseCommand","ReplaceOneAction","ReplaceAllAction","SelectAllMatchesAction"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/monaco-editor/esm/vs/editor/contrib/find/browser/findController.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar CommonFindController_1;\nimport { Delayer } from '../../../../base/common/async.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditorAction, EditorCommand, MultiEditorAction, registerEditorAction, registerEditorCommand, registerEditorContribution, registerMultiEditorAction } from '../../../browser/editorExtensions.js';\nimport { overviewRulerRangeHighlight } from '../../../common/core/editorColorRegistry.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_FIND_WIDGET_VISIBLE, CONTEXT_REPLACE_INPUT_FOCUSED, FindModelBoundToEditorModel, FIND_IDS, ToggleCaseSensitiveKeybinding, TogglePreserveCaseKeybinding, ToggleRegexKeybinding, ToggleSearchScopeKeybinding, ToggleWholeWordKeybinding } from './findModel.js';\nimport { FindOptionsWidget } from './findOptionsWidget.js';\nimport { FindReplaceState } from './findState.js';\nimport { FindWidget } from './findWidget.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IClipboardService } from '../../../../platform/clipboard/common/clipboardService.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextViewService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\nimport { IThemeService, themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nconst SEARCH_STRING_MAX_LENGTH = 524288;\nexport function getSelectionSearchString(editor, seedSearchStringFromSelection = 'single', seedSearchStringFromNonEmptySelection = false) {\n    if (!editor.hasModel()) {\n        return null;\n    }\n    const selection = editor.getSelection();\n    // if selection spans multiple lines, default search string to empty\n    if ((seedSearchStringFromSelection === 'single' && selection.startLineNumber === selection.endLineNumber)\n        || seedSearchStringFromSelection === 'multiple') {\n        if (selection.isEmpty()) {\n            const wordAtPosition = editor.getConfiguredWordAtPosition(selection.getStartPosition());\n            if (wordAtPosition && (false === seedSearchStringFromNonEmptySelection)) {\n                return wordAtPosition.word;\n            }\n        }\n        else {\n            if (editor.getModel().getValueLengthInRange(selection) < SEARCH_STRING_MAX_LENGTH) {\n                return editor.getModel().getValueInRange(selection);\n            }\n        }\n    }\n    return null;\n}\nlet CommonFindController = CommonFindController_1 = class CommonFindController extends Disposable {\n    get editor() {\n        return this._editor;\n    }\n    static get(editor) {\n        return editor.getContribution(CommonFindController_1.ID);\n    }\n    constructor(editor, contextKeyService, storageService, clipboardService, notificationService) {\n        super();\n        this._editor = editor;\n        this._findWidgetVisible = CONTEXT_FIND_WIDGET_VISIBLE.bindTo(contextKeyService);\n        this._contextKeyService = contextKeyService;\n        this._storageService = storageService;\n        this._clipboardService = clipboardService;\n        this._notificationService = notificationService;\n        this._updateHistoryDelayer = new Delayer(500);\n        this._state = this._register(new FindReplaceState());\n        this.loadQueryState();\n        this._register(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\n        this._model = null;\n        this._register(this._editor.onDidChangeModel(() => {\n            const shouldRestartFind = (this._editor.getModel() && this._state.isRevealed);\n            this.disposeModel();\n            this._state.change({\n                searchScope: null,\n                matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* StorageScope.WORKSPACE */, false),\n                wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* StorageScope.WORKSPACE */, false),\n                isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* StorageScope.WORKSPACE */, false),\n                preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* StorageScope.WORKSPACE */, false)\n            }, false);\n            if (shouldRestartFind) {\n                this._start({\n                    forceRevealReplace: false,\n                    seedSearchStringFromSelection: 'none',\n                    seedSearchStringFromNonEmptySelection: false,\n                    seedSearchStringFromGlobalClipboard: false,\n                    shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                    shouldAnimate: false,\n                    updateSearchScope: false,\n                    loop: this._editor.getOption(41 /* EditorOption.find */).loop\n                });\n            }\n        }));\n    }\n    dispose() {\n        this.disposeModel();\n        super.dispose();\n    }\n    disposeModel() {\n        if (this._model) {\n            this._model.dispose();\n            this._model = null;\n        }\n    }\n    _onStateChanged(e) {\n        this.saveQueryState(e);\n        if (e.isRevealed) {\n            if (this._state.isRevealed) {\n                this._findWidgetVisible.set(true);\n            }\n            else {\n                this._findWidgetVisible.reset();\n                this.disposeModel();\n            }\n        }\n        if (e.searchString) {\n            this.setGlobalBufferTerm(this._state.searchString);\n        }\n    }\n    saveQueryState(e) {\n        if (e.isRegex) {\n            this._storageService.store('editor.isRegex', this._state.actualIsRegex, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n        if (e.wholeWord) {\n            this._storageService.store('editor.wholeWord', this._state.actualWholeWord, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n        if (e.matchCase) {\n            this._storageService.store('editor.matchCase', this._state.actualMatchCase, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n        if (e.preserveCase) {\n            this._storageService.store('editor.preserveCase', this._state.actualPreserveCase, 1 /* StorageScope.WORKSPACE */, 1 /* StorageTarget.MACHINE */);\n        }\n    }\n    loadQueryState() {\n        this._state.change({\n            matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* StorageScope.WORKSPACE */, this._state.matchCase),\n            wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* StorageScope.WORKSPACE */, this._state.wholeWord),\n            isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* StorageScope.WORKSPACE */, this._state.isRegex),\n            preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* StorageScope.WORKSPACE */, this._state.preserveCase)\n        }, false);\n    }\n    isFindInputFocused() {\n        return !!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService);\n    }\n    getState() {\n        return this._state;\n    }\n    closeFindWidget() {\n        this._state.change({\n            isRevealed: false,\n            searchScope: null\n        }, false);\n        this._editor.focus();\n    }\n    toggleCaseSensitive() {\n        this._state.change({ matchCase: !this._state.matchCase }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleWholeWords() {\n        this._state.change({ wholeWord: !this._state.wholeWord }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleRegex() {\n        this._state.change({ isRegex: !this._state.isRegex }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    togglePreserveCase() {\n        this._state.change({ preserveCase: !this._state.preserveCase }, false);\n        if (!this._state.isRevealed) {\n            this.highlightFindOptions();\n        }\n    }\n    toggleSearchScope() {\n        if (this._state.searchScope) {\n            this._state.change({ searchScope: null }, true);\n        }\n        else {\n            if (this._editor.hasModel()) {\n                const selections = this._editor.getSelections();\n                selections.map(selection => {\n                    if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n                        selection = selection.setEndPosition(selection.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n                    }\n                    if (!selection.isEmpty()) {\n                        return selection;\n                    }\n                    return null;\n                }).filter(element => !!element);\n                if (selections.length) {\n                    this._state.change({ searchScope: selections }, true);\n                }\n            }\n        }\n    }\n    setSearchString(searchString) {\n        if (this._state.isRegex) {\n            searchString = strings.escapeRegExpCharacters(searchString);\n        }\n        this._state.change({ searchString: searchString }, false);\n    }\n    highlightFindOptions(ignoreWhenVisible = false) {\n        // overwritten in subclass\n    }\n    async _start(opts, newState) {\n        this.disposeModel();\n        if (!this._editor.hasModel()) {\n            // cannot do anything with an editor that doesn't have a model...\n            return;\n        }\n        const stateChanges = {\n            ...newState,\n            isRevealed: true\n        };\n        if (opts.seedSearchStringFromSelection === 'single') {\n            const selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection, opts.seedSearchStringFromNonEmptySelection);\n            if (selectionSearchString) {\n                if (this._state.isRegex) {\n                    stateChanges.searchString = strings.escapeRegExpCharacters(selectionSearchString);\n                }\n                else {\n                    stateChanges.searchString = selectionSearchString;\n                }\n            }\n        }\n        else if (opts.seedSearchStringFromSelection === 'multiple' && !opts.updateSearchScope) {\n            const selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection);\n            if (selectionSearchString) {\n                stateChanges.searchString = selectionSearchString;\n            }\n        }\n        if (!stateChanges.searchString && opts.seedSearchStringFromGlobalClipboard) {\n            const selectionSearchString = await this.getGlobalBufferTerm();\n            if (!this._editor.hasModel()) {\n                // the editor has lost its model in the meantime\n                return;\n            }\n            if (selectionSearchString) {\n                stateChanges.searchString = selectionSearchString;\n            }\n        }\n        // Overwrite isReplaceRevealed\n        if (opts.forceRevealReplace || stateChanges.isReplaceRevealed) {\n            stateChanges.isReplaceRevealed = true;\n        }\n        else if (!this._findWidgetVisible.get()) {\n            stateChanges.isReplaceRevealed = false;\n        }\n        if (opts.updateSearchScope) {\n            const currentSelections = this._editor.getSelections();\n            if (currentSelections.some(selection => !selection.isEmpty())) {\n                stateChanges.searchScope = currentSelections;\n            }\n        }\n        stateChanges.loop = opts.loop;\n        this._state.change(stateChanges, false);\n        if (!this._model) {\n            this._model = new FindModelBoundToEditorModel(this._editor, this._state);\n        }\n    }\n    start(opts, newState) {\n        return this._start(opts, newState);\n    }\n    moveToNextMatch() {\n        if (this._model) {\n            this._model.moveToNextMatch();\n            return true;\n        }\n        return false;\n    }\n    moveToPrevMatch() {\n        if (this._model) {\n            this._model.moveToPrevMatch();\n            return true;\n        }\n        return false;\n    }\n    goToMatch(index) {\n        if (this._model) {\n            this._model.moveToMatch(index);\n            return true;\n        }\n        return false;\n    }\n    replace() {\n        if (this._model) {\n            this._model.replace();\n            return true;\n        }\n        return false;\n    }\n    replaceAll() {\n        var _a;\n        if (this._model) {\n            if ((_a = this._editor.getModel()) === null || _a === void 0 ? void 0 : _a.isTooLargeForHeapOperation()) {\n                this._notificationService.warn(nls.localize('too.large.for.replaceall', \"The file is too large to perform a replace all operation.\"));\n                return false;\n            }\n            this._model.replaceAll();\n            return true;\n        }\n        return false;\n    }\n    selectAllMatches() {\n        if (this._model) {\n            this._model.selectAllMatches();\n            this._editor.focus();\n            return true;\n        }\n        return false;\n    }\n    async getGlobalBufferTerm() {\n        if (this._editor.getOption(41 /* EditorOption.find */).globalFindClipboard\n            && this._editor.hasModel()\n            && !this._editor.getModel().isTooLargeForSyncing()) {\n            return this._clipboardService.readFindText();\n        }\n        return '';\n    }\n    setGlobalBufferTerm(text) {\n        if (this._editor.getOption(41 /* EditorOption.find */).globalFindClipboard\n            && this._editor.hasModel()\n            && !this._editor.getModel().isTooLargeForSyncing()) {\n            // intentionally not awaited\n            this._clipboardService.writeFindText(text);\n        }\n    }\n};\nCommonFindController.ID = 'editor.contrib.findController';\nCommonFindController = CommonFindController_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IStorageService),\n    __param(3, IClipboardService),\n    __param(4, INotificationService)\n], CommonFindController);\nexport { CommonFindController };\nlet FindController = class FindController extends CommonFindController {\n    constructor(editor, _contextViewService, _contextKeyService, _keybindingService, _themeService, notificationService, _storageService, clipboardService) {\n        super(editor, _contextKeyService, _storageService, clipboardService, notificationService);\n        this._contextViewService = _contextViewService;\n        this._keybindingService = _keybindingService;\n        this._themeService = _themeService;\n        this._widget = null;\n        this._findOptionsWidget = null;\n    }\n    async _start(opts, newState) {\n        if (!this._widget) {\n            this._createFindWidget();\n        }\n        const selection = this._editor.getSelection();\n        let updateSearchScope = false;\n        switch (this._editor.getOption(41 /* EditorOption.find */).autoFindInSelection) {\n            case 'always':\n                updateSearchScope = true;\n                break;\n            case 'never':\n                updateSearchScope = false;\n                break;\n            case 'multiline': {\n                const isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\n                updateSearchScope = isSelectionMultipleLine;\n                break;\n            }\n            default:\n                break;\n        }\n        opts.updateSearchScope = opts.updateSearchScope || updateSearchScope;\n        await super._start(opts, newState);\n        if (this._widget) {\n            if (opts.shouldFocus === 2 /* FindStartFocusAction.FocusReplaceInput */) {\n                this._widget.focusReplaceInput();\n            }\n            else if (opts.shouldFocus === 1 /* FindStartFocusAction.FocusFindInput */) {\n                this._widget.focusFindInput();\n            }\n        }\n    }\n    highlightFindOptions(ignoreWhenVisible = false) {\n        if (!this._widget) {\n            this._createFindWidget();\n        }\n        if (this._state.isRevealed && !ignoreWhenVisible) {\n            this._widget.highlightFindOptions();\n        }\n        else {\n            this._findOptionsWidget.highlightFindOptions();\n        }\n    }\n    _createFindWidget() {\n        this._widget = this._register(new FindWidget(this._editor, this, this._state, this._contextViewService, this._keybindingService, this._contextKeyService, this._themeService, this._storageService, this._notificationService));\n        this._findOptionsWidget = this._register(new FindOptionsWidget(this._editor, this._state, this._keybindingService));\n    }\n};\nFindController = __decorate([\n    __param(1, IContextViewService),\n    __param(2, IContextKeyService),\n    __param(3, IKeybindingService),\n    __param(4, IThemeService),\n    __param(5, INotificationService),\n    __param(6, IStorageService),\n    __param(7, IClipboardService)\n], FindController);\nexport { FindController };\nexport const StartFindAction = registerMultiEditorAction(new MultiEditorAction({\n    id: FIND_IDS.StartFindAction,\n    label: nls.localize('startFindAction', \"Find\"),\n    alias: 'Find',\n    precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\n    kbOpts: {\n        kbExpr: null,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */,\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    },\n    menuOpts: {\n        menuId: MenuId.MenubarEditMenu,\n        group: '3_find',\n        title: nls.localize({ key: 'miFind', comment: ['&& denotes a mnemonic'] }, \"&&Find\"),\n        order: 1\n    }\n}));\nStartFindAction.addImplementation(0, (accessor, editor, args) => {\n    const controller = CommonFindController.get(editor);\n    if (!controller) {\n        return false;\n    }\n    return controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n        seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n        seedSearchStringFromGlobalClipboard: editor.getOption(41 /* EditorOption.find */).globalFindClipboard,\n        shouldFocus: 1 /* FindStartFocusAction.FocusFindInput */,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(41 /* EditorOption.find */).loop\n    });\n});\nconst findArgDescription = {\n    description: 'Open a new In-Editor Find Widget.',\n    args: [{\n            name: 'Open a new In-Editor Find Widget args',\n            schema: {\n                properties: {\n                    searchString: { type: 'string' },\n                    replaceString: { type: 'string' },\n                    regex: { type: 'boolean' },\n                    regexOverride: {\n                        type: 'number',\n                        description: nls.localize('actions.find.isRegexOverride', 'Overrides \"Use Regular Expression\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n                    },\n                    wholeWord: { type: 'boolean' },\n                    wholeWordOverride: {\n                        type: 'number',\n                        description: nls.localize('actions.find.wholeWordOverride', 'Overrides \"Match Whole Word\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n                    },\n                    matchCase: { type: 'boolean' },\n                    matchCaseOverride: {\n                        type: 'number',\n                        description: nls.localize('actions.find.matchCaseOverride', 'Overrides \"Math Case\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n                    },\n                    preserveCase: { type: 'boolean' },\n                    preserveCaseOverride: {\n                        type: 'number',\n                        description: nls.localize('actions.find.preserveCaseOverride', 'Overrides \"Preserve Case\" flag.\\nThe flag will not be saved for the future.\\n0: Do Nothing\\n1: True\\n2: False')\n                    },\n                    findInSelection: { type: 'boolean' },\n                }\n            }\n        }]\n};\nexport class StartFindWithArgsAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.StartFindWithArgs,\n            label: nls.localize('startFindWithArgsAction', \"Find With Arguments\"),\n            alias: 'Find With Arguments',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: null,\n                primary: 0,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: findArgDescription\n        });\n    }\n    async run(accessor, editor, args) {\n        const controller = CommonFindController.get(editor);\n        if (controller) {\n            const newState = args ? {\n                searchString: args.searchString,\n                replaceString: args.replaceString,\n                isReplaceRevealed: args.replaceString !== undefined,\n                isRegex: args.isRegex,\n                // isRegexOverride: args.regexOverride,\n                wholeWord: args.matchWholeWord,\n                // wholeWordOverride: args.wholeWordOverride,\n                matchCase: args.isCaseSensitive,\n                // matchCaseOverride: args.matchCaseOverride,\n                preserveCase: args.preserveCase,\n                // preserveCaseOverride: args.preserveCaseOverride,\n            } : {};\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n                seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n                seedSearchStringFromGlobalClipboard: true,\n                shouldFocus: 1 /* FindStartFocusAction.FocusFindInput */,\n                shouldAnimate: true,\n                updateSearchScope: (args === null || args === void 0 ? void 0 : args.findInSelection) || false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            }, newState);\n            controller.setGlobalBufferTerm(controller.getState().searchString);\n        }\n    }\n}\nexport class StartFindWithSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.StartFindWithSelection,\n            label: nls.localize('startFindWithSelectionAction', \"Find With Selection\"),\n            alias: 'Find With Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: null,\n                primary: 0,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 35 /* KeyCode.KeyE */,\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    async run(accessor, editor) {\n        const controller = CommonFindController.get(editor);\n        if (controller) {\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: 'multiple',\n                seedSearchStringFromNonEmptySelection: false,\n                seedSearchStringFromGlobalClipboard: false,\n                shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                shouldAnimate: true,\n                updateSearchScope: false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            });\n            controller.setGlobalBufferTerm(controller.getState().searchString);\n        }\n    }\n}\nexport class MatchFindAction extends EditorAction {\n    async run(accessor, editor) {\n        const controller = CommonFindController.get(editor);\n        if (controller && !this._run(controller)) {\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\n                seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n                seedSearchStringFromGlobalClipboard: true,\n                shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                shouldAnimate: true,\n                updateSearchScope: false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            });\n            this._run(controller);\n        }\n    }\n}\nexport class NextMatchFindAction extends MatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.NextMatchFindAction,\n            label: nls.localize('findNextMatchAction', \"Find Next\"),\n            alias: 'Find Next',\n            precondition: undefined,\n            kbOpts: [{\n                    kbExpr: EditorContextKeys.focus,\n                    primary: 61 /* KeyCode.F3 */,\n                    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 37 /* KeyCode.KeyG */, secondary: [61 /* KeyCode.F3 */] },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }, {\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n                    primary: 3 /* KeyCode.Enter */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }]\n        });\n    }\n    _run(controller) {\n        const result = controller.moveToNextMatch();\n        if (result) {\n            controller.editor.pushUndoStop();\n            return true;\n        }\n        return false;\n    }\n}\nexport class PreviousMatchFindAction extends MatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.PreviousMatchFindAction,\n            label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\n            alias: 'Find Previous',\n            precondition: undefined,\n            kbOpts: [{\n                    kbExpr: EditorContextKeys.focus,\n                    primary: 1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */,\n                    mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 37 /* KeyCode.KeyG */, secondary: [1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */] },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }, {\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n                    primary: 1024 /* KeyMod.Shift */ | 3 /* KeyCode.Enter */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }\n            ]\n        });\n    }\n    _run(controller) {\n        return controller.moveToPrevMatch();\n    }\n}\nexport class MoveToMatchFindAction extends EditorAction {\n    constructor() {\n        super({\n            id: FIND_IDS.GoToMatchFindAction,\n            label: nls.localize('findMatchAction.goToMatch', \"Go to Match...\"),\n            alias: 'Go to Match...',\n            precondition: CONTEXT_FIND_WIDGET_VISIBLE\n        });\n        this._highlightDecorations = [];\n    }\n    run(accessor, editor, args) {\n        const controller = CommonFindController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const matchesCount = controller.getState().matchesCount;\n        if (matchesCount < 1) {\n            const notificationService = accessor.get(INotificationService);\n            notificationService.notify({\n                severity: Severity.Warning,\n                message: nls.localize('findMatchAction.noResults', \"No matches. Try searching for something else.\")\n            });\n            return;\n        }\n        const quickInputService = accessor.get(IQuickInputService);\n        const inputBox = quickInputService.createInputBox();\n        inputBox.placeholder = nls.localize('findMatchAction.inputPlaceHolder', \"Type a number to go to a specific match (between 1 and {0})\", matchesCount);\n        const toFindMatchIndex = (value) => {\n            const index = parseInt(value);\n            if (isNaN(index)) {\n                return undefined;\n            }\n            const matchCount = controller.getState().matchesCount;\n            if (index > 0 && index <= matchCount) {\n                return index - 1; // zero based\n            }\n            else if (index < 0 && index >= -matchCount) {\n                return matchCount + index;\n            }\n            return undefined;\n        };\n        const updatePickerAndEditor = (value) => {\n            const index = toFindMatchIndex(value);\n            if (typeof index === 'number') {\n                // valid\n                inputBox.validationMessage = undefined;\n                controller.goToMatch(index);\n                const currentMatch = controller.getState().currentMatch;\n                if (currentMatch) {\n                    this.addDecorations(editor, currentMatch);\n                }\n            }\n            else {\n                inputBox.validationMessage = nls.localize('findMatchAction.inputValidationMessage', \"Please type a number between 1 and {0}\", controller.getState().matchesCount);\n                this.clearDecorations(editor);\n            }\n        };\n        inputBox.onDidChangeValue(value => {\n            updatePickerAndEditor(value);\n        });\n        inputBox.onDidAccept(() => {\n            const index = toFindMatchIndex(inputBox.value);\n            if (typeof index === 'number') {\n                controller.goToMatch(index);\n                inputBox.hide();\n            }\n            else {\n                inputBox.validationMessage = nls.localize('findMatchAction.inputValidationMessage', \"Please type a number between 1 and {0}\", controller.getState().matchesCount);\n            }\n        });\n        inputBox.onDidHide(() => {\n            this.clearDecorations(editor);\n            inputBox.dispose();\n        });\n        inputBox.show();\n    }\n    clearDecorations(editor) {\n        editor.changeDecorations(changeAccessor => {\n            this._highlightDecorations = changeAccessor.deltaDecorations(this._highlightDecorations, []);\n        });\n    }\n    addDecorations(editor, range) {\n        editor.changeDecorations(changeAccessor => {\n            this._highlightDecorations = changeAccessor.deltaDecorations(this._highlightDecorations, [\n                {\n                    range,\n                    options: {\n                        description: 'find-match-quick-access-range-highlight',\n                        className: 'rangeHighlight',\n                        isWholeLine: true\n                    }\n                },\n                {\n                    range,\n                    options: {\n                        description: 'find-match-quick-access-range-highlight-overview',\n                        overviewRuler: {\n                            color: themeColorFromId(overviewRulerRangeHighlight),\n                            position: OverviewRulerLane.Full\n                        }\n                    }\n                }\n            ]);\n        });\n    }\n}\nexport class SelectionMatchFindAction extends EditorAction {\n    async run(accessor, editor) {\n        const controller = CommonFindController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const selectionSearchString = getSelectionSearchString(editor, 'single', false);\n        if (selectionSearchString) {\n            controller.setSearchString(selectionSearchString);\n        }\n        if (!this._run(controller)) {\n            await controller.start({\n                forceRevealReplace: false,\n                seedSearchStringFromSelection: 'none',\n                seedSearchStringFromNonEmptySelection: false,\n                seedSearchStringFromGlobalClipboard: false,\n                shouldFocus: 0 /* FindStartFocusAction.NoFocusChange */,\n                shouldAnimate: true,\n                updateSearchScope: false,\n                loop: editor.getOption(41 /* EditorOption.find */).loop\n            });\n            this._run(controller);\n        }\n    }\n}\nexport class NextSelectionMatchFindAction extends SelectionMatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.NextSelectionMatchFindAction,\n            label: nls.localize('nextSelectionMatchFindAction', \"Find Next Selection\"),\n            alias: 'Find Next Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 61 /* KeyCode.F3 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(controller) {\n        return controller.moveToNextMatch();\n    }\n}\nexport class PreviousSelectionMatchFindAction extends SelectionMatchFindAction {\n    constructor() {\n        super({\n            id: FIND_IDS.PreviousSelectionMatchFindAction,\n            label: nls.localize('previousSelectionMatchFindAction', \"Find Previous Selection\"),\n            alias: 'Find Previous Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 61 /* KeyCode.F3 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    _run(controller) {\n        return controller.moveToPrevMatch();\n    }\n}\nexport const StartFindReplaceAction = registerMultiEditorAction(new MultiEditorAction({\n    id: FIND_IDS.StartFindReplaceAction,\n    label: nls.localize('startReplace', \"Replace\"),\n    alias: 'Replace',\n    precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\n    kbOpts: {\n        kbExpr: null,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 38 /* KeyCode.KeyH */,\n        mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */ },\n        weight: 100 /* KeybindingWeight.EditorContrib */\n    },\n    menuOpts: {\n        menuId: MenuId.MenubarEditMenu,\n        group: '3_find',\n        title: nls.localize({ key: 'miReplace', comment: ['&& denotes a mnemonic'] }, \"&&Replace\"),\n        order: 2\n    }\n}));\nStartFindReplaceAction.addImplementation(0, (accessor, editor, args) => {\n    if (!editor.hasModel() || editor.getOption(90 /* EditorOption.readOnly */)) {\n        return false;\n    }\n    const controller = CommonFindController.get(editor);\n    if (!controller) {\n        return false;\n    }\n    const currentSelection = editor.getSelection();\n    const findInputFocused = controller.isFindInputFocused();\n    // we only seed search string from selection when the current selection is single line and not empty,\n    // + the find input is not focused\n    const seedSearchStringFromSelection = !currentSelection.isEmpty()\n        && currentSelection.startLineNumber === currentSelection.endLineNumber\n        && (editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never')\n        && !findInputFocused;\n    /*\n    * if the existing search string in find widget is empty and we don't seed search string from selection, it means the Find Input is still empty, so we should focus the Find Input instead of Replace Input.\n\n    * findInputFocused true -> seedSearchStringFromSelection false, FocusReplaceInput\n    * findInputFocused false, seedSearchStringFromSelection true FocusReplaceInput\n    * findInputFocused false seedSearchStringFromSelection false FocusFindInput\n    */\n    const shouldFocus = (findInputFocused || seedSearchStringFromSelection) ?\n        2 /* FindStartFocusAction.FocusReplaceInput */ : 1 /* FindStartFocusAction.FocusFindInput */;\n    return controller.start({\n        forceRevealReplace: true,\n        seedSearchStringFromSelection: seedSearchStringFromSelection ? 'single' : 'none',\n        seedSearchStringFromNonEmptySelection: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection === 'selection',\n        seedSearchStringFromGlobalClipboard: editor.getOption(41 /* EditorOption.find */).seedSearchStringFromSelection !== 'never',\n        shouldFocus: shouldFocus,\n        shouldAnimate: true,\n        updateSearchScope: false,\n        loop: editor.getOption(41 /* EditorOption.find */).loop\n    });\n});\nregisterEditorContribution(CommonFindController.ID, FindController, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(StartFindWithArgsAction);\nregisterEditorAction(StartFindWithSelectionAction);\nregisterEditorAction(NextMatchFindAction);\nregisterEditorAction(PreviousMatchFindAction);\nregisterEditorAction(MoveToMatchFindAction);\nregisterEditorAction(NextSelectionMatchFindAction);\nregisterEditorAction(PreviousSelectionMatchFindAction);\nconst FindCommand = EditorCommand.bindToContribution(CommonFindController.get);\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.CloseFindWidgetCommand,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.closeFindWidget(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleCaseSensitiveCommand,\n    precondition: undefined,\n    handler: x => x.toggleCaseSensitive(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleCaseSensitiveKeybinding.primary,\n        mac: ToggleCaseSensitiveKeybinding.mac,\n        win: ToggleCaseSensitiveKeybinding.win,\n        linux: ToggleCaseSensitiveKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleWholeWordCommand,\n    precondition: undefined,\n    handler: x => x.toggleWholeWords(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleWholeWordKeybinding.primary,\n        mac: ToggleWholeWordKeybinding.mac,\n        win: ToggleWholeWordKeybinding.win,\n        linux: ToggleWholeWordKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleRegexCommand,\n    precondition: undefined,\n    handler: x => x.toggleRegex(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleRegexKeybinding.primary,\n        mac: ToggleRegexKeybinding.mac,\n        win: ToggleRegexKeybinding.win,\n        linux: ToggleRegexKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ToggleSearchScopeCommand,\n    precondition: undefined,\n    handler: x => x.toggleSearchScope(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: ToggleSearchScopeKeybinding.primary,\n        mac: ToggleSearchScopeKeybinding.mac,\n        win: ToggleSearchScopeKeybinding.win,\n        linux: ToggleSearchScopeKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.TogglePreserveCaseCommand,\n    precondition: undefined,\n    handler: x => x.togglePreserveCase(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: TogglePreserveCaseKeybinding.primary,\n        mac: TogglePreserveCaseKeybinding.mac,\n        win: TogglePreserveCaseKeybinding.win,\n        linux: TogglePreserveCaseKeybinding.linux\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceOneAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replace(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 22 /* KeyCode.Digit1 */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceOneAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replace(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n        primary: 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceAllAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replaceAll(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.ReplaceAllAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.replaceAll(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n        primary: undefined,\n        mac: {\n            primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n        }\n    }\n}));\nregisterEditorCommand(new FindCommand({\n    id: FIND_IDS.SelectAllMatchesAction,\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n    handler: x => x.selectAllMatches(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 5,\n        kbExpr: EditorContextKeys.focus,\n        primary: 512 /* KeyMod.Alt */ | 3 /* KeyCode.Enter */\n    }\n}));\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,IAAIA,UAAU,GAAI,IAAI,IAAI,IAAI,CAACA,UAAU,IAAK,UAAUC,UAAU,EAAEC,MAAM,EAAEC,GAAG,EAAEC,IAAI,EAAE;EACnF,IAAIC,CAAC,GAAGC,SAAS,CAACC,MAAM;IAAEC,CAAC,GAAGH,CAAC,GAAG,CAAC,GAAGH,MAAM,GAAGE,IAAI,KAAK,IAAI,GAAGA,IAAI,GAAGK,MAAM,CAACC,wBAAwB,CAACR,MAAM,EAAEC,GAAG,CAAC,GAAGC,IAAI;IAAEO,CAAC;EAC5H,IAAI,OAAOC,OAAO,KAAK,QAAQ,IAAI,OAAOA,OAAO,CAACC,QAAQ,KAAK,UAAU,EAAEL,CAAC,GAAGI,OAAO,CAACC,QAAQ,CAACZ,UAAU,EAAEC,MAAM,EAAEC,GAAG,EAAEC,IAAI,CAAC,CAAC,KAC1H,KAAK,IAAIU,CAAC,GAAGb,UAAU,CAACM,MAAM,GAAG,CAAC,EAAEO,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE,IAAIH,CAAC,GAAGV,UAAU,CAACa,CAAC,CAAC,EAAEN,CAAC,GAAG,CAACH,CAAC,GAAG,CAAC,GAAGM,CAAC,CAACH,CAAC,CAAC,GAAGH,CAAC,GAAG,CAAC,GAAGM,CAAC,CAACT,MAAM,EAAEC,GAAG,EAAEK,CAAC,CAAC,GAAGG,CAAC,CAACT,MAAM,EAAEC,GAAG,CAAC,KAAKK,CAAC;EACjJ,OAAOH,CAAC,GAAG,CAAC,IAAIG,CAAC,IAAIC,MAAM,CAACM,cAAc,CAACb,MAAM,EAAEC,GAAG,EAAEK,CAAC,CAAC,EAAEA,CAAC;AACjE,CAAC;AACD,IAAIQ,OAAO,GAAI,IAAI,IAAI,IAAI,CAACA,OAAO,IAAK,UAAUC,UAAU,EAAEC,SAAS,EAAE;EACrE,OAAO,UAAUhB,MAAM,EAAEC,GAAG,EAAE;IAAEe,SAAS,CAAChB,MAAM,EAAEC,GAAG,EAAEc,UAAU,CAAC;EAAE,CAAC;AACzE,CAAC;AACD,IAAIE,sBAAsB;AAC1B,SAASC,OAAO,QAAQ,kCAAkC;AAC1D,SAASC,UAAU,QAAQ,sCAAsC;AACjE,OAAO,KAAKC,OAAO,MAAM,oCAAoC;AAC7D,SAASC,YAAY,EAAEC,aAAa,EAAEC,iBAAiB,EAAEC,oBAAoB,EAAEC,qBAAqB,EAAEC,0BAA0B,EAAEC,yBAAyB,QAAQ,sCAAsC;AACzM,SAASC,2BAA2B,QAAQ,6CAA6C;AACzF,SAASC,iBAAiB,QAAQ,sCAAsC;AACxE,SAASC,iBAAiB,QAAQ,0BAA0B;AAC5D,SAASC,0BAA0B,EAAEC,2BAA2B,EAAEC,6BAA6B,EAAEC,2BAA2B,EAAEC,QAAQ,EAAEC,6BAA6B,EAAEC,4BAA4B,EAAEC,qBAAqB,EAAEC,2BAA2B,EAAEC,yBAAyB,QAAQ,gBAAgB;AAC1S,SAASC,iBAAiB,QAAQ,wBAAwB;AAC1D,SAASC,gBAAgB,QAAQ,gBAAgB;AACjD,SAASC,UAAU,QAAQ,iBAAiB;AAC5C,OAAO,KAAKC,GAAG,MAAM,oBAAoB;AACzC,SAASC,MAAM,QAAQ,gDAAgD;AACvE,SAASC,iBAAiB,QAAQ,2DAA2D;AAC7F,SAASC,cAAc,EAAEC,kBAAkB,QAAQ,sDAAsD;AACzG,SAASC,mBAAmB,QAAQ,yDAAyD;AAC7F,SAASC,kBAAkB,QAAQ,sDAAsD;AACzF,SAASC,oBAAoB,EAAEC,QAAQ,QAAQ,0DAA0D;AACzG,SAASC,kBAAkB,QAAQ,sDAAsD;AACzF,SAASC,eAAe,QAAQ,gDAAgD;AAChF,SAASC,aAAa,EAAEC,gBAAgB,QAAQ,mDAAmD;AACnG,MAAMC,wBAAwB,GAAG,MAAM;AACvC,OAAO,SAASC,wBAAwBA,CAACC,MAAM,EAAEC,6BAA6B,GAAG,QAAQ,EAAEC,qCAAqC,GAAG,KAAK,EAAE;EACtI,IAAI,CAACF,MAAM,CAACG,QAAQ,CAAC,CAAC,EAAE;IACpB,OAAO,IAAI;EACf;EACA,MAAMC,SAAS,GAAGJ,MAAM,CAACK,YAAY,CAAC,CAAC;EACvC;EACA,IAAKJ,6BAA6B,KAAK,QAAQ,IAAIG,SAAS,CAACE,eAAe,KAAKF,SAAS,CAACG,aAAa,IACjGN,6BAA6B,KAAK,UAAU,EAAE;IACjD,IAAIG,SAAS,CAACI,OAAO,CAAC,CAAC,EAAE;MACrB,MAAMC,cAAc,GAAGT,MAAM,CAACU,2BAA2B,CAACN,SAAS,CAACO,gBAAgB,CAAC,CAAC,CAAC;MACvF,IAAIF,cAAc,IAAK,KAAK,KAAKP,qCAAsC,EAAE;QACrE,OAAOO,cAAc,CAACG,IAAI;MAC9B;IACJ,CAAC,MACI;MACD,IAAIZ,MAAM,CAACa,QAAQ,CAAC,CAAC,CAACC,qBAAqB,CAACV,SAAS,CAAC,GAAGN,wBAAwB,EAAE;QAC/E,OAAOE,MAAM,CAACa,QAAQ,CAAC,CAAC,CAACE,eAAe,CAACX,SAAS,CAAC;MACvD;IACJ;EACJ;EACA,OAAO,IAAI;AACf;AACA,IAAIY,oBAAoB,GAAG1D,sBAAsB,GAAG,MAAM0D,oBAAoB,SAASxD,UAAU,CAAC;EAC9F,IAAIwC,MAAMA,CAAA,EAAG;IACT,OAAO,IAAI,CAACiB,OAAO;EACvB;EACA,OAAOC,GAAGA,CAAClB,MAAM,EAAE;IACf,OAAOA,MAAM,CAACmB,eAAe,CAAC7D,sBAAsB,CAAC8D,EAAE,CAAC;EAC5D;EACAC,WAAWA,CAACrB,MAAM,EAAEsB,iBAAiB,EAAEC,cAAc,EAAEC,gBAAgB,EAAEC,mBAAmB,EAAE;IAC1F,KAAK,CAAC,CAAC;IACP,IAAI,CAACR,OAAO,GAAGjB,MAAM;IACrB,IAAI,CAAC0B,kBAAkB,GAAGrD,2BAA2B,CAACsD,MAAM,CAACL,iBAAiB,CAAC;IAC/E,IAAI,CAACM,kBAAkB,GAAGN,iBAAiB;IAC3C,IAAI,CAACO,eAAe,GAAGN,cAAc;IACrC,IAAI,CAACO,iBAAiB,GAAGN,gBAAgB;IACzC,IAAI,CAACO,oBAAoB,GAAGN,mBAAmB;IAC/C,IAAI,CAACO,qBAAqB,GAAG,IAAIzE,OAAO,CAAC,GAAG,CAAC;IAC7C,IAAI,CAAC0E,MAAM,GAAG,IAAI,CAACC,SAAS,CAAC,IAAInD,gBAAgB,CAAC,CAAC,CAAC;IACpD,IAAI,CAACoD,cAAc,CAAC,CAAC;IACrB,IAAI,CAACD,SAAS,CAAC,IAAI,CAACD,MAAM,CAACG,wBAAwB,CAAEC,CAAC,IAAK,IAAI,CAACC,eAAe,CAACD,CAAC,CAAC,CAAC,CAAC;IACpF,IAAI,CAACE,MAAM,GAAG,IAAI;IAClB,IAAI,CAACL,SAAS,CAAC,IAAI,CAACjB,OAAO,CAACuB,gBAAgB,CAAC,MAAM;MAC/C,MAAMC,iBAAiB,GAAI,IAAI,CAACxB,OAAO,CAACJ,QAAQ,CAAC,CAAC,IAAI,IAAI,CAACoB,MAAM,CAACS,UAAW;MAC7E,IAAI,CAACC,YAAY,CAAC,CAAC;MACnB,IAAI,CAACV,MAAM,CAACW,MAAM,CAAC;QACfC,WAAW,EAAE,IAAI;QACjBC,SAAS,EAAE,IAAI,CAACjB,eAAe,CAACkB,UAAU,CAAC,kBAAkB,EAAE,CAAC,CAAC,8BAA8B,KAAK,CAAC;QACrGC,SAAS,EAAE,IAAI,CAACnB,eAAe,CAACkB,UAAU,CAAC,kBAAkB,EAAE,CAAC,CAAC,8BAA8B,KAAK,CAAC;QACrGE,OAAO,EAAE,IAAI,CAACpB,eAAe,CAACkB,UAAU,CAAC,gBAAgB,EAAE,CAAC,CAAC,8BAA8B,KAAK,CAAC;QACjGG,YAAY,EAAE,IAAI,CAACrB,eAAe,CAACkB,UAAU,CAAC,qBAAqB,EAAE,CAAC,CAAC,8BAA8B,KAAK;MAC9G,CAAC,EAAE,KAAK,CAAC;MACT,IAAIN,iBAAiB,EAAE;QACnB,IAAI,CAACU,MAAM,CAAC;UACRC,kBAAkB,EAAE,KAAK;UACzBnD,6BAA6B,EAAE,MAAM;UACrCC,qCAAqC,EAAE,KAAK;UAC5CmD,mCAAmC,EAAE,KAAK;UAC1CC,WAAW,EAAE,CAAC,CAAC;UACfC,aAAa,EAAE,KAAK;UACpBC,iBAAiB,EAAE,KAAK;UACxBC,IAAI,EAAE,IAAI,CAACxC,OAAO,CAACyC,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACD;QAC7D,CAAC,CAAC;MACN;IACJ,CAAC,CAAC,CAAC;EACP;EACAE,OAAOA,CAAA,EAAG;IACN,IAAI,CAAChB,YAAY,CAAC,CAAC;IACnB,KAAK,CAACgB,OAAO,CAAC,CAAC;EACnB;EACAhB,YAAYA,CAAA,EAAG;IACX,IAAI,IAAI,CAACJ,MAAM,EAAE;MACb,IAAI,CAACA,MAAM,CAACoB,OAAO,CAAC,CAAC;MACrB,IAAI,CAACpB,MAAM,GAAG,IAAI;IACtB;EACJ;EACAD,eAAeA,CAACD,CAAC,EAAE;IACf,IAAI,CAACuB,cAAc,CAACvB,CAAC,CAAC;IACtB,IAAIA,CAAC,CAACK,UAAU,EAAE;MACd,IAAI,IAAI,CAACT,MAAM,CAACS,UAAU,EAAE;QACxB,IAAI,CAAChB,kBAAkB,CAACmC,GAAG,CAAC,IAAI,CAAC;MACrC,CAAC,MACI;QACD,IAAI,CAACnC,kBAAkB,CAACoC,KAAK,CAAC,CAAC;QAC/B,IAAI,CAACnB,YAAY,CAAC,CAAC;MACvB;IACJ;IACA,IAAIN,CAAC,CAAC0B,YAAY,EAAE;MAChB,IAAI,CAACC,mBAAmB,CAAC,IAAI,CAAC/B,MAAM,CAAC8B,YAAY,CAAC;IACtD;EACJ;EACAH,cAAcA,CAACvB,CAAC,EAAE;IACd,IAAIA,CAAC,CAACY,OAAO,EAAE;MACX,IAAI,CAACpB,eAAe,CAACoC,KAAK,CAAC,gBAAgB,EAAE,IAAI,CAAChC,MAAM,CAACiC,aAAa,EAAE,CAAC,CAAC,8BAA8B,CAAC,CAAC,2BAA2B,CAAC;IAC1I;IACA,IAAI7B,CAAC,CAACW,SAAS,EAAE;MACb,IAAI,CAACnB,eAAe,CAACoC,KAAK,CAAC,kBAAkB,EAAE,IAAI,CAAChC,MAAM,CAACkC,eAAe,EAAE,CAAC,CAAC,8BAA8B,CAAC,CAAC,2BAA2B,CAAC;IAC9I;IACA,IAAI9B,CAAC,CAACS,SAAS,EAAE;MACb,IAAI,CAACjB,eAAe,CAACoC,KAAK,CAAC,kBAAkB,EAAE,IAAI,CAAChC,MAAM,CAACmC,eAAe,EAAE,CAAC,CAAC,8BAA8B,CAAC,CAAC,2BAA2B,CAAC;IAC9I;IACA,IAAI/B,CAAC,CAACa,YAAY,EAAE;MAChB,IAAI,CAACrB,eAAe,CAACoC,KAAK,CAAC,qBAAqB,EAAE,IAAI,CAAChC,MAAM,CAACoC,kBAAkB,EAAE,CAAC,CAAC,8BAA8B,CAAC,CAAC,2BAA2B,CAAC;IACpJ;EACJ;EACAlC,cAAcA,CAAA,EAAG;IACb,IAAI,CAACF,MAAM,CAACW,MAAM,CAAC;MACfE,SAAS,EAAE,IAAI,CAACjB,eAAe,CAACkB,UAAU,CAAC,kBAAkB,EAAE,CAAC,CAAC,8BAA8B,IAAI,CAACd,MAAM,CAACa,SAAS,CAAC;MACrHE,SAAS,EAAE,IAAI,CAACnB,eAAe,CAACkB,UAAU,CAAC,kBAAkB,EAAE,CAAC,CAAC,8BAA8B,IAAI,CAACd,MAAM,CAACe,SAAS,CAAC;MACrHC,OAAO,EAAE,IAAI,CAACpB,eAAe,CAACkB,UAAU,CAAC,gBAAgB,EAAE,CAAC,CAAC,8BAA8B,IAAI,CAACd,MAAM,CAACgB,OAAO,CAAC;MAC/GC,YAAY,EAAE,IAAI,CAACrB,eAAe,CAACkB,UAAU,CAAC,qBAAqB,EAAE,CAAC,CAAC,8BAA8B,IAAI,CAACd,MAAM,CAACiB,YAAY;IACjI,CAAC,EAAE,KAAK,CAAC;EACb;EACAoB,kBAAkBA,CAAA,EAAG;IACjB,OAAO,CAAC,CAAClG,0BAA0B,CAACmG,QAAQ,CAAC,IAAI,CAAC3C,kBAAkB,CAAC;EACzE;EACA4C,QAAQA,CAAA,EAAG;IACP,OAAO,IAAI,CAACvC,MAAM;EACtB;EACAwC,eAAeA,CAAA,EAAG;IACd,IAAI,CAACxC,MAAM,CAACW,MAAM,CAAC;MACfF,UAAU,EAAE,KAAK;MACjBG,WAAW,EAAE;IACjB,CAAC,EAAE,KAAK,CAAC;IACT,IAAI,CAAC5B,OAAO,CAACyD,KAAK,CAAC,CAAC;EACxB;EACAC,mBAAmBA,CAAA,EAAG;IAClB,IAAI,CAAC1C,MAAM,CAACW,MAAM,CAAC;MAAEE,SAAS,EAAE,CAAC,IAAI,CAACb,MAAM,CAACa;IAAU,CAAC,EAAE,KAAK,CAAC;IAChE,IAAI,CAAC,IAAI,CAACb,MAAM,CAACS,UAAU,EAAE;MACzB,IAAI,CAACkC,oBAAoB,CAAC,CAAC;IAC/B;EACJ;EACAC,gBAAgBA,CAAA,EAAG;IACf,IAAI,CAAC5C,MAAM,CAACW,MAAM,CAAC;MAAEI,SAAS,EAAE,CAAC,IAAI,CAACf,MAAM,CAACe;IAAU,CAAC,EAAE,KAAK,CAAC;IAChE,IAAI,CAAC,IAAI,CAACf,MAAM,CAACS,UAAU,EAAE;MACzB,IAAI,CAACkC,oBAAoB,CAAC,CAAC;IAC/B;EACJ;EACAE,WAAWA,CAAA,EAAG;IACV,IAAI,CAAC7C,MAAM,CAACW,MAAM,CAAC;MAAEK,OAAO,EAAE,CAAC,IAAI,CAAChB,MAAM,CAACgB;IAAQ,CAAC,EAAE,KAAK,CAAC;IAC5D,IAAI,CAAC,IAAI,CAAChB,MAAM,CAACS,UAAU,EAAE;MACzB,IAAI,CAACkC,oBAAoB,CAAC,CAAC;IAC/B;EACJ;EACAG,kBAAkBA,CAAA,EAAG;IACjB,IAAI,CAAC9C,MAAM,CAACW,MAAM,CAAC;MAAEM,YAAY,EAAE,CAAC,IAAI,CAACjB,MAAM,CAACiB;IAAa,CAAC,EAAE,KAAK,CAAC;IACtE,IAAI,CAAC,IAAI,CAACjB,MAAM,CAACS,UAAU,EAAE;MACzB,IAAI,CAACkC,oBAAoB,CAAC,CAAC;IAC/B;EACJ;EACAI,iBAAiBA,CAAA,EAAG;IAChB,IAAI,IAAI,CAAC/C,MAAM,CAACY,WAAW,EAAE;MACzB,IAAI,CAACZ,MAAM,CAACW,MAAM,CAAC;QAAEC,WAAW,EAAE;MAAK,CAAC,EAAE,IAAI,CAAC;IACnD,CAAC,MACI;MACD,IAAI,IAAI,CAAC5B,OAAO,CAACd,QAAQ,CAAC,CAAC,EAAE;QACzB,MAAM8E,UAAU,GAAG,IAAI,CAAChE,OAAO,CAACiE,aAAa,CAAC,CAAC;QAC/CD,UAAU,CAACE,GAAG,CAAC/E,SAAS,IAAI;UACxB,IAAIA,SAAS,CAACgF,SAAS,KAAK,CAAC,IAAIhF,SAAS,CAACG,aAAa,GAAGH,SAAS,CAACE,eAAe,EAAE;YAClFF,SAAS,GAAGA,SAAS,CAACiF,cAAc,CAACjF,SAAS,CAACG,aAAa,GAAG,CAAC,EAAE,IAAI,CAACU,OAAO,CAACJ,QAAQ,CAAC,CAAC,CAACyE,gBAAgB,CAAClF,SAAS,CAACG,aAAa,GAAG,CAAC,CAAC,CAAC;UAC5I;UACA,IAAI,CAACH,SAAS,CAACI,OAAO,CAAC,CAAC,EAAE;YACtB,OAAOJ,SAAS;UACpB;UACA,OAAO,IAAI;QACf,CAAC,CAAC,CAACmF,MAAM,CAACC,OAAO,IAAI,CAAC,CAACA,OAAO,CAAC;QAC/B,IAAIP,UAAU,CAACvI,MAAM,EAAE;UACnB,IAAI,CAACuF,MAAM,CAACW,MAAM,CAAC;YAAEC,WAAW,EAAEoC;UAAW,CAAC,EAAE,IAAI,CAAC;QACzD;MACJ;IACJ;EACJ;EACAQ,eAAeA,CAAC1B,YAAY,EAAE;IAC1B,IAAI,IAAI,CAAC9B,MAAM,CAACgB,OAAO,EAAE;MACrBc,YAAY,GAAGtG,OAAO,CAACiI,sBAAsB,CAAC3B,YAAY,CAAC;IAC/D;IACA,IAAI,CAAC9B,MAAM,CAACW,MAAM,CAAC;MAAEmB,YAAY,EAAEA;IAAa,CAAC,EAAE,KAAK,CAAC;EAC7D;EACAa,oBAAoBA,CAACe,iBAAiB,GAAG,KAAK,EAAE;IAC5C;EAAA;EAEJ,MAAMxC,MAAMA,CAACyC,IAAI,EAAEC,QAAQ,EAAE;IACzB,IAAI,CAAClD,YAAY,CAAC,CAAC;IACnB,IAAI,CAAC,IAAI,CAAC1B,OAAO,CAACd,QAAQ,CAAC,CAAC,EAAE;MAC1B;MACA;IACJ;IACA,MAAM2F,YAAY,GAAG;MACjB,GAAGD,QAAQ;MACXnD,UAAU,EAAE;IAChB,CAAC;IACD,IAAIkD,IAAI,CAAC3F,6BAA6B,KAAK,QAAQ,EAAE;MACjD,MAAM8F,qBAAqB,GAAGhG,wBAAwB,CAAC,IAAI,CAACkB,OAAO,EAAE2E,IAAI,CAAC3F,6BAA6B,EAAE2F,IAAI,CAAC1F,qCAAqC,CAAC;MACpJ,IAAI6F,qBAAqB,EAAE;QACvB,IAAI,IAAI,CAAC9D,MAAM,CAACgB,OAAO,EAAE;UACrB6C,YAAY,CAAC/B,YAAY,GAAGtG,OAAO,CAACiI,sBAAsB,CAACK,qBAAqB,CAAC;QACrF,CAAC,MACI;UACDD,YAAY,CAAC/B,YAAY,GAAGgC,qBAAqB;QACrD;MACJ;IACJ,CAAC,MACI,IAAIH,IAAI,CAAC3F,6BAA6B,KAAK,UAAU,IAAI,CAAC2F,IAAI,CAACpC,iBAAiB,EAAE;MACnF,MAAMuC,qBAAqB,GAAGhG,wBAAwB,CAAC,IAAI,CAACkB,OAAO,EAAE2E,IAAI,CAAC3F,6BAA6B,CAAC;MACxG,IAAI8F,qBAAqB,EAAE;QACvBD,YAAY,CAAC/B,YAAY,GAAGgC,qBAAqB;MACrD;IACJ;IACA,IAAI,CAACD,YAAY,CAAC/B,YAAY,IAAI6B,IAAI,CAACvC,mCAAmC,EAAE;MACxE,MAAM0C,qBAAqB,GAAG,MAAM,IAAI,CAACC,mBAAmB,CAAC,CAAC;MAC9D,IAAI,CAAC,IAAI,CAAC/E,OAAO,CAACd,QAAQ,CAAC,CAAC,EAAE;QAC1B;QACA;MACJ;MACA,IAAI4F,qBAAqB,EAAE;QACvBD,YAAY,CAAC/B,YAAY,GAAGgC,qBAAqB;MACrD;IACJ;IACA;IACA,IAAIH,IAAI,CAACxC,kBAAkB,IAAI0C,YAAY,CAACG,iBAAiB,EAAE;MAC3DH,YAAY,CAACG,iBAAiB,GAAG,IAAI;IACzC,CAAC,MACI,IAAI,CAAC,IAAI,CAACvE,kBAAkB,CAACR,GAAG,CAAC,CAAC,EAAE;MACrC4E,YAAY,CAACG,iBAAiB,GAAG,KAAK;IAC1C;IACA,IAAIL,IAAI,CAACpC,iBAAiB,EAAE;MACxB,MAAM0C,iBAAiB,GAAG,IAAI,CAACjF,OAAO,CAACiE,aAAa,CAAC,CAAC;MACtD,IAAIgB,iBAAiB,CAACC,IAAI,CAAC/F,SAAS,IAAI,CAACA,SAAS,CAACI,OAAO,CAAC,CAAC,CAAC,EAAE;QAC3DsF,YAAY,CAACjD,WAAW,GAAGqD,iBAAiB;MAChD;IACJ;IACAJ,YAAY,CAACrC,IAAI,GAAGmC,IAAI,CAACnC,IAAI;IAC7B,IAAI,CAACxB,MAAM,CAACW,MAAM,CAACkD,YAAY,EAAE,KAAK,CAAC;IACvC,IAAI,CAAC,IAAI,CAACvD,MAAM,EAAE;MACd,IAAI,CAACA,MAAM,GAAG,IAAIhE,2BAA2B,CAAC,IAAI,CAAC0C,OAAO,EAAE,IAAI,CAACgB,MAAM,CAAC;IAC5E;EACJ;EACAmE,KAAKA,CAACR,IAAI,EAAEC,QAAQ,EAAE;IAClB,OAAO,IAAI,CAAC1C,MAAM,CAACyC,IAAI,EAAEC,QAAQ,CAAC;EACtC;EACAQ,eAAeA,CAAA,EAAG;IACd,IAAI,IAAI,CAAC9D,MAAM,EAAE;MACb,IAAI,CAACA,MAAM,CAAC8D,eAAe,CAAC,CAAC;MAC7B,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB;EACAC,eAAeA,CAAA,EAAG;IACd,IAAI,IAAI,CAAC/D,MAAM,EAAE;MACb,IAAI,CAACA,MAAM,CAAC+D,eAAe,CAAC,CAAC;MAC7B,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB;EACAC,SAASA,CAACC,KAAK,EAAE;IACb,IAAI,IAAI,CAACjE,MAAM,EAAE;MACb,IAAI,CAACA,MAAM,CAACkE,WAAW,CAACD,KAAK,CAAC;MAC9B,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB;EACAE,OAAOA,CAAA,EAAG;IACN,IAAI,IAAI,CAACnE,MAAM,EAAE;MACb,IAAI,CAACA,MAAM,CAACmE,OAAO,CAAC,CAAC;MACrB,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB;EACAC,UAAUA,CAAA,EAAG;IACT,IAAIC,EAAE;IACN,IAAI,IAAI,CAACrE,MAAM,EAAE;MACb,IAAI,CAACqE,EAAE,GAAG,IAAI,CAAC3F,OAAO,CAACJ,QAAQ,CAAC,CAAC,MAAM,IAAI,IAAI+F,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACC,0BAA0B,CAAC,CAAC,EAAE;QACrG,IAAI,CAAC9E,oBAAoB,CAAC+E,IAAI,CAAC7H,GAAG,CAAC8H,QAAQ,CAAC,0BAA0B,EAAE,2DAA2D,CAAC,CAAC;QACrI,OAAO,KAAK;MAChB;MACA,IAAI,CAACxE,MAAM,CAACoE,UAAU,CAAC,CAAC;MACxB,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB;EACAK,gBAAgBA,CAAA,EAAG;IACf,IAAI,IAAI,CAACzE,MAAM,EAAE;MACb,IAAI,CAACA,MAAM,CAACyE,gBAAgB,CAAC,CAAC;MAC9B,IAAI,CAAC/F,OAAO,CAACyD,KAAK,CAAC,CAAC;MACpB,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB;EACA,MAAMsB,mBAAmBA,CAAA,EAAG;IACxB,IAAI,IAAI,CAAC/E,OAAO,CAACyC,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACuD,mBAAmB,IACnE,IAAI,CAAChG,OAAO,CAACd,QAAQ,CAAC,CAAC,IACvB,CAAC,IAAI,CAACc,OAAO,CAACJ,QAAQ,CAAC,CAAC,CAACqG,oBAAoB,CAAC,CAAC,EAAE;MACpD,OAAO,IAAI,CAACpF,iBAAiB,CAACqF,YAAY,CAAC,CAAC;IAChD;IACA,OAAO,EAAE;EACb;EACAnD,mBAAmBA,CAACoD,IAAI,EAAE;IACtB,IAAI,IAAI,CAACnG,OAAO,CAACyC,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACuD,mBAAmB,IACnE,IAAI,CAAChG,OAAO,CAACd,QAAQ,CAAC,CAAC,IACvB,CAAC,IAAI,CAACc,OAAO,CAACJ,QAAQ,CAAC,CAAC,CAACqG,oBAAoB,CAAC,CAAC,EAAE;MACpD;MACA,IAAI,CAACpF,iBAAiB,CAACuF,aAAa,CAACD,IAAI,CAAC;IAC9C;EACJ;AACJ,CAAC;AACDpG,oBAAoB,CAACI,EAAE,GAAG,+BAA+B;AACzDJ,oBAAoB,GAAG1D,sBAAsB,GAAGnB,UAAU,CAAC,CACvDgB,OAAO,CAAC,CAAC,EAAEkC,kBAAkB,CAAC,EAC9BlC,OAAO,CAAC,CAAC,EAAEwC,eAAe,CAAC,EAC3BxC,OAAO,CAAC,CAAC,EAAEgC,iBAAiB,CAAC,EAC7BhC,OAAO,CAAC,CAAC,EAAEqC,oBAAoB,CAAC,CACnC,EAAEwB,oBAAoB,CAAC;AACxB,SAASA,oBAAoB;AAC7B,IAAIsG,cAAc,GAAG,MAAMA,cAAc,SAAStG,oBAAoB,CAAC;EACnEK,WAAWA,CAACrB,MAAM,EAAEuH,mBAAmB,EAAE3F,kBAAkB,EAAE4F,kBAAkB,EAAEC,aAAa,EAAEhG,mBAAmB,EAAEI,eAAe,EAAEL,gBAAgB,EAAE;IACpJ,KAAK,CAACxB,MAAM,EAAE4B,kBAAkB,EAAEC,eAAe,EAAEL,gBAAgB,EAAEC,mBAAmB,CAAC;IACzF,IAAI,CAAC8F,mBAAmB,GAAGA,mBAAmB;IAC9C,IAAI,CAACC,kBAAkB,GAAGA,kBAAkB;IAC5C,IAAI,CAACC,aAAa,GAAGA,aAAa;IAClC,IAAI,CAACC,OAAO,GAAG,IAAI;IACnB,IAAI,CAACC,kBAAkB,GAAG,IAAI;EAClC;EACA,MAAMxE,MAAMA,CAACyC,IAAI,EAAEC,QAAQ,EAAE;IACzB,IAAI,CAAC,IAAI,CAAC6B,OAAO,EAAE;MACf,IAAI,CAACE,iBAAiB,CAAC,CAAC;IAC5B;IACA,MAAMxH,SAAS,GAAG,IAAI,CAACa,OAAO,CAACZ,YAAY,CAAC,CAAC;IAC7C,IAAImD,iBAAiB,GAAG,KAAK;IAC7B,QAAQ,IAAI,CAACvC,OAAO,CAACyC,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACmE,mBAAmB;MAC1E,KAAK,QAAQ;QACTrE,iBAAiB,GAAG,IAAI;QACxB;MACJ,KAAK,OAAO;QACRA,iBAAiB,GAAG,KAAK;QACzB;MACJ,KAAK,WAAW;QAAE;UACd,MAAMsE,uBAAuB,GAAG,CAAC,CAAC1H,SAAS,IAAIA,SAAS,CAACE,eAAe,KAAKF,SAAS,CAACG,aAAa;UACpGiD,iBAAiB,GAAGsE,uBAAuB;UAC3C;QACJ;MACA;QACI;IACR;IACAlC,IAAI,CAACpC,iBAAiB,GAAGoC,IAAI,CAACpC,iBAAiB,IAAIA,iBAAiB;IACpE,MAAM,KAAK,CAACL,MAAM,CAACyC,IAAI,EAAEC,QAAQ,CAAC;IAClC,IAAI,IAAI,CAAC6B,OAAO,EAAE;MACd,IAAI9B,IAAI,CAACtC,WAAW,KAAK,CAAC,CAAC,8CAA8C;QACrE,IAAI,CAACoE,OAAO,CAACK,iBAAiB,CAAC,CAAC;MACpC,CAAC,MACI,IAAInC,IAAI,CAACtC,WAAW,KAAK,CAAC,CAAC,2CAA2C;QACvE,IAAI,CAACoE,OAAO,CAACM,cAAc,CAAC,CAAC;MACjC;IACJ;EACJ;EACApD,oBAAoBA,CAACe,iBAAiB,GAAG,KAAK,EAAE;IAC5C,IAAI,CAAC,IAAI,CAAC+B,OAAO,EAAE;MACf,IAAI,CAACE,iBAAiB,CAAC,CAAC;IAC5B;IACA,IAAI,IAAI,CAAC3F,MAAM,CAACS,UAAU,IAAI,CAACiD,iBAAiB,EAAE;MAC9C,IAAI,CAAC+B,OAAO,CAAC9C,oBAAoB,CAAC,CAAC;IACvC,CAAC,MACI;MACD,IAAI,CAAC+C,kBAAkB,CAAC/C,oBAAoB,CAAC,CAAC;IAClD;EACJ;EACAgD,iBAAiBA,CAAA,EAAG;IAChB,IAAI,CAACF,OAAO,GAAG,IAAI,CAACxF,SAAS,CAAC,IAAIlD,UAAU,CAAC,IAAI,CAACiC,OAAO,EAAE,IAAI,EAAE,IAAI,CAACgB,MAAM,EAAE,IAAI,CAACsF,mBAAmB,EAAE,IAAI,CAACC,kBAAkB,EAAE,IAAI,CAAC5F,kBAAkB,EAAE,IAAI,CAAC6F,aAAa,EAAE,IAAI,CAAC5F,eAAe,EAAE,IAAI,CAACE,oBAAoB,CAAC,CAAC;IAC/N,IAAI,CAAC4F,kBAAkB,GAAG,IAAI,CAACzF,SAAS,CAAC,IAAIpD,iBAAiB,CAAC,IAAI,CAACmC,OAAO,EAAE,IAAI,CAACgB,MAAM,EAAE,IAAI,CAACuF,kBAAkB,CAAC,CAAC;EACvH;AACJ,CAAC;AACDF,cAAc,GAAGnL,UAAU,CAAC,CACxBgB,OAAO,CAAC,CAAC,EAAEmC,mBAAmB,CAAC,EAC/BnC,OAAO,CAAC,CAAC,EAAEkC,kBAAkB,CAAC,EAC9BlC,OAAO,CAAC,CAAC,EAAEoC,kBAAkB,CAAC,EAC9BpC,OAAO,CAAC,CAAC,EAAEyC,aAAa,CAAC,EACzBzC,OAAO,CAAC,CAAC,EAAEqC,oBAAoB,CAAC,EAChCrC,OAAO,CAAC,CAAC,EAAEwC,eAAe,CAAC,EAC3BxC,OAAO,CAAC,CAAC,EAAEgC,iBAAiB,CAAC,CAChC,EAAEmI,cAAc,CAAC;AAClB,SAASA,cAAc;AACvB,OAAO,MAAMW,eAAe,GAAGjK,yBAAyB,CAAC,IAAIJ,iBAAiB,CAAC;EAC3EsK,EAAE,EAAE1J,QAAQ,CAACyJ,eAAe;EAC5BE,KAAK,EAAElJ,GAAG,CAAC8H,QAAQ,CAAC,iBAAiB,EAAE,MAAM,CAAC;EAC9CqB,KAAK,EAAE,MAAM;EACbC,YAAY,EAAEjJ,cAAc,CAACkJ,EAAE,CAACpK,iBAAiB,CAACwG,KAAK,EAAEtF,cAAc,CAACmJ,GAAG,CAAC,cAAc,CAAC,CAAC;EAC5FC,MAAM,EAAE;IACJC,MAAM,EAAE,IAAI;IACZC,OAAO,EAAE,IAAI,CAAC,uBAAuB,EAAE,CAAC;IACxCC,MAAM,EAAE,GAAG,CAAC;EAChB,CAAC;EACDC,QAAQ,EAAE;IACNC,MAAM,EAAE3J,MAAM,CAAC4J,eAAe;IAC9BC,KAAK,EAAE,QAAQ;IACfC,KAAK,EAAE/J,GAAG,CAAC8H,QAAQ,CAAC;MAAEzK,GAAG,EAAE,QAAQ;MAAE2M,OAAO,EAAE,CAAC,uBAAuB;IAAE,CAAC,EAAE,QAAQ,CAAC;IACpFC,KAAK,EAAE;EACX;AACJ,CAAC,CAAC,CAAC;AACHjB,eAAe,CAACkB,iBAAiB,CAAC,CAAC,EAAE,CAACC,QAAQ,EAAEpJ,MAAM,EAAEqJ,IAAI,KAAK;EAC7D,MAAMC,UAAU,GAAGtI,oBAAoB,CAACE,GAAG,CAAClB,MAAM,CAAC;EACnD,IAAI,CAACsJ,UAAU,EAAE;IACb,OAAO,KAAK;EAChB;EACA,OAAOA,UAAU,CAAClD,KAAK,CAAC;IACpBhD,kBAAkB,EAAE,KAAK;IACzBnD,6BAA6B,EAAED,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACzD,6BAA6B,KAAK,OAAO,GAAG,QAAQ,GAAG,MAAM;IACzIC,qCAAqC,EAAEF,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACzD,6BAA6B,KAAK,WAAW;IACjIoD,mCAAmC,EAAErD,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACuD,mBAAmB;IACrG3D,WAAW,EAAE,CAAC,CAAC;IACfC,aAAa,EAAE,IAAI;IACnBC,iBAAiB,EAAE,KAAK;IACxBC,IAAI,EAAEzD,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACD;EACvD,CAAC,CAAC;AACN,CAAC,CAAC;AACF,MAAM8F,kBAAkB,GAAG;EACvBC,WAAW,EAAE,mCAAmC;EAChDH,IAAI,EAAE,CAAC;IACCI,IAAI,EAAE,uCAAuC;IAC7CC,MAAM,EAAE;MACJC,UAAU,EAAE;QACR5F,YAAY,EAAE;UAAE6F,IAAI,EAAE;QAAS,CAAC;QAChCC,aAAa,EAAE;UAAED,IAAI,EAAE;QAAS,CAAC;QACjCE,KAAK,EAAE;UAAEF,IAAI,EAAE;QAAU,CAAC;QAC1BG,aAAa,EAAE;UACXH,IAAI,EAAE,QAAQ;UACdJ,WAAW,EAAEvK,GAAG,CAAC8H,QAAQ,CAAC,8BAA8B,EAAE,wHAAwH;QACtL,CAAC;QACD/D,SAAS,EAAE;UAAE4G,IAAI,EAAE;QAAU,CAAC;QAC9BI,iBAAiB,EAAE;UACfJ,IAAI,EAAE,QAAQ;UACdJ,WAAW,EAAEvK,GAAG,CAAC8H,QAAQ,CAAC,gCAAgC,EAAE,kHAAkH;QAClL,CAAC;QACDjE,SAAS,EAAE;UAAE8G,IAAI,EAAE;QAAU,CAAC;QAC9BK,iBAAiB,EAAE;UACfL,IAAI,EAAE,QAAQ;UACdJ,WAAW,EAAEvK,GAAG,CAAC8H,QAAQ,CAAC,gCAAgC,EAAE,2GAA2G;QAC3K,CAAC;QACD7D,YAAY,EAAE;UAAE0G,IAAI,EAAE;QAAU,CAAC;QACjCM,oBAAoB,EAAE;UAClBN,IAAI,EAAE,QAAQ;UACdJ,WAAW,EAAEvK,GAAG,CAAC8H,QAAQ,CAAC,mCAAmC,EAAE,+GAA+G;QAClL,CAAC;QACDoD,eAAe,EAAE;UAAEP,IAAI,EAAE;QAAU;MACvC;IACJ;EACJ,CAAC;AACT,CAAC;AACD,OAAO,MAAMQ,uBAAuB,SAAS1M,YAAY,CAAC;EACtD2D,WAAWA,CAAA,EAAG;IACV,KAAK,CAAC;MACF6G,EAAE,EAAE1J,QAAQ,CAAC6L,iBAAiB;MAC9BlC,KAAK,EAAElJ,GAAG,CAAC8H,QAAQ,CAAC,yBAAyB,EAAE,qBAAqB,CAAC;MACrEqB,KAAK,EAAE,qBAAqB;MAC5BC,YAAY,EAAEiC,SAAS;MACvB9B,MAAM,EAAE;QACJC,MAAM,EAAE,IAAI;QACZC,OAAO,EAAE,CAAC;QACVC,MAAM,EAAE,GAAG,CAAC;MAChB,CAAC;MACD4B,QAAQ,EAAEhB;IACd,CAAC,CAAC;EACN;EACA,MAAMiB,GAAGA,CAACpB,QAAQ,EAAEpJ,MAAM,EAAEqJ,IAAI,EAAE;IAC9B,MAAMC,UAAU,GAAGtI,oBAAoB,CAACE,GAAG,CAAClB,MAAM,CAAC;IACnD,IAAIsJ,UAAU,EAAE;MACZ,MAAMzD,QAAQ,GAAGwD,IAAI,GAAG;QACpBtF,YAAY,EAAEsF,IAAI,CAACtF,YAAY;QAC/B8F,aAAa,EAAER,IAAI,CAACQ,aAAa;QACjC5D,iBAAiB,EAAEoD,IAAI,CAACQ,aAAa,KAAKS,SAAS;QACnDrH,OAAO,EAAEoG,IAAI,CAACpG,OAAO;QACrB;QACAD,SAAS,EAAEqG,IAAI,CAACoB,cAAc;QAC9B;QACA3H,SAAS,EAAEuG,IAAI,CAACqB,eAAe;QAC/B;QACAxH,YAAY,EAAEmG,IAAI,CAACnG;QACnB;MACJ,CAAC,GAAG,CAAC,CAAC;MACN,MAAMoG,UAAU,CAAClD,KAAK,CAAC;QACnBhD,kBAAkB,EAAE,KAAK;QACzBnD,6BAA6B,EAAGqJ,UAAU,CAAC9E,QAAQ,CAAC,CAAC,CAACT,YAAY,CAACrH,MAAM,KAAK,CAAC,IAAKsD,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACzD,6BAA6B,KAAK,OAAO,GAAG,QAAQ,GAAG,MAAM;QAC9LC,qCAAqC,EAAEF,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACzD,6BAA6B,KAAK,WAAW;QACjIoD,mCAAmC,EAAE,IAAI;QACzCC,WAAW,EAAE,CAAC,CAAC;QACfC,aAAa,EAAE,IAAI;QACnBC,iBAAiB,EAAE,CAAC6F,IAAI,KAAK,IAAI,IAAIA,IAAI,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,IAAI,CAACc,eAAe,KAAK,KAAK;QAC9F1G,IAAI,EAAEzD,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACD;MACvD,CAAC,EAAEoC,QAAQ,CAAC;MACZyD,UAAU,CAACtF,mBAAmB,CAACsF,UAAU,CAAC9E,QAAQ,CAAC,CAAC,CAACT,YAAY,CAAC;IACtE;EACJ;AACJ;AACA,OAAO,MAAM4G,4BAA4B,SAASjN,YAAY,CAAC;EAC3D2D,WAAWA,CAAA,EAAG;IACV,KAAK,CAAC;MACF6G,EAAE,EAAE1J,QAAQ,CAACoM,sBAAsB;MACnCzC,KAAK,EAAElJ,GAAG,CAAC8H,QAAQ,CAAC,8BAA8B,EAAE,qBAAqB,CAAC;MAC1EqB,KAAK,EAAE,qBAAqB;MAC5BC,YAAY,EAAEiC,SAAS;MACvB9B,MAAM,EAAE;QACJC,MAAM,EAAE,IAAI;QACZC,OAAO,EAAE,CAAC;QACVmC,GAAG,EAAE;UACDnC,OAAO,EAAE,IAAI,CAAC,uBAAuB,EAAE,CAAC;QAC5C,CAAC;QACDC,MAAM,EAAE,GAAG,CAAC;MAChB;IACJ,CAAC,CAAC;EACN;EACA,MAAM6B,GAAGA,CAACpB,QAAQ,EAAEpJ,MAAM,EAAE;IACxB,MAAMsJ,UAAU,GAAGtI,oBAAoB,CAACE,GAAG,CAAClB,MAAM,CAAC;IACnD,IAAIsJ,UAAU,EAAE;MACZ,MAAMA,UAAU,CAAClD,KAAK,CAAC;QACnBhD,kBAAkB,EAAE,KAAK;QACzBnD,6BAA6B,EAAE,UAAU;QACzCC,qCAAqC,EAAE,KAAK;QAC5CmD,mCAAmC,EAAE,KAAK;QAC1CC,WAAW,EAAE,CAAC,CAAC;QACfC,aAAa,EAAE,IAAI;QACnBC,iBAAiB,EAAE,KAAK;QACxBC,IAAI,EAAEzD,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACD;MACvD,CAAC,CAAC;MACF6F,UAAU,CAACtF,mBAAmB,CAACsF,UAAU,CAAC9E,QAAQ,CAAC,CAAC,CAACT,YAAY,CAAC;IACtE;EACJ;AACJ;AACA,OAAO,MAAM+G,eAAe,SAASpN,YAAY,CAAC;EAC9C,MAAM8M,GAAGA,CAACpB,QAAQ,EAAEpJ,MAAM,EAAE;IACxB,MAAMsJ,UAAU,GAAGtI,oBAAoB,CAACE,GAAG,CAAClB,MAAM,CAAC;IACnD,IAAIsJ,UAAU,IAAI,CAAC,IAAI,CAACyB,IAAI,CAACzB,UAAU,CAAC,EAAE;MACtC,MAAMA,UAAU,CAAClD,KAAK,CAAC;QACnBhD,kBAAkB,EAAE,KAAK;QACzBnD,6BAA6B,EAAGqJ,UAAU,CAAC9E,QAAQ,CAAC,CAAC,CAACT,YAAY,CAACrH,MAAM,KAAK,CAAC,IAAKsD,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACzD,6BAA6B,KAAK,OAAO,GAAG,QAAQ,GAAG,MAAM;QAC9LC,qCAAqC,EAAEF,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACzD,6BAA6B,KAAK,WAAW;QACjIoD,mCAAmC,EAAE,IAAI;QACzCC,WAAW,EAAE,CAAC,CAAC;QACfC,aAAa,EAAE,IAAI;QACnBC,iBAAiB,EAAE,KAAK;QACxBC,IAAI,EAAEzD,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACD;MACvD,CAAC,CAAC;MACF,IAAI,CAACsH,IAAI,CAACzB,UAAU,CAAC;IACzB;EACJ;AACJ;AACA,OAAO,MAAM0B,mBAAmB,SAASF,eAAe,CAAC;EACrDzJ,WAAWA,CAAA,EAAG;IACV,KAAK,CAAC;MACF6G,EAAE,EAAE1J,QAAQ,CAACwM,mBAAmB;MAChC7C,KAAK,EAAElJ,GAAG,CAAC8H,QAAQ,CAAC,qBAAqB,EAAE,WAAW,CAAC;MACvDqB,KAAK,EAAE,WAAW;MAClBC,YAAY,EAAEiC,SAAS;MACvB9B,MAAM,EAAE,CAAC;QACDC,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;QAC/BgE,OAAO,EAAE,EAAE,CAAC;QACZmC,GAAG,EAAE;UAAEnC,OAAO,EAAE,IAAI,CAAC,uBAAuB,EAAE,CAAC;UAAoBuC,SAAS,EAAE,CAAC,EAAE,CAAC;QAAkB,CAAC;QACrGtC,MAAM,EAAE,GAAG,CAAC;MAChB,CAAC,EAAE;QACCF,MAAM,EAAErJ,cAAc,CAAC8L,GAAG,CAAChN,iBAAiB,CAACwG,KAAK,EAAEtG,0BAA0B,CAAC;QAC/EsK,OAAO,EAAE,CAAC,CAAC;QACXC,MAAM,EAAE,GAAG,CAAC;MAChB,CAAC;IACT,CAAC,CAAC;EACN;EACAoC,IAAIA,CAACzB,UAAU,EAAE;IACb,MAAM6B,MAAM,GAAG7B,UAAU,CAACjD,eAAe,CAAC,CAAC;IAC3C,IAAI8E,MAAM,EAAE;MACR7B,UAAU,CAACtJ,MAAM,CAACoL,YAAY,CAAC,CAAC;MAChC,OAAO,IAAI;IACf;IACA,OAAO,KAAK;EAChB;AACJ;AACA,OAAO,MAAMC,uBAAuB,SAASP,eAAe,CAAC;EACzDzJ,WAAWA,CAAA,EAAG;IACV,KAAK,CAAC;MACF6G,EAAE,EAAE1J,QAAQ,CAAC6M,uBAAuB;MACpClD,KAAK,EAAElJ,GAAG,CAAC8H,QAAQ,CAAC,yBAAyB,EAAE,eAAe,CAAC;MAC/DqB,KAAK,EAAE,eAAe;MACtBC,YAAY,EAAEiC,SAAS;MACvB9B,MAAM,EAAE,CAAC;QACDC,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;QAC/BgE,OAAO,EAAE,IAAI,CAAC,qBAAqB,EAAE,CAAC;QACtCmC,GAAG,EAAE;UAAEnC,OAAO,EAAE,IAAI,CAAC,uBAAuB,IAAI,CAAC,qBAAqB,EAAE,CAAC;UAAoBuC,SAAS,EAAE,CAAC,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAAkB,CAAC;QACzJtC,MAAM,EAAE,GAAG,CAAC;MAChB,CAAC,EAAE;QACCF,MAAM,EAAErJ,cAAc,CAAC8L,GAAG,CAAChN,iBAAiB,CAACwG,KAAK,EAAEtG,0BAA0B,CAAC;QAC/EsK,OAAO,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;QACrCC,MAAM,EAAE,GAAG,CAAC;MAChB,CAAC;IAET,CAAC,CAAC;EACN;EACAoC,IAAIA,CAACzB,UAAU,EAAE;IACb,OAAOA,UAAU,CAAChD,eAAe,CAAC,CAAC;EACvC;AACJ;AACA,OAAO,MAAMgF,qBAAqB,SAAS5N,YAAY,CAAC;EACpD2D,WAAWA,CAAA,EAAG;IACV,KAAK,CAAC;MACF6G,EAAE,EAAE1J,QAAQ,CAAC+M,mBAAmB;MAChCpD,KAAK,EAAElJ,GAAG,CAAC8H,QAAQ,CAAC,2BAA2B,EAAE,gBAAgB,CAAC;MAClEqB,KAAK,EAAE,gBAAgB;MACvBC,YAAY,EAAEhK;IAClB,CAAC,CAAC;IACF,IAAI,CAACmN,qBAAqB,GAAG,EAAE;EACnC;EACAhB,GAAGA,CAACpB,QAAQ,EAAEpJ,MAAM,EAAEqJ,IAAI,EAAE;IACxB,MAAMC,UAAU,GAAGtI,oBAAoB,CAACE,GAAG,CAAClB,MAAM,CAAC;IACnD,IAAI,CAACsJ,UAAU,EAAE;MACb;IACJ;IACA,MAAMmC,YAAY,GAAGnC,UAAU,CAAC9E,QAAQ,CAAC,CAAC,CAACiH,YAAY;IACvD,IAAIA,YAAY,GAAG,CAAC,EAAE;MAClB,MAAMhK,mBAAmB,GAAG2H,QAAQ,CAAClI,GAAG,CAAC1B,oBAAoB,CAAC;MAC9DiC,mBAAmB,CAACiK,MAAM,CAAC;QACvBC,QAAQ,EAAElM,QAAQ,CAACmM,OAAO;QAC1BC,OAAO,EAAE5M,GAAG,CAAC8H,QAAQ,CAAC,2BAA2B,EAAE,+CAA+C;MACtG,CAAC,CAAC;MACF;IACJ;IACA,MAAM+E,iBAAiB,GAAG1C,QAAQ,CAAClI,GAAG,CAACxB,kBAAkB,CAAC;IAC1D,MAAMqM,QAAQ,GAAGD,iBAAiB,CAACE,cAAc,CAAC,CAAC;IACnDD,QAAQ,CAACE,WAAW,GAAGhN,GAAG,CAAC8H,QAAQ,CAAC,kCAAkC,EAAE,6DAA6D,EAAE0E,YAAY,CAAC;IACpJ,MAAMS,gBAAgB,GAAIC,KAAK,IAAK;MAChC,MAAM3F,KAAK,GAAG4F,QAAQ,CAACD,KAAK,CAAC;MAC7B,IAAIE,KAAK,CAAC7F,KAAK,CAAC,EAAE;QACd,OAAO8D,SAAS;MACpB;MACA,MAAMgC,UAAU,GAAGhD,UAAU,CAAC9E,QAAQ,CAAC,CAAC,CAACiH,YAAY;MACrD,IAAIjF,KAAK,GAAG,CAAC,IAAIA,KAAK,IAAI8F,UAAU,EAAE;QAClC,OAAO9F,KAAK,GAAG,CAAC,CAAC,CAAC;MACtB,CAAC,MACI,IAAIA,KAAK,GAAG,CAAC,IAAIA,KAAK,IAAI,CAAC8F,UAAU,EAAE;QACxC,OAAOA,UAAU,GAAG9F,KAAK;MAC7B;MACA,OAAO8D,SAAS;IACpB,CAAC;IACD,MAAMiC,qBAAqB,GAAIJ,KAAK,IAAK;MACrC,MAAM3F,KAAK,GAAG0F,gBAAgB,CAACC,KAAK,CAAC;MACrC,IAAI,OAAO3F,KAAK,KAAK,QAAQ,EAAE;QAC3B;QACAuF,QAAQ,CAACS,iBAAiB,GAAGlC,SAAS;QACtChB,UAAU,CAAC/C,SAAS,CAACC,KAAK,CAAC;QAC3B,MAAMiG,YAAY,GAAGnD,UAAU,CAAC9E,QAAQ,CAAC,CAAC,CAACiI,YAAY;QACvD,IAAIA,YAAY,EAAE;UACd,IAAI,CAACC,cAAc,CAAC1M,MAAM,EAAEyM,YAAY,CAAC;QAC7C;MACJ,CAAC,MACI;QACDV,QAAQ,CAACS,iBAAiB,GAAGvN,GAAG,CAAC8H,QAAQ,CAAC,wCAAwC,EAAE,wCAAwC,EAAEuC,UAAU,CAAC9E,QAAQ,CAAC,CAAC,CAACiH,YAAY,CAAC;QACjK,IAAI,CAACkB,gBAAgB,CAAC3M,MAAM,CAAC;MACjC;IACJ,CAAC;IACD+L,QAAQ,CAACa,gBAAgB,CAACT,KAAK,IAAI;MAC/BI,qBAAqB,CAACJ,KAAK,CAAC;IAChC,CAAC,CAAC;IACFJ,QAAQ,CAACc,WAAW,CAAC,MAAM;MACvB,MAAMrG,KAAK,GAAG0F,gBAAgB,CAACH,QAAQ,CAACI,KAAK,CAAC;MAC9C,IAAI,OAAO3F,KAAK,KAAK,QAAQ,EAAE;QAC3B8C,UAAU,CAAC/C,SAAS,CAACC,KAAK,CAAC;QAC3BuF,QAAQ,CAACe,IAAI,CAAC,CAAC;MACnB,CAAC,MACI;QACDf,QAAQ,CAACS,iBAAiB,GAAGvN,GAAG,CAAC8H,QAAQ,CAAC,wCAAwC,EAAE,wCAAwC,EAAEuC,UAAU,CAAC9E,QAAQ,CAAC,CAAC,CAACiH,YAAY,CAAC;MACrK;IACJ,CAAC,CAAC;IACFM,QAAQ,CAACgB,SAAS,CAAC,MAAM;MACrB,IAAI,CAACJ,gBAAgB,CAAC3M,MAAM,CAAC;MAC7B+L,QAAQ,CAACpI,OAAO,CAAC,CAAC;IACtB,CAAC,CAAC;IACFoI,QAAQ,CAACiB,IAAI,CAAC,CAAC;EACnB;EACAL,gBAAgBA,CAAC3M,MAAM,EAAE;IACrBA,MAAM,CAACiN,iBAAiB,CAACC,cAAc,IAAI;MACvC,IAAI,CAAC1B,qBAAqB,GAAG0B,cAAc,CAACC,gBAAgB,CAAC,IAAI,CAAC3B,qBAAqB,EAAE,EAAE,CAAC;IAChG,CAAC,CAAC;EACN;EACAkB,cAAcA,CAAC1M,MAAM,EAAEoN,KAAK,EAAE;IAC1BpN,MAAM,CAACiN,iBAAiB,CAACC,cAAc,IAAI;MACvC,IAAI,CAAC1B,qBAAqB,GAAG0B,cAAc,CAACC,gBAAgB,CAAC,IAAI,CAAC3B,qBAAqB,EAAE,CACrF;QACI4B,KAAK;QACLC,OAAO,EAAE;UACL7D,WAAW,EAAE,yCAAyC;UACtD8D,SAAS,EAAE,gBAAgB;UAC3BC,WAAW,EAAE;QACjB;MACJ,CAAC,EACD;QACIH,KAAK;QACLC,OAAO,EAAE;UACL7D,WAAW,EAAE,kDAAkD;UAC/DgE,aAAa,EAAE;YACXC,KAAK,EAAE5N,gBAAgB,CAAC5B,2BAA2B,CAAC;YACpDyP,QAAQ,EAAEvP,iBAAiB,CAACwP;UAChC;QACJ;MACJ,CAAC,CACJ,CAAC;IACN,CAAC,CAAC;EACN;AACJ;AACA,OAAO,MAAMC,wBAAwB,SAASlQ,YAAY,CAAC;EACvD,MAAM8M,GAAGA,CAACpB,QAAQ,EAAEpJ,MAAM,EAAE;IACxB,MAAMsJ,UAAU,GAAGtI,oBAAoB,CAACE,GAAG,CAAClB,MAAM,CAAC;IACnD,IAAI,CAACsJ,UAAU,EAAE;MACb;IACJ;IACA,MAAMvD,qBAAqB,GAAGhG,wBAAwB,CAACC,MAAM,EAAE,QAAQ,EAAE,KAAK,CAAC;IAC/E,IAAI+F,qBAAqB,EAAE;MACvBuD,UAAU,CAAC7D,eAAe,CAACM,qBAAqB,CAAC;IACrD;IACA,IAAI,CAAC,IAAI,CAACgF,IAAI,CAACzB,UAAU,CAAC,EAAE;MACxB,MAAMA,UAAU,CAAClD,KAAK,CAAC;QACnBhD,kBAAkB,EAAE,KAAK;QACzBnD,6BAA6B,EAAE,MAAM;QACrCC,qCAAqC,EAAE,KAAK;QAC5CmD,mCAAmC,EAAE,KAAK;QAC1CC,WAAW,EAAE,CAAC,CAAC;QACfC,aAAa,EAAE,IAAI;QACnBC,iBAAiB,EAAE,KAAK;QACxBC,IAAI,EAAEzD,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACD;MACvD,CAAC,CAAC;MACF,IAAI,CAACsH,IAAI,CAACzB,UAAU,CAAC;IACzB;EACJ;AACJ;AACA,OAAO,MAAMuE,4BAA4B,SAASD,wBAAwB,CAAC;EACvEvM,WAAWA,CAAA,EAAG;IACV,KAAK,CAAC;MACF6G,EAAE,EAAE1J,QAAQ,CAACqP,4BAA4B;MACzC1F,KAAK,EAAElJ,GAAG,CAAC8H,QAAQ,CAAC,8BAA8B,EAAE,qBAAqB,CAAC;MAC1EqB,KAAK,EAAE,qBAAqB;MAC5BC,YAAY,EAAEiC,SAAS;MACvB9B,MAAM,EAAE;QACJC,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;QAC/BgE,OAAO,EAAE,IAAI,CAAC,uBAAuB,EAAE,CAAC;QACxCC,MAAM,EAAE,GAAG,CAAC;MAChB;IACJ,CAAC,CAAC;EACN;EACAoC,IAAIA,CAACzB,UAAU,EAAE;IACb,OAAOA,UAAU,CAACjD,eAAe,CAAC,CAAC;EACvC;AACJ;AACA,OAAO,MAAMyH,gCAAgC,SAASF,wBAAwB,CAAC;EAC3EvM,WAAWA,CAAA,EAAG;IACV,KAAK,CAAC;MACF6G,EAAE,EAAE1J,QAAQ,CAACsP,gCAAgC;MAC7C3F,KAAK,EAAElJ,GAAG,CAAC8H,QAAQ,CAAC,kCAAkC,EAAE,yBAAyB,CAAC;MAClFqB,KAAK,EAAE,yBAAyB;MAChCC,YAAY,EAAEiC,SAAS;MACvB9B,MAAM,EAAE;QACJC,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;QAC/BgE,OAAO,EAAE,IAAI,CAAC,uBAAuB,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAClEC,MAAM,EAAE,GAAG,CAAC;MAChB;IACJ,CAAC,CAAC;EACN;EACAoC,IAAIA,CAACzB,UAAU,EAAE;IACb,OAAOA,UAAU,CAAChD,eAAe,CAAC,CAAC;EACvC;AACJ;AACA,OAAO,MAAMyH,sBAAsB,GAAG/P,yBAAyB,CAAC,IAAIJ,iBAAiB,CAAC;EAClFsK,EAAE,EAAE1J,QAAQ,CAACuP,sBAAsB;EACnC5F,KAAK,EAAElJ,GAAG,CAAC8H,QAAQ,CAAC,cAAc,EAAE,SAAS,CAAC;EAC9CqB,KAAK,EAAE,SAAS;EAChBC,YAAY,EAAEjJ,cAAc,CAACkJ,EAAE,CAACpK,iBAAiB,CAACwG,KAAK,EAAEtF,cAAc,CAACmJ,GAAG,CAAC,cAAc,CAAC,CAAC;EAC5FC,MAAM,EAAE;IACJC,MAAM,EAAE,IAAI;IACZC,OAAO,EAAE,IAAI,CAAC,uBAAuB,EAAE,CAAC;IACxCmC,GAAG,EAAE;MAAEnC,OAAO,EAAE,IAAI,CAAC,uBAAuB,GAAG,CAAC,mBAAmB,EAAE,CAAC;IAAmB,CAAC;IAC1FC,MAAM,EAAE,GAAG,CAAC;EAChB,CAAC;EACDC,QAAQ,EAAE;IACNC,MAAM,EAAE3J,MAAM,CAAC4J,eAAe;IAC9BC,KAAK,EAAE,QAAQ;IACfC,KAAK,EAAE/J,GAAG,CAAC8H,QAAQ,CAAC;MAAEzK,GAAG,EAAE,WAAW;MAAE2M,OAAO,EAAE,CAAC,uBAAuB;IAAE,CAAC,EAAE,WAAW,CAAC;IAC1FC,KAAK,EAAE;EACX;AACJ,CAAC,CAAC,CAAC;AACH6E,sBAAsB,CAAC5E,iBAAiB,CAAC,CAAC,EAAE,CAACC,QAAQ,EAAEpJ,MAAM,EAAEqJ,IAAI,KAAK;EACpE,IAAI,CAACrJ,MAAM,CAACG,QAAQ,CAAC,CAAC,IAAIH,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,2BAA2B,CAAC,EAAE;IACxE,OAAO,KAAK;EAChB;EACA,MAAM4F,UAAU,GAAGtI,oBAAoB,CAACE,GAAG,CAAClB,MAAM,CAAC;EACnD,IAAI,CAACsJ,UAAU,EAAE;IACb,OAAO,KAAK;EAChB;EACA,MAAM0E,gBAAgB,GAAGhO,MAAM,CAACK,YAAY,CAAC,CAAC;EAC9C,MAAM4N,gBAAgB,GAAG3E,UAAU,CAAChF,kBAAkB,CAAC,CAAC;EACxD;EACA;EACA,MAAMrE,6BAA6B,GAAG,CAAC+N,gBAAgB,CAACxN,OAAO,CAAC,CAAC,IAC1DwN,gBAAgB,CAAC1N,eAAe,KAAK0N,gBAAgB,CAACzN,aAAa,IAClEP,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACzD,6BAA6B,KAAK,OAAQ,IACxF,CAACgO,gBAAgB;EACxB;AACJ;AACA;AACA;AACA;AACA;EAEI,MAAM3K,WAAW,GAAI2K,gBAAgB,IAAIhO,6BAA6B,GAClE,CAAC,CAAC,+CAA+C,CAAC,CAAC;EACvD,OAAOqJ,UAAU,CAAClD,KAAK,CAAC;IACpBhD,kBAAkB,EAAE,IAAI;IACxBnD,6BAA6B,EAAEA,6BAA6B,GAAG,QAAQ,GAAG,MAAM;IAChFC,qCAAqC,EAAEF,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACzD,6BAA6B,KAAK,WAAW;IACjIoD,mCAAmC,EAAErD,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACzD,6BAA6B,KAAK,OAAO;IAC3HqD,WAAW,EAAEA,WAAW;IACxBC,aAAa,EAAE,IAAI;IACnBC,iBAAiB,EAAE,KAAK;IACxBC,IAAI,EAAEzD,MAAM,CAAC0D,SAAS,CAAC,EAAE,CAAC,uBAAuB,CAAC,CAACD;EACvD,CAAC,CAAC;AACN,CAAC,CAAC;AACF1F,0BAA0B,CAACiD,oBAAoB,CAACI,EAAE,EAAEkG,cAAc,EAAE,CAAC,CAAC,2CAA2C,CAAC,CAAC,CAAC;AACpHzJ,oBAAoB,CAACuM,uBAAuB,CAAC;AAC7CvM,oBAAoB,CAAC8M,4BAA4B,CAAC;AAClD9M,oBAAoB,CAACmN,mBAAmB,CAAC;AACzCnN,oBAAoB,CAACwN,uBAAuB,CAAC;AAC7CxN,oBAAoB,CAACyN,qBAAqB,CAAC;AAC3CzN,oBAAoB,CAACgQ,4BAA4B,CAAC;AAClDhQ,oBAAoB,CAACiQ,gCAAgC,CAAC;AACtD,MAAMI,WAAW,GAAGvQ,aAAa,CAACwQ,kBAAkB,CAACnN,oBAAoB,CAACE,GAAG,CAAC;AAC9EpD,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAAC4P,sBAAsB;EACnC/F,YAAY,EAAEhK,2BAA2B;EACzCgQ,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAAC7J,eAAe,CAAC,CAAC;EACjC+D,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAErJ,cAAc,CAAC8L,GAAG,CAAChN,iBAAiB,CAACwG,KAAK,EAAEtF,cAAc,CAACmP,GAAG,CAAC,aAAa,CAAC,CAAC;IACtF7F,OAAO,EAAE,CAAC,CAAC;IACXuC,SAAS,EAAE,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;EAC5C;AACJ,CAAC,CAAC,CAAC;AACHnN,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAACgQ,0BAA0B;EACvCnG,YAAY,EAAEiC,SAAS;EACvB+D,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAAC3J,mBAAmB,CAAC,CAAC;EACrC6D,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;IAC/BgE,OAAO,EAAEjK,6BAA6B,CAACiK,OAAO;IAC9CmC,GAAG,EAAEpM,6BAA6B,CAACoM,GAAG;IACtC4D,GAAG,EAAEhQ,6BAA6B,CAACgQ,GAAG;IACtCC,KAAK,EAAEjQ,6BAA6B,CAACiQ;EACzC;AACJ,CAAC,CAAC,CAAC;AACH5Q,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAACmQ,sBAAsB;EACnCtG,YAAY,EAAEiC,SAAS;EACvB+D,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAACzJ,gBAAgB,CAAC,CAAC;EAClC2D,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;IAC/BgE,OAAO,EAAE7J,yBAAyB,CAAC6J,OAAO;IAC1CmC,GAAG,EAAEhM,yBAAyB,CAACgM,GAAG;IAClC4D,GAAG,EAAE5P,yBAAyB,CAAC4P,GAAG;IAClCC,KAAK,EAAE7P,yBAAyB,CAAC6P;EACrC;AACJ,CAAC,CAAC,CAAC;AACH5Q,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAACoQ,kBAAkB;EAC/BvG,YAAY,EAAEiC,SAAS;EACvB+D,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAACxJ,WAAW,CAAC,CAAC;EAC7B0D,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;IAC/BgE,OAAO,EAAE/J,qBAAqB,CAAC+J,OAAO;IACtCmC,GAAG,EAAElM,qBAAqB,CAACkM,GAAG;IAC9B4D,GAAG,EAAE9P,qBAAqB,CAAC8P,GAAG;IAC9BC,KAAK,EAAE/P,qBAAqB,CAAC+P;EACjC;AACJ,CAAC,CAAC,CAAC;AACH5Q,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAACqQ,wBAAwB;EACrCxG,YAAY,EAAEiC,SAAS;EACvB+D,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAACtJ,iBAAiB,CAAC,CAAC;EACnCwD,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;IAC/BgE,OAAO,EAAE9J,2BAA2B,CAAC8J,OAAO;IAC5CmC,GAAG,EAAEjM,2BAA2B,CAACiM,GAAG;IACpC4D,GAAG,EAAE7P,2BAA2B,CAAC6P,GAAG;IACpCC,KAAK,EAAE9P,2BAA2B,CAAC8P;EACvC;AACJ,CAAC,CAAC,CAAC;AACH5Q,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAACsQ,yBAAyB;EACtCzG,YAAY,EAAEiC,SAAS;EACvB+D,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAACvJ,kBAAkB,CAAC,CAAC;EACpCyD,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;IAC/BgE,OAAO,EAAEhK,4BAA4B,CAACgK,OAAO;IAC7CmC,GAAG,EAAEnM,4BAA4B,CAACmM,GAAG;IACrC4D,GAAG,EAAE/P,4BAA4B,CAAC+P,GAAG;IACrCC,KAAK,EAAEhQ,4BAA4B,CAACgQ;EACxC;AACJ,CAAC,CAAC,CAAC;AACH5Q,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAACuQ,gBAAgB;EAC7B1G,YAAY,EAAEhK,2BAA2B;EACzCgQ,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAAC5H,OAAO,CAAC,CAAC;EACzB8B,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;IAC/BgE,OAAO,EAAE,IAAI,CAAC,uBAAuB,IAAI,CAAC,qBAAqB,EAAE,CAAC;EACtE;AACJ,CAAC,CAAC,CAAC;AACH5K,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAACuQ,gBAAgB;EAC7B1G,YAAY,EAAEhK,2BAA2B;EACzCgQ,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAAC5H,OAAO,CAAC,CAAC;EACzB8B,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAErJ,cAAc,CAAC8L,GAAG,CAAChN,iBAAiB,CAACwG,KAAK,EAAEpG,6BAA6B,CAAC;IAClFoK,OAAO,EAAE,CAAC,CAAC;EACf;AACJ,CAAC,CAAC,CAAC;AACH5K,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAACwQ,gBAAgB;EAC7B3G,YAAY,EAAEhK,2BAA2B;EACzCgQ,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAAC3H,UAAU,CAAC,CAAC;EAC5B6B,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;IAC/BgE,OAAO,EAAE,IAAI,CAAC,uBAAuB,GAAG,CAAC,mBAAmB,CAAC,CAAC;EAClE;AACJ,CAAC,CAAC,CAAC;AACH5K,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAACwQ,gBAAgB;EAC7B3G,YAAY,EAAEhK,2BAA2B;EACzCgQ,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAAC3H,UAAU,CAAC,CAAC;EAC5B6B,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAErJ,cAAc,CAAC8L,GAAG,CAAChN,iBAAiB,CAACwG,KAAK,EAAEpG,6BAA6B,CAAC;IAClFoK,OAAO,EAAE4B,SAAS;IAClBO,GAAG,EAAE;MACDnC,OAAO,EAAE,IAAI,CAAC,uBAAuB,CAAC,CAAC;IAC3C;EACJ;AACJ,CAAC,CAAC,CAAC;AACH5K,qBAAqB,CAAC,IAAIoQ,WAAW,CAAC;EAClChG,EAAE,EAAE1J,QAAQ,CAACyQ,sBAAsB;EACnC5G,YAAY,EAAEhK,2BAA2B;EACzCgQ,OAAO,EAAEC,CAAC,IAAIA,CAAC,CAACtH,gBAAgB,CAAC,CAAC;EAClCwB,MAAM,EAAE;IACJG,MAAM,EAAE,GAAG,CAAC,uCAAuC,CAAC;IACpDF,MAAM,EAAEvK,iBAAiB,CAACwG,KAAK;IAC/BgE,OAAO,EAAE,GAAG,CAAC,mBAAmB,CAAC,CAAC;EACtC;AACJ,CAAC,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}