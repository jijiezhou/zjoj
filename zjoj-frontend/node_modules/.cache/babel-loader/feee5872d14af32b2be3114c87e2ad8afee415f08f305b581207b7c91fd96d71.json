{"ast":null,"code":"import { toRefs, ref } from \"vue\";\nimport { throttleByRaf } from \"../../_utils/throttle-by-raf.js\";\nimport useTreeContext from \"./use-tree-context.js\";\nfunction useDraggable(props) {\n  const {\n    key,\n    refTitle\n  } = toRefs(props);\n  const treeContext = useTreeContext();\n  const isDragOver = ref(false);\n  const isDragging = ref(false);\n  const isAllowDrop = ref(false);\n  const dropPosition = ref(0);\n  const updateDropPosition = throttleByRaf(e => {\n    if (!refTitle.value) return;\n    const rect = refTitle.value.getBoundingClientRect();\n    const offsetY = window.pageYOffset + rect.top;\n    const {\n      pageY\n    } = e;\n    const gapHeight = rect.height / 4;\n    const diff = pageY - offsetY;\n    dropPosition.value = diff < gapHeight ? -1 : diff < rect.height - gapHeight ? 0 : 1;\n    isAllowDrop.value = treeContext.allowDrop ? treeContext.allowDrop(key.value, dropPosition.value) : true;\n  });\n  return {\n    isDragOver,\n    isDragging,\n    isAllowDrop,\n    dropPosition,\n    setDragStatus(status, e) {\n      switch (status) {\n        case \"dragStart\":\n          isDragging.value = true;\n          dropPosition.value = 0;\n          treeContext.onDragStart && treeContext.onDragStart(key.value, e);\n          break;\n        case \"dragEnd\":\n          isDragging.value = false;\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragEnd && treeContext.onDragEnd(key.value, e);\n          break;\n        case \"dragOver\":\n          isDragOver.value = true;\n          updateDropPosition(e);\n          treeContext.onDragOver && treeContext.onDragOver(key.value, e);\n          break;\n        case \"dragLeave\":\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragLeave && treeContext.onDragLeave(key.value, e);\n          break;\n        case \"drop\":\n          treeContext.onDrop && treeContext.onDrop(key.value, dropPosition.value, e);\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          break;\n      }\n    }\n  };\n}\nexport { useDraggable as default };","map":{"version":3,"names":["toRefs","ref","throttleByRaf","useTreeContext","useDraggable","props","key","refTitle","treeContext","isDragOver","isDragging","isAllowDrop","dropPosition","updateDropPosition","e","value","rect","getBoundingClientRect","offsetY","window","pageYOffset","top","pageY","gapHeight","height","diff","allowDrop","setDragStatus","status","onDragStart","cancel","onDragEnd","onDragOver","onDragLeave","onDrop","default"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/@arco-design/web-vue/es/tree/hooks/use-draggable.js"],"sourcesContent":["import { toRefs, ref } from \"vue\";\nimport { throttleByRaf } from \"../../_utils/throttle-by-raf.js\";\nimport useTreeContext from \"./use-tree-context.js\";\nfunction useDraggable(props) {\n  const { key, refTitle } = toRefs(props);\n  const treeContext = useTreeContext();\n  const isDragOver = ref(false);\n  const isDragging = ref(false);\n  const isAllowDrop = ref(false);\n  const dropPosition = ref(0);\n  const updateDropPosition = throttleByRaf((e) => {\n    if (!refTitle.value)\n      return;\n    const rect = refTitle.value.getBoundingClientRect();\n    const offsetY = window.pageYOffset + rect.top;\n    const { pageY } = e;\n    const gapHeight = rect.height / 4;\n    const diff = pageY - offsetY;\n    dropPosition.value = diff < gapHeight ? -1 : diff < rect.height - gapHeight ? 0 : 1;\n    isAllowDrop.value = treeContext.allowDrop ? treeContext.allowDrop(key.value, dropPosition.value) : true;\n  });\n  return {\n    isDragOver,\n    isDragging,\n    isAllowDrop,\n    dropPosition,\n    setDragStatus(status, e) {\n      switch (status) {\n        case \"dragStart\":\n          isDragging.value = true;\n          dropPosition.value = 0;\n          treeContext.onDragStart && treeContext.onDragStart(key.value, e);\n          break;\n        case \"dragEnd\":\n          isDragging.value = false;\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragEnd && treeContext.onDragEnd(key.value, e);\n          break;\n        case \"dragOver\":\n          isDragOver.value = true;\n          updateDropPosition(e);\n          treeContext.onDragOver && treeContext.onDragOver(key.value, e);\n          break;\n        case \"dragLeave\":\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragLeave && treeContext.onDragLeave(key.value, e);\n          break;\n        case \"drop\":\n          treeContext.onDrop && treeContext.onDrop(key.value, dropPosition.value, e);\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          break;\n      }\n    }\n  };\n}\nexport { useDraggable as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}