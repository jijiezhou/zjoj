{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { DefaultDocumentColorProvider } from './defaultDocumentColorProvider.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport async function getColors(colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled = true) {\n  return _findColorData(new ColorDataCollector(), colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled);\n}\nexport function getColorPresentations(model, colorInfo, provider, token) {\n  return Promise.resolve(provider.provideColorPresentations(model, colorInfo, token));\n}\nclass ColorDataCollector {\n  constructor() {}\n  async compute(provider, model, token, colors) {\n    const documentColors = await provider.provideDocumentColors(model, token);\n    if (Array.isArray(documentColors)) {\n      for (const colorInfo of documentColors) {\n        colors.push({\n          colorInfo,\n          provider\n        });\n      }\n    }\n    return Array.isArray(documentColors);\n  }\n}\nclass ExtColorDataCollector {\n  constructor() {}\n  async compute(provider, model, token, colors) {\n    const documentColors = await provider.provideDocumentColors(model, token);\n    if (Array.isArray(documentColors)) {\n      for (const colorInfo of documentColors) {\n        colors.push({\n          range: colorInfo.range,\n          color: [colorInfo.color.red, colorInfo.color.green, colorInfo.color.blue, colorInfo.color.alpha]\n        });\n      }\n    }\n    return Array.isArray(documentColors);\n  }\n}\nclass ColorPresentationsCollector {\n  constructor(colorInfo) {\n    this.colorInfo = colorInfo;\n  }\n  async compute(provider, model, _token, colors) {\n    const documentColors = await provider.provideColorPresentations(model, this.colorInfo, CancellationToken.None);\n    if (Array.isArray(documentColors)) {\n      colors.push(...documentColors);\n    }\n    return Array.isArray(documentColors);\n  }\n}\nasync function _findColorData(collector, colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled) {\n  let validDocumentColorProviderFound = false;\n  let defaultProvider;\n  const colorData = [];\n  const documentColorProviders = colorProviderRegistry.ordered(model);\n  for (let i = documentColorProviders.length - 1; i >= 0; i--) {\n    const provider = documentColorProviders[i];\n    if (provider instanceof DefaultDocumentColorProvider) {\n      defaultProvider = provider;\n    } else {\n      try {\n        if (await collector.compute(provider, model, token, colorData)) {\n          validDocumentColorProviderFound = true;\n        }\n      } catch (e) {\n        onUnexpectedExternalError(e);\n      }\n    }\n  }\n  if (validDocumentColorProviderFound) {\n    return colorData;\n  }\n  if (defaultProvider && isDefaultColorDecoratorsEnabled) {\n    await collector.compute(defaultProvider, model, token, colorData);\n    return colorData;\n  }\n  return [];\n}\nfunction _setupColorCommand(accessor, resource) {\n  const {\n    colorProvider: colorProviderRegistry\n  } = accessor.get(ILanguageFeaturesService);\n  const model = accessor.get(IModelService).getModel(resource);\n  if (!model) {\n    throw illegalArgument();\n  }\n  const isDefaultColorDecoratorsEnabled = accessor.get(IConfigurationService).getValue('editor.defaultColorDecorators', {\n    resource\n  });\n  return {\n    model,\n    colorProviderRegistry,\n    isDefaultColorDecoratorsEnabled\n  };\n}\nCommandsRegistry.registerCommand('_executeDocumentColorProvider', function (accessor, ...args) {\n  const [resource] = args;\n  if (!(resource instanceof URI)) {\n    throw illegalArgument();\n  }\n  const {\n    model,\n    colorProviderRegistry,\n    isDefaultColorDecoratorsEnabled\n  } = _setupColorCommand(accessor, resource);\n  return _findColorData(new ExtColorDataCollector(), colorProviderRegistry, model, CancellationToken.None, isDefaultColorDecoratorsEnabled);\n});\nCommandsRegistry.registerCommand('_executeColorPresentationProvider', function (accessor, ...args) {\n  const [color, context] = args;\n  const {\n    uri,\n    range\n  } = context;\n  if (!(uri instanceof URI) || !Array.isArray(color) || color.length !== 4 || !Range.isIRange(range)) {\n    throw illegalArgument();\n  }\n  const {\n    model,\n    colorProviderRegistry,\n    isDefaultColorDecoratorsEnabled\n  } = _setupColorCommand(accessor, uri);\n  const [red, green, blue, alpha] = color;\n  return _findColorData(new ColorPresentationsCollector({\n    range: range,\n    color: {\n      red,\n      green,\n      blue,\n      alpha\n    }\n  }), colorProviderRegistry, model, CancellationToken.None, isDefaultColorDecoratorsEnabled);\n});","map":{"version":3,"names":["CancellationToken","illegalArgument","onUnexpectedExternalError","URI","Range","IModelService","CommandsRegistry","ILanguageFeaturesService","DefaultDocumentColorProvider","IConfigurationService","getColors","colorProviderRegistry","model","token","isDefaultColorDecoratorsEnabled","_findColorData","ColorDataCollector","getColorPresentations","colorInfo","provider","Promise","resolve","provideColorPresentations","constructor","compute","colors","documentColors","provideDocumentColors","Array","isArray","push","ExtColorDataCollector","range","color","red","green","blue","alpha","ColorPresentationsCollector","_token","None","collector","validDocumentColorProviderFound","defaultProvider","colorData","documentColorProviders","ordered","i","length","e","_setupColorCommand","accessor","resource","colorProvider","get","getModel","getValue","registerCommand","args","context","uri","isIRange"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/browser/color.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { DefaultDocumentColorProvider } from './defaultDocumentColorProvider.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport async function getColors(colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled = true) {\n    return _findColorData(new ColorDataCollector(), colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled);\n}\nexport function getColorPresentations(model, colorInfo, provider, token) {\n    return Promise.resolve(provider.provideColorPresentations(model, colorInfo, token));\n}\nclass ColorDataCollector {\n    constructor() { }\n    async compute(provider, model, token, colors) {\n        const documentColors = await provider.provideDocumentColors(model, token);\n        if (Array.isArray(documentColors)) {\n            for (const colorInfo of documentColors) {\n                colors.push({ colorInfo, provider });\n            }\n        }\n        return Array.isArray(documentColors);\n    }\n}\nclass ExtColorDataCollector {\n    constructor() { }\n    async compute(provider, model, token, colors) {\n        const documentColors = await provider.provideDocumentColors(model, token);\n        if (Array.isArray(documentColors)) {\n            for (const colorInfo of documentColors) {\n                colors.push({ range: colorInfo.range, color: [colorInfo.color.red, colorInfo.color.green, colorInfo.color.blue, colorInfo.color.alpha] });\n            }\n        }\n        return Array.isArray(documentColors);\n    }\n}\nclass ColorPresentationsCollector {\n    constructor(colorInfo) {\n        this.colorInfo = colorInfo;\n    }\n    async compute(provider, model, _token, colors) {\n        const documentColors = await provider.provideColorPresentations(model, this.colorInfo, CancellationToken.None);\n        if (Array.isArray(documentColors)) {\n            colors.push(...documentColors);\n        }\n        return Array.isArray(documentColors);\n    }\n}\nasync function _findColorData(collector, colorProviderRegistry, model, token, isDefaultColorDecoratorsEnabled) {\n    let validDocumentColorProviderFound = false;\n    let defaultProvider;\n    const colorData = [];\n    const documentColorProviders = colorProviderRegistry.ordered(model);\n    for (let i = documentColorProviders.length - 1; i >= 0; i--) {\n        const provider = documentColorProviders[i];\n        if (provider instanceof DefaultDocumentColorProvider) {\n            defaultProvider = provider;\n        }\n        else {\n            try {\n                if (await collector.compute(provider, model, token, colorData)) {\n                    validDocumentColorProviderFound = true;\n                }\n            }\n            catch (e) {\n                onUnexpectedExternalError(e);\n            }\n        }\n    }\n    if (validDocumentColorProviderFound) {\n        return colorData;\n    }\n    if (defaultProvider && isDefaultColorDecoratorsEnabled) {\n        await collector.compute(defaultProvider, model, token, colorData);\n        return colorData;\n    }\n    return [];\n}\nfunction _setupColorCommand(accessor, resource) {\n    const { colorProvider: colorProviderRegistry } = accessor.get(ILanguageFeaturesService);\n    const model = accessor.get(IModelService).getModel(resource);\n    if (!model) {\n        throw illegalArgument();\n    }\n    const isDefaultColorDecoratorsEnabled = accessor.get(IConfigurationService).getValue('editor.defaultColorDecorators', { resource });\n    return { model, colorProviderRegistry, isDefaultColorDecoratorsEnabled };\n}\nCommandsRegistry.registerCommand('_executeDocumentColorProvider', function (accessor, ...args) {\n    const [resource] = args;\n    if (!(resource instanceof URI)) {\n        throw illegalArgument();\n    }\n    const { model, colorProviderRegistry, isDefaultColorDecoratorsEnabled } = _setupColorCommand(accessor, resource);\n    return _findColorData(new ExtColorDataCollector(), colorProviderRegistry, model, CancellationToken.None, isDefaultColorDecoratorsEnabled);\n});\nCommandsRegistry.registerCommand('_executeColorPresentationProvider', function (accessor, ...args) {\n    const [color, context] = args;\n    const { uri, range } = context;\n    if (!(uri instanceof URI) || !Array.isArray(color) || color.length !== 4 || !Range.isIRange(range)) {\n        throw illegalArgument();\n    }\n    const { model, colorProviderRegistry, isDefaultColorDecoratorsEnabled } = _setupColorCommand(accessor, uri);\n    const [red, green, blue, alpha] = color;\n    return _findColorData(new ColorPresentationsCollector({ range: range, color: { red, green, blue, alpha } }), colorProviderRegistry, model, CancellationToken.None, isDefaultColorDecoratorsEnabled);\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}