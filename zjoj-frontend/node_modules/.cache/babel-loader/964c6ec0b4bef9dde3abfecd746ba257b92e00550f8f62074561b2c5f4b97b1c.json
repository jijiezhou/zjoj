{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ResourceTextEdit } from '../../../browser/services/bulkEditService.js';\nexport function createCombinedWorkspaceEdit(uri, ranges, edit) {\n  var _a, _b;\n  return {\n    edits: [...ranges.map(range => new ResourceTextEdit(uri, typeof edit.insertText === 'string' ? {\n      range,\n      text: edit.insertText,\n      insertAsSnippet: false\n    } : {\n      range,\n      text: edit.insertText.snippet,\n      insertAsSnippet: true\n    })), ...((_b = (_a = edit.additionalEdit) === null || _a === void 0 ? void 0 : _a.edits) !== null && _b !== void 0 ? _b : [])]\n  };\n}\nexport function sortEditsByYieldTo(edits) {\n  var _a;\n  function yieldsTo(yTo, other) {\n    return 'providerId' in yTo && yTo.providerId === other.providerId || 'mimeType' in yTo && yTo.mimeType === other.handledMimeType;\n  }\n  // Build list of nodes each node yields to\n  const yieldsToMap = new Map();\n  for (const edit of edits) {\n    for (const yTo of (_a = edit.yieldTo) !== null && _a !== void 0 ? _a : []) {\n      for (const other of edits) {\n        if (other === edit) {\n          continue;\n        }\n        if (yieldsTo(yTo, other)) {\n          let arr = yieldsToMap.get(edit);\n          if (!arr) {\n            arr = [];\n            yieldsToMap.set(edit, arr);\n          }\n          arr.push(other);\n        }\n      }\n    }\n  }\n  if (!yieldsToMap.size) {\n    return Array.from(edits);\n  }\n  // Topological sort\n  const visited = new Set();\n  const tempStack = [];\n  function visit(nodes) {\n    if (!nodes.length) {\n      return [];\n    }\n    const node = nodes[0];\n    if (tempStack.includes(node)) {\n      console.warn(`Yield to cycle detected for ${node.providerId}`);\n      return nodes;\n    }\n    if (visited.has(node)) {\n      return visit(nodes.slice(1));\n    }\n    let pre = [];\n    const yTo = yieldsToMap.get(node);\n    if (yTo) {\n      tempStack.push(node);\n      pre = visit(yTo);\n      tempStack.pop();\n    }\n    visited.add(node);\n    return [...pre, node, ...visit(nodes.slice(1))];\n  }\n  return visit(Array.from(edits));\n}","map":{"version":3,"names":["ResourceTextEdit","createCombinedWorkspaceEdit","uri","ranges","edit","_a","_b","edits","map","range","insertText","text","insertAsSnippet","snippet","additionalEdit","sortEditsByYieldTo","yieldsTo","yTo","other","providerId","mimeType","handledMimeType","yieldsToMap","Map","yieldTo","arr","get","set","push","size","Array","from","visited","Set","tempStack","visit","nodes","length","node","includes","console","warn","has","slice","pre","pop","add"],"sources":["/Users/zj/projects/zjoj/zjoj-frontend/node_modules/monaco-editor/esm/vs/editor/contrib/dropOrPasteInto/browser/edit.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ResourceTextEdit } from '../../../browser/services/bulkEditService.js';\nexport function createCombinedWorkspaceEdit(uri, ranges, edit) {\n    var _a, _b;\n    return {\n        edits: [\n            ...ranges.map(range => new ResourceTextEdit(uri, typeof edit.insertText === 'string'\n                ? { range, text: edit.insertText, insertAsSnippet: false }\n                : { range, text: edit.insertText.snippet, insertAsSnippet: true })),\n            ...((_b = (_a = edit.additionalEdit) === null || _a === void 0 ? void 0 : _a.edits) !== null && _b !== void 0 ? _b : [])\n        ]\n    };\n}\nexport function sortEditsByYieldTo(edits) {\n    var _a;\n    function yieldsTo(yTo, other) {\n        return ('providerId' in yTo && yTo.providerId === other.providerId)\n            || ('mimeType' in yTo && yTo.mimeType === other.handledMimeType);\n    }\n    // Build list of nodes each node yields to\n    const yieldsToMap = new Map();\n    for (const edit of edits) {\n        for (const yTo of (_a = edit.yieldTo) !== null && _a !== void 0 ? _a : []) {\n            for (const other of edits) {\n                if (other === edit) {\n                    continue;\n                }\n                if (yieldsTo(yTo, other)) {\n                    let arr = yieldsToMap.get(edit);\n                    if (!arr) {\n                        arr = [];\n                        yieldsToMap.set(edit, arr);\n                    }\n                    arr.push(other);\n                }\n            }\n        }\n    }\n    if (!yieldsToMap.size) {\n        return Array.from(edits);\n    }\n    // Topological sort\n    const visited = new Set();\n    const tempStack = [];\n    function visit(nodes) {\n        if (!nodes.length) {\n            return [];\n        }\n        const node = nodes[0];\n        if (tempStack.includes(node)) {\n            console.warn(`Yield to cycle detected for ${node.providerId}`);\n            return nodes;\n        }\n        if (visited.has(node)) {\n            return visit(nodes.slice(1));\n        }\n        let pre = [];\n        const yTo = yieldsToMap.get(node);\n        if (yTo) {\n            tempStack.push(node);\n            pre = visit(yTo);\n            tempStack.pop();\n        }\n        visited.add(node);\n        return [...pre, node, ...visit(nodes.slice(1))];\n    }\n    return visit(Array.from(edits));\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}